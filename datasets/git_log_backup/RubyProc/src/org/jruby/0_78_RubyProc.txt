commit 45d3af1710e258ce7f4f85cb5ce624758e75ef1b
Author: Charles Oliver Nutter <headius@headius.com>
Date:   Sat Jun 15 22:56:15 2013 -0500

    Rework frame management, and backref/lastline along with it.
    
    These changes should bring us more in line with the way other
    implementations manage "frame" data and bindings that capture it.
    It should also reduce the cost of framing, binding captures,
    blocks and procs, and operations that manipulate blocks and procs
    like define_method and instance_eval.
    
    The new logic works as follows:
    
    * Rather than a binding immediately duplicating a frame, it
      instead grabs a reference to it and marks it as captured.
    * When popping a frame, if it has been marked captured it is
      discarded rather than being cleared. This moves the cost of
      creating a binding to the pop of the surrounding method, which
      reduces the cost of nested bindings re-cloning the frame many
      times.
    * Bindings that are still active (have captured a frame that has
      not been popped) will update the method's frame data in-place.
    * Once the frame has been popped, it will live only in that
      binding.
    
    This commit passes mspec ci and test:mri19, but I am continuing
    to test it for a while.
    
    Note that this commit also moves backref and lastline to
    the frame. They have always been frame-local, but for a long time
    we kept them on the scope so we could avoid touching the frame for
    methods that did not need it. However, because we used the scope,
    it was difficult or impossible to isolate backref and lastline
    changes to the block. Moving to the frame, which has a lifespan
    only as long as the method that activated it, makes isolation
    easier.
    
    This should also make it easier to fix thread-safety issues with
    backref/lastline, as reported in JRUBY-7167.

commit bb98e4b8decffc0361b70a6c99c1ade5fed0abcb
Author: Charles Oliver Nutter <headius@headius.com>
Date:   Thu Mar 28 10:02:33 2013 +0000

    Move RuntimeHelpers to org.jruby.runtime.Helpers.

commit 7d81024147b697bf0861e48e04bb752bd81d2c5a
Author: Charles Oliver Nutter <headius@headius.com>
Date:   Wed Mar 6 17:30:09 2013 -0600

    Reduce cost of cloning a binding.
    
    Instance evals and define_method always force the binding
    associated with a block to be cloned. This is a large part of the
    cost of these call paths. This patch reduces allocation to
    improve the performance of binding cloning.
    
    * Make DummyDynamicScope.clone return itself
    * Preallocate dummy scope on binding when setting up proc
    * Copy dummy scope reference to new binding, to avoid recreating
    * Reference an eval binding rather than creating DynamicScope[1]

commit 4b3a1f1b57c8bb929c9c29c06882d9e42f8a92cd
Author: Charles Oliver Nutter <headius@headius.com>
Date:   Wed Mar 6 16:41:29 2013 -0600

    Optimizations to proc invocation to reduce allocation.
    
    * Do not clone block if we aren't modifying frame self
    * Do not create intermediate lists for 1.9 args setup
    * Use preallocated, frozen Array for intermediate Array of size 0

commit 61678ac1a2514a9932276f8d527816a5980a94b3
Author: Charles Oliver Nutter <headius@headius.com>
Date:   Mon Feb 25 20:41:40 2013 +1100

    Fix more references to CPL.
    
    The phrase "Common Public License" was split across two lines in
    our default header, which caused it to be missed during earlier
    search/replace. Also, we did not replace the CPL URL in the
    header with the EPL URL.

commit 330fef3b0fc18af477ccea19bd278669667f31bb
Author: Charles Oliver Nutter <headius@headius.com>
Date:   Tue Feb 12 14:49:29 2013 -0600

    Switch JRuby's CPL license to EPL.
    
    Governance of the CPL license was moved to the Eclipse Foundation
    at some point in the past, and Eclipse blessed the EPL (Eclipse
    Public License v1.0) as the successor to CPL. Because the CPL
    contains a clause allowing transparent upgrades to future blessed
    successor licenses, we can make the move to EPL without
    re-contacting past contributors.
    
    The change in going from CPL to EPL largely just removes some
    punitive language that apparently made many companies nervous. All
    other language in the license remains identical.
    
    Several documents about Eclipse's move from CPL to EPL are here:
    
    http://www.eclipse.org/legal/cpl2epl/
    
    Note that Eclipse's move came before the blessing of EPL as the
    upgrade path for CPL, so they had to do a bit more legal juggling.
    With Eclipse now the administrator of CPL and with their blessing
    of EPL as the upgrade path for CPL, all we need to do is make the
    move.

commit 4d66fd8dc44e4215332fcf61f19f99e17a131548
Author: Charles Oliver Nutter <headius@headius.com>
Date:   Tue Aug 21 19:25:46 2012 -0500

    Fix JRUBY-6810
    
    YAML.load(YAML.dump(lambda{})) should raise TypeError
    
    Proc should not define an allocator (#allocate should raise).

commit b8181cda909f6e42d7c0b7fffaabbe2a502f273b
Author: Charles Oliver Nutter <headius@headius.com>
Date:   Fri Jul 27 02:19:54 2012 -0500

    Inline all calls to ThreadContext.getRuntime to access the field.

commit f592cbbfae1186c42fb9e0545e2d9c394e73312f
Author: Thomas E. Enebo <tom.enebo@gmail.com>
Date:   Mon Oct 10 16:42:24 2011 -0500

    Use factory for standing up static scopes

commit 4807459e7a2458de246cb41104075c10c5d0fafb
Author: Subramanya Sastry <sss.lists@gmail.com>
Date:   Mon Sep 26 13:54:42 2011 -0500

    * Added allocation methods to StaticScope to allocate the appropriate
      static scopes and protected LocalStaticScope, BlockStaticScope and
      EvalStaticScope constructors.  This will now let us allocate
      IR-specific static scopes that IR execution requires.
    * Also added isBlockScope test on StaticScope to eliminate instanceof
      tests against BlockStaticScope and LocalStaticScope.
    * Hand-patched auto-generated files Ruby19Parser.java and
      DynamicScope.java.

commit 4159747e61ec73faf9aaf8fdeaeb84cd24c3f788
Author: Thomas E. Enebo <tom.enebo@gmail.com>
Date:   Mon Sep 12 20:35:30 2011 +0200

    change proc to have prepareProcArguments method and get rid of aliased variable name this.block (plus other trivial changes

commit a4340f5113bb1a8ffdb000a0b66e9b97ffe215da
Author: Thomas E. Enebo <tom.enebo@gmail.com>
Date:   Thu Sep 8 16:32:38 2011 +0200

    Further hack my arity check (about to go to airport continued ugly commit) for proc + to_ary.  This makes mantisrb run agin (Further clean up soon)

commit 6e847aab2474c67ac3e3d7252ab5c80e14de872d
Author: Thomas E. Enebo <tom.enebo@gmail.com>
Date:   Thu Sep 8 16:15:11 2011 +0200

    Make proc.call work a little better in 1.9 mode when calling to_ary (still WIP)

commit c3175e16f1bf91629fbd7d7966c6574313ceae33
Author: Charles Oliver Nutter <headius@headius.com>
Date:   Mon Aug 15 17:04:18 2011 -0500

    Fix JRUBY-5997: Block argument handling is inconsistent in 1.9 mode
    
    * One-off fix to unbox single array arguments for a multi-arg Proc call.

commit 95b8418eaafcacf221df6d6be4fa51371cefc115
Author: Hiro Asari <asari.ruby@gmail.com>
Date:   Sat Apr 30 23:54:04 2011 -0400

    Fix JRUBY-5762. Equate Proc#=== with Proc#call, Proc#[] and Proc#yield.

commit 0cb2b77278d0be6d8d44b66b5c166b264b481ac5
Author: Charles Oliver Nutter <headius@headius.com>
Date:   Sun Jan 16 17:10:16 2011 -0600

    Remove unused imports.

commit 92f10a22aa94e4a7ca02d6aaf7b8054ccff18f11
Author: Charles Oliver Nutter <headius@headius.com>
Date:   Sat Jan 8 01:54:05 2011 -0600

    [1.9] Implement Proc#parameter for compile blocks.

commit 095a36a4798e627dd7004c46aedafe71716edd41
Author: Hiroshi Nakamura <nahi@ruby-lang.org>
Date:   Mon Jan 3 23:59:17 2011 +0900

    JRUBY-5004: remove unused imports
    
    This commit is based on the patch from Douglas Campos <qmx@qmx.me>.

commit 01e4d770efddad773d0e52c2a2e0312bdf7cb660
Author: Charles Oliver Nutter <headius@headius.com>
Date:   Fri Dec 31 16:14:05 2010 -0600

    Fix JRUBY-5261: RSpec >= 2.2 around hooks trigger runtime NPE
    
    * MRI initializes the block reference in a proc during Proc.new, and does nothing in the base Proc#initialize.

commit 2e0b3c50d1e728c1228418e84b6535eb734e7643
Author: Charles Oliver Nutter <headius@headius.com>
Date:   Tue Dec 14 16:47:37 2010 -0600

    [1.9] Fixes for Method/Proc #source_location, #parameters.

commit 7fca827738fa129d0cbd9d3a4e852f4993e6ea06
Author: Charles Oliver Nutter <headius@headius.com>
Date:   Fri Dec 10 01:51:21 2010 -0600

    [1.9] Fix language/return spec for LocalJumpError when return escapes a thread.

commit fd0fa789b21b30f294e8286b72b75fe3b688c27a
Author: Charles Oliver Nutter <headius@headius.com>
Date:   Wed Dec 1 12:07:42 2010 -0600

    Merge "backtrace" branch to master, now that it runs clean on all our various test cases.
    
    This is a squashed merge encompassing the following commits from "backtrace":
    
    commit eb0e24242050199ac1cc4cf6e48d93025f0186f4
    Merge: 32137de ea48d8d
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Wed Dec 1 12:03:28 2010 -0600
    
        Merge remote branch 'origin/master' into backtrace
    
    commit 32137decc9351dd7b6a19c49c7955808f535bb9c
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Wed Dec 1 09:41:29 2010 -0600
    
        Fix remaining failures for test-all.
    
        * Disable CheckClassAdapter temporarily, since it disallows what should be valid JVM identifiers.
        * Use the presence of $RUBY$ in method name as an additional indicator that we're processing a compiled Ruby body during backtrace gathering.
        * Move some largely-static properties out of "init" target in build.xml, so they're available whether init is triggered or not (e.g. run.jvm.model).
    
    commit ee2a624201d5e9cd408d6ae793160aeb99b50b3d
    Merge: cd50ae5 88ad204
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Wed Dec 1 08:01:22 2010 -0600
    
        Merge branch 'master' into backtrace
    
    commit cd50ae5f06b95a2fffab6bc1f3a7419f478d0a52
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Tue Nov 30 19:15:07 2010 -0600
    
        Get remaining spec failure with -X+C passing.
    
        * Embed the actual Ruby method name into the Java method for block bodies, rather than __block__.
    
    commit 52bbfffcae1aed62bf4afcb692bed9725e4e1564
    Merge: 4ed7235 1aace5e
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Tue Nov 30 01:37:15 2010 -0600
    
        Merge branch 'master' into backtrace
    
    commit 4ed723579101fffd8bfa73b30dc6e4e8991866f2
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Tue Nov 30 01:31:44 2010 -0600
    
        Precompiled (AOT) specs *nearly* green.
    
        * Mark __method__ as reading frame "name"
        * Fix AOT-based stack trace mining logic
    
    commit 64e20aa939b5b9c6e41e0e9fe09039a0bb92794a
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Mon Nov 29 16:50:55 2010 -0600
    
        Jitted specs running green.
    
        * eval needs to set method name into the binding, so it's there for "__method__" in the eval'ed code.
    
    commit fd442c0a815bcab9eb6c9aa1b71e1f8a260ee03b
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Mon Nov 29 16:06:53 2010 -0600
    
        Interpreted specs green on backtrace.
    
        * Tagged some __method__ specs for which backtrace behaves like 1.9, which Matz apparently likes but was afraid to backport. Odd cases anyway.
        * Fixed method name for the block used to define_method.
    
    commit cedb27e430b422c1158f66b4dcc7769922433506
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Wed Nov 24 18:35:22 2010 -0600
    
        Reinstate deprecated java_to_ruby and ruby_to_java I removed, since it's still needed by some external libs.
    
    commit b48b17910de662b4e2d20ee8f4b5cc734eefc1ed
    Merge: f39007e 2ae4995
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Wed Nov 24 13:40:58 2010 -0600
    
        Merge remote branch 'origin/master' into backtrace
    
        Conflicts:
        	src/org/jruby/Ruby.java
        	src/org/jruby/RubySymbol.java
        	src/org/jruby/runtime/CompiledBlock19.java
        	src/org/jruby/runtime/Interpreted19Block.java
        	src/org/jruby/runtime/InterpretedBlock.java
        	src/org/jruby/runtime/MethodBlock.java
    
    commit f39007eca676c1e6ec9f891ac63b7c5d907b0d1b
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Thu Nov 18 14:01:29 2010 -0600
    
        Start normalizing the method/class names generated into Java by JIT and AOT compiler, to wrap up the remaining spec failures.
    
    commit 76e42c4b4522dc87c066d20051d02d1e4005b860
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Wed Nov 17 20:40:33 2010 -0600
    
        Disable dynopt for now, to allow better stabilization on the main feature of this branch: frame elimination.
    
    commit d03099690df2e16d423e8b6a8969e0264983237f
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Wed Nov 17 15:00:14 2010 -0600
    
        Encapsulate "coreMethods" hash in Ruby and add "bound method" logic to default (non-generated) class populator. `ant test-all` runs green now.
    
    commit ed7458f72bce55b11e5231f8e7b9d590c09ca53d
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Wed Nov 17 10:46:43 2010 -0600
    
        Fix incorrect use of fastSetInstanceVariable instead of fastSetInternalVariable in FFI.
    
    commit f09626121b6a8bea6ab39a3c8ed3ccd69f56b505
    Merge: f780b97 e8ca689
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Wed Nov 17 10:15:16 2010 -0600
    
        Merge branch 'master' into backtrace
    
    commit f780b972b1f3e18f4c2608d9536e797a0845cd1a
    Merge: 25ab5d3 6967ea7
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Wed Nov 17 09:04:42 2010 -0600
    
        Merge branch 'master' into backtrace
    
        Conflicts:
        	src/org/jruby/runtime/ThreadContext.java
    
    commit 25ab5d3d3f8c1fbf0fa334427b1485d322e83f86
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Sun Nov 7 00:42:54 2010 -0500
    
        Don't do dynopt against calls that receive blocks; non-local flow is not properly handled yet.
    
    commit a4ad27056dcc3acf6bae0b0af7e618966d08a6dd
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Sat Nov 6 15:22:40 2010 -0500
    
        Tag caller specs that do not pass with new backtrace logic (peculiar eval caller behaviors).
    
    commit eed8902084cfa06d4648935c1f70da57bf0c7a9c
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Sat Nov 6 00:32:59 2010 -0500
    
        More fixes to get specs and tests green on backtrace branch:
    
        * Hash#index was not being bound properly from RubyHash#index19
        * Range#min and Range#max need super, and therefore need frame = true
        * tc_owned is a bad test and fails on system like OS X where (for some reason) / may be owned by user
        * test_trace_func had been hacked for a bad class result (Integer, instead of Fixnum)...fixed that
    
    commit 9d9f94c30de76fa25e738e70e84ea09163eca5cb
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Fri Nov 5 20:03:22 2010 -0500
    
        Fix Kernel#caller to replace .java lines with Ruby lines. Brings specs mostly to passing.
    
    commit de433c771830e95c54f8196453208f2b312191aa
    Merge: 3ffe1cf e25c58f
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Fri Nov 5 17:40:02 2010 -0500
    
        Merge branch 'master' into backtrace
    
        Conflicts:
        	src/org/jruby/RubyIO.java
        	src/org/jruby/compiler/impl/StackBasedVariableCompiler.java
        	src/org/jruby/evaluator/ASTInterpreter.java
        	src/org/jruby/java/proxies/JavaProxy.java
    
    commit 3ffe1cfba86f52ee96d89f3a1c352597f22f76b7
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Wed Oct 27 01:42:06 2010 -0200
    
        Fix compile error I accidentally merged.
    
    commit b081253fb3cdf5141f7f0cf76d3f8546837d9f42
    Merge: fc3028d ad68e22
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Tue Oct 26 16:30:25 2010 -0200
    
        Merge branch 'master' into backtrace
    
        Conflicts:
        	src/org/jruby/Ruby.java
        	src/org/jruby/internal/runtime/methods/DefaultMethod.java
        	src/org/jruby/runtime/ThreadContext.java
    
    commit fc3028d9da2750c9d1c394600ab8ee712388724d
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Tue Oct 26 14:39:29 2010 -0200
    
        Add better description for class bodies in backtrace
    
    commit d796555494c2237116c7477c932fd96cd30d2e20
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Tue Oct 26 11:36:29 2010 -0200
    
        Clean up and add color to Rubinius backtraces.
    
    commit 012f5357ce649bd5a996211fe231f26097bf4f5b
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Sun Oct 24 16:23:04 2010 -0500
    
        Fix classloader check to allow for compiled method handles, which use a no-arg constructor.
    
    commit 473d48aac6a5523304188d1d433e4c12df989b89
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Sun Oct 24 16:10:32 2010 -0500
    
        Improve Proc-binding-based eval position info by propagating block's position into the binding and through to the backtrace frame.
    
    commit bcfd16b519b145c9ee055db1592dfaced05b71a0
    Merge: 4902faa 5b49583
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Sun Oct 24 11:07:15 2010 -0500
    
        Merge branch 'master' into backtrace
    
        Conflicts:
        	src/org/jruby/RubyTime.java
        	src/org/jruby/runtime/ThreadContext.java
        	test/org/jruby/test/TestRubyException.java
    
    commit 4902faaf1678d5aecdef8b0b66f8ec78062aeec5
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Thu Oct 21 09:28:45 2010 -0500
    
        Fix badly-merged RubyProc.to_s19, missing opening brace.
    
    commit 69177d7098f9dc4ff9096d08eee25c0d8bb4f971
    Merge: 801e764 f895837
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Wed Oct 20 21:50:53 2010 -0500
    
        Merge branch 'master' into backtrace
    
    commit 801e7641b8838a8ae8931a9c6dcc5cf050096c4a
    Merge: 0c60a89 dda4644
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Tue Oct 19 23:16:41 2010 -0500
    
        Merge branch 'master' into backtrace
    
        Conflicts:
        	src/org/jruby/RubyDigest.java
        	src/org/jruby/RubyProc.java
    
    commit 0c60a89aa746f286588b218681e9ad25b11318c4
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Tue Oct 19 23:06:15 2010 -0500
    
        Only compile direct recursive calls when we haven't branched to another method body (e.g. for rescues) and we're not compiling a closure or class body.
    
    commit 18333fe82c808e8ed49eef898f19c86fa2d764b2
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Tue Oct 12 17:04:13 2010 -0500
    
        Get 1.8 specs running green except for a handful of Kernel#caller specs (which don't expect to see .java files in the trace...not sure how to deal with that).
    
        * Fix another literal-block-calling path that wasn't using callIter
    
    commit 366740120ee76d8df3f977edc1727b60b2d4ad63
    Merge: b64390b 6b243a3
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Tue Oct 12 10:35:14 2010 -0500
    
        Merge remote branch 'origin/master' into backtrace
    
    commit b64390b8cf0d2cb13e06d352969a093b5e86818d
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Tue Oct 12 10:33:39 2010 -0500
    
        Remaining fixes to get precompiled mode passing all our tests. Still some spec failures.
    
        * Bump up permgen max for test runs
        * Fix stack-based scope initialization to not leave an unused nil on stack
        * Ensure compiled method handles properly wrap pre/post logic for dummy and backtrace frames.
    
    commit 96bd3cbde91fc505b37ee13cbea6ffa3e8690c58
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Mon Oct 11 18:36:34 2010 -0500
    
        First fixes for backtrace branch in precompiled mode:
    
        * Add test-precompiled build target for running just precompiled
        * Eliminate extraneous toplevel scope being pushed for precompiled loads (because that logic is all in the generated "load" method now.
        * Add a new scope descriptor decoding path that properly sets up a toplevel scope
    
    commit 0ebbd6ac46c9ac04558f5200f980f26f798b9413
    Merge: fc387be ac455fc
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Wed Oct 6 21:53:18 2010 -0500
    
        Merge branch 'master' into backtrace
    
        Conflicts:
        	src/org/jruby/RubyIO.java
    
    commit fc387befff57ada6c116b646a3dfb767cc926ee5
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Tue Sep 28 15:57:58 2010 -0500
    
        Renumber arguments for consistency.
    
    commit bbc91d3c4039bf6c26ceffd4899dcaaeaa3d46d0
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Tue Sep 28 15:40:38 2010 -0500
    
        Fixes to get specs a bit closer to running green.
    
        * Move pre/post logic for Script.load into generated code, so it's the same everywhere.
        * Make pre/post-load push a frame, so top-level of a script is always framed
        * Remove break handling from non-literal block call paths in CachingCallSite
        * Make sure all literal block calls are using CallSite.callIter, which handles break
        * Fix a bad test in testCompiler that needed visibility tweaks and framing
        * Add complete doco for CallSite
        * Fix Kernel#caller to trim from top of stack instead of bottom
    
    commit 4e814a24d5b2ef1b6567a3076a463ff9d08e2a0d
    Merge: 91dc13a 3dbcef3
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Mon Sep 27 17:43:30 2010 -0500
    
        Merge branch 'master' into backtrace
    
    commit 91dc13a2f0b74bc1054d83378782416465ecc1b8
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Mon Sep 27 01:02:48 2010 -0500
    
        Fixes to get test-compiled (but not precompiled) passing 100%.
    
        * Fix eqlInternal's RubyNumeric branch check if classes are equal
        * Provide file and line from all BlockBodies, so Proc#to_s can always use it
        * Fix rejiggered Struct#each and Struct#each_pair to call the appropriate internal version
        * Fix ruby_test's IO.new suite to not use STDOUT directly, risking that it get closed
    
    commit dc4af45352607ebb8a95d70befdcdb15c1111c58
    Merge: ec8bb7f 90275be
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Tue Sep 21 09:52:10 2010 -0700
    
        Merge branch 'master' into backtrace
    
        Conflicts:
        	src/org/jruby/Ruby.java
        	src/org/jruby/RubyDir.java
        	src/org/jruby/RubyKernel.java
        	src/org/jruby/compiler/ASTInspector.java
        	src/org/jruby/javasupport/util/RuntimeHelpers.java
    
    commit ec8bb7fc31d4acd4ebcb040f088e19fb427448e8
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Sun Sep 19 16:21:38 2010 -0700
    
        Remove frame = true from all core class methods, to reduce their call costs. A few remain for invokeSuper and methods that may still need frames.
    
    commit ec276b6ca0c6009702839b12d97664b9e52b1023
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Thu Sep 16 14:10:43 2010 -0500
    
        Eliminate RubyTuple use that snuck in.
    
    commit f80254100cfc17ac6eb558e465fc1fb9122c3ee4
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Tue Sep 14 10:07:53 2010 -0500
    
        Special case a few immutable core types in equalInternal/eqlInternal.
    
    commit eb66c45145e4fd1f8c28e9a8c544114f034116e8
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Sun Sep 12 18:26:13 2010 -0300
    
        Performance changes for backtrace logic:
    
        * Back off using Java stack trace for Proc's to_s file+line, since it's prohibitively expensive
        * Move the Backtrace stack to being a fixed-size array of objects updated, rather than created, when a push happens
    
    commit 6f0ade5ab28946b8800431d3454d2e57fc0dbe19
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Sun Sep 12 11:36:07 2010 -0300
    
        Add generation guard around trivially-inlined logic.
    
    commit c4d8705217174580d35757dc85c5c646e980b57f
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Sun Sep 12 06:18:38 2010 -0300
    
        Full speed ahead with a caching mechanism for calls from core classes. Only works for core class methods right now, but opens the door to expanding that.
    
    commit 5874abc01104f6c0f435f8ac4643ed0f77cf7cff
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Sun Sep 12 03:43:37 2010 -0300
    
        Localize some fields used in Array#include? to speed up the loop.
    
    commit 346245cd5e154574d14736cf4b9e0b4b98260d14
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Sat Sep 11 15:02:41 2010 -0300
    
        Allow passing a number of iterations to bench_quicksort.rb.
    
    commit b4687022a1f00d0b63838b1c9daf00753fcfa93e
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Sat Sep 11 11:55:15 2010 -0300
    
        Fixes to get run-junit-compiled 100% passing on backtrace branch.
    
        * Fixed a couple tests that are too sensitive to core method line numbers or expected only .rb elements in the trace
        * Added a mechanism for procs to retrieve the most recent Ruby frame, for to_s purposes
        * Added comments for hybrid backtrace logic
    
    commit 15cd9b16cb2750d0e40ba478d07fe5bf265dc620
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Sat Sep 11 08:07:57 2010 -0300
    
        Add better logging to AnnotationBinder (for showing framed/scoped core methods), ASTInspector (for showing methods detected as framed/scoped and for reporting deopt flags as they are set), and JITCompiler (for dumping jitted methods' full classes and inspector results). New property jruby.jit.dumping=(true|FALSE).
    
    commit c4e6176498590d791868055025c2e72ded1ccf13
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Fri Sep 10 02:10:20 2010 -0400
    
        Improve dumping of generated bytecode by including class and method name when possible.
    
    commit 07fc4215f6873f449f89d4f5da7a7e2e8963bc70
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Thu Sep 9 23:39:20 2010 -0400
    
        Make attr accessor's var accessor field volatile, to guarantee visibility across threads.
    
    commit e3a7cf5cd4d8ccd08407955779bdd94feb5e4ac8
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Wed Sep 8 13:26:48 2010 -0500
    
        Add missing "in" to caller backtrace lines.
    
    commit 7140c339f386959853f747d86cb2ea9a8afa6f2a
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Wed Sep 8 12:10:50 2010 -0500
    
        Fixes to get tracing tests running in interpreted mode:
    
        * Off-by-one line numbers were off for MRI too. Fixed to correct line numbers
        * call and return for Ruby methods need to use impl class, not self class
    
    commit cbc9c4edab56807a023817d06db9c22441fa4b53
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Wed Sep 8 10:31:57 2010 -0500
    
        Fix runInterpreterBody to properly unwrap RootNode for "gets loop" execution.
    
    commit 3a09773058d8d58d5bf8f1b6fbebc494fc18f7c6
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Wed Sep 8 10:01:43 2010 -0500
    
        Make --bytecode attempt a recompile, so that dynopt and no-compile modes can still print bytecode.
    
    commit 4e48e722ba5ded10975af348738237fcb7fe9b2a
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Wed Sep 8 09:23:38 2010 -0500
    
        Add a "full" backtrace style which does not omit any Java frames and interlaces the Ruby frames.
    
    commit 6f5057e3ae1e372bd66602dcc26864adc3270128
    Merge: 7006d31 811fd8d
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Wed Sep 8 07:48:47 2010 -0500
    
        Merge branch 'master' into backtrace
    
        Conflicts:
        	src/org/jruby/Ruby.java
    
    commit 7006d3175bbf4630921dfecaa4faef2a39a77205
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Sat Sep 4 16:04:28 2010 -0500
    
        Bytecode size reductions for stack-based nil-initialization of locals and for x, *y and x, * forms of masgn.
    
    commit 3a8fb16f020c2b9aaa6228605bdb3d8fd1b78ccf
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Sat Sep 4 14:52:04 2010 -0500
    
        Do not do direct recursive invocations for heap-based scopes, since the scope is not currently being reset.
    
    commit ec00e99636667eff97a891917ae9ef37f94a6eb7
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Fri Sep 3 19:55:24 2010 -0500
    
        Turn on dynopt by default, to aid testing of new logic.
    
    commit 9508e8a6925fce4f57a386ede867b3f8f9b67d38
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Thu Sep 2 12:40:38 2010 -0500
    
        Fix Time test that expected two separate Time.now objects to to_s the same.
    
    commit 65ba8b37a8a232495453e71b2a560c761b40893f
    Author: Nick Sieger <nick@nicksieger.com>
    Date:   Mon Aug 30 14:50:03 2010 -0500
    
        Use new backtrace info to set a more useful Java thread name
    
    commit 75b100604af39de52b26bdb21669136234424a0b
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Mon Aug 30 11:37:49 2010 +0900
    
        Fix ifne/ifeq bug in dynopt guard and switch DefaultMethod to not flip generations on JIT in dynopt mode.
    
    commit fe3b408629e94b7db0436152968bd6d2232f6c7c
    Merge: eea60da 85c64c6
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Sun Aug 29 20:33:06 2010 +0900
    
        Merge branch 'master' into backtrace
    
    commit eea60da3905c87c16fbb4e6c78fd7a07f842e4bd
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Fri Aug 27 14:09:44 2010 +0900
    
        Modify Java Fixnum fib bench to use the long call paths where possible, to be more like what compiled Ruby does not.
    
    commit a189563d9073208292e91aff3eb1c88489bd113d
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Wed Aug 25 15:07:21 2010 +0900
    
        Fixes for jitted/compiled backtrace generation
    
        * SClass in a method body needs to frame, so it has a jump target for non-local return
        * Compiled methods need to always have their ruby name in the method name, so it can be mined out appropriately
        * Synthetic calls, like to rescue bodies, need to gobble caller frames to avoid multiple entries
    
    commit 276226de611cb8d5af942148109c2a51982e7640
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Wed Aug 25 14:03:44 2010 +0900
    
        Add callNumber tracking to method handles, to properly handle return jumps.
    
    commit b94bcf119a54f52ab9be3c86bc5cc85078f20eee
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Wed Aug 25 13:16:25 2010 +0900
    
        More fixes for hybrid backtrace:
    
        * Get generated trace to be RaiseException's Java trace
        * Add Ruby exception name to the RaiseException message
        * Rewire and repair trace calls
    
        All main suite tests now pass in interpreted mode.
    
    commit dc9fcd3de0f3070507ac0a0647973d1e9f16ae4f
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Mon Aug 23 14:38:47 2010 -0500
    
        Fix debug logging of exceptions being raised and patch a couple tests for new backtrace structure.
    
    commit 3acd3201d85e4da9186fa17d3a04bdc9db742e29
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Mon Aug 23 13:23:04 2010 -0500
    
        Include original source file in compiled Ruby, add missing "in" line for MRI rendering, and soften requirements in test_backtraces to allow for native elements in the backtrace.
    
    commit 728cf3983fbeffba944fe34a8b0e410cc1de041c
    Merge: 88a64de 0e9c956
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Mon Aug 23 00:18:07 2010 -0500
    
        Merge branch 'master' into backtrace
    
    commit 88a64de879446be3398ba7671b5fa1f3e46ce02f
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Sun Aug 22 17:29:21 2010 -0500
    
        Turn on "positionless" compilation, since compiled code no longer needs to update interpreter backtrace frames. Also fix nil/null backtrace rendering.
    
    commit 5712a4ce285a5b3662c8ef8def2599223a232626
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Sun Aug 22 17:18:17 2010 -0500
    
        Fix off-by-one line numbers from interpreter frames.
    
    commit 519f4625b9d9658f50b986b1add560903ee453de
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Sun Aug 22 17:10:47 2010 -0500
    
        Remove some old backtrace code no longer in use and get all "backtrace" method handles to generate with no frame at all (since Java stack is used now).
    
    commit 424d967df8a3b6ba277bdb1b530d4f7f62ecbc4a
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Sun Aug 22 16:52:29 2010 -0500
    
        Get Kernel#caller working with hybrid traces, get Rubinius rendering working again (partially), separate gathering and rendering of backtraces.
    
    commit a00822740712ddd924896feccc10f015fd20d4be
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Sun Aug 22 15:32:08 2010 -0500
    
        Mine method names out of AOT and JIT compiled stacktrace elements and get JIT using the original name of the method.
    
    commit 039d184ac5f798aed21870a7552b66c5973ca0eb
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Sat Aug 14 22:16:48 2010 -0500
    
        Simplify in-class encoding of StaticScope data.
    
    commit 876a762b8af88955bee598dfd0421805d9b47c40
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Sun Aug 22 01:41:44 2010 -0500
    
        Fixes to hybrid traces to get tests working better:
    
        * Omit Kernel#raise and the KernelJavaAddons rbRaise from traces
        * Handle getBacktrace when there's been no preparation
    
        Also modified test/testException.rb to allow internal line numbers for the "load" call, rather than MRI standard "whatever line it was called from".
    
    commit 06f1bd171d6897f651b3cebfd76551080acbfe40
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Sun Aug 22 00:39:59 2010 -0500
    
        Move backtrace management to a separate stack and implement mixed-mode backtrace generation.
    
    commit ca40e73a7c136dfdd3853f0cd62a73bf70a3a08f
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Sat Aug 21 20:56:50 2010 -0500
    
        Get all major interpreter entry-points passing through simple, known method bodies. First step toward mixed-mode backtraces.

commit e055dbe2e6a793916c7a8383d5a6f6aa0d1e6e7f
Author: Hiro Asari <asari.ruby@gmail.com>
Date:   Thu Oct 14 15:51:53 2010 -0400

    Formatting change. Avoid dangling 'if' clause on a line by itself. Also, reformat multi-line boolean conditions so that it is clearer that they indeed span multiple lines.

commit a5a4e3e8d66683a28e15ca79a803cd5b4541b057
Author: Charles Oliver Nutter <headius@headius.com>
Date:   Sun Aug 22 22:28:24 2010 -0500

    Multiple changes related to JRUBY-5026:
    
    * Fix Proc to do a metaclass == check before reusing existing Proc object on the block. Fixes JRUBY-5026
    * Update specs to pull in spec for JRUBY-5026
    * Update 1.9 stdlib and tag one new failing spec
    * Tag new URI ruby_bug failures in 1.8 stdlib

commit 813fb669e6e0929c352eda823ad98a53b39885c6
Author: Hiro Asari <asari.ruby@gmail.com>
Date:   Fri May 28 23:44:05 2010 -0500

    Optional args should be accounted for.

commit a65ac8036a8acfe133d235f83b5aa1635baaeffa
Author: Hiro Asari <asari.ruby@gmail.com>
Date:   Fri May 28 23:23:44 2010 -0500

    Fix some specs. If Proc is created by lambda, its argument count is strictly enforced; if it is created by proc, arguments count is elastic.

commit b9a9120f61e48cdad7fe82b0930380123abdcafd
Author: Hiro Asari <asari.ruby@gmail.com>
Date:   Tue May 25 23:14:46 2010 -0500

    Refactor block type tests for readability.

commit 9025773db5cc348f11713586e658dfeaf0b6ff05
Author: Hiro Asari <asari.ruby@gmail.com>
Date:   Mon May 24 16:50:55 2010 -0500

    Hmm. There really isn't a reason to use StringBuilder here.

commit 7aeb7261e245e75fe9d5ef9cbb7cd7bb3a46b9eb
Author: Hiro Asari <asari.ruby@gmail.com>
Date:   Mon May 24 16:45:58 2010 -0500

    Oops. "(lambda)" appears only in 1.9 mode.

commit 705ccbeca71ff954f559e575a7606f6282f0ff0a
Author: Hiro Asari <asari.ruby@gmail.com>
Date:   Mon May 24 16:38:24 2010 -0500

    Sneak in "(lambda)" in Proc#to_s string if it's a lambda.

commit 55ebe10c5ee673ec6559b37f97456f83b00ea605
Author: Hiro Asari <asari.ruby@gmail.com>
Date:   Sun May 23 15:47:46 2010 -0500

    Add Proc#lambda?

commit 4287b59d4fdc5c2061ca529793b72ef47b61de36
Author: Hiro Asari <asari.ruby@gmail.com>
Date:   Sun May 23 14:43:33 2010 -0500

    Use getBlock(), not getBlockArgNode().

commit a7411f4aacd2e15ba8505985f78c18f2be5683d6
Author: Hiro Asari <asari.ruby@gmail.com>
Date:   Sun May 23 14:40:46 2010 -0500

    Invert logic for returning parameters.

commit b42348036db1618509ba211fa747fd9e7f0198bf
Author: Hiro Asari <asari.ruby@gmail.com>
Date:   Sun May 23 13:47:23 2010 -0500

    Remove unnecessary comment.

commit b6793870b93b12a9ce0dfb7ad3cb9a0c890919df
Author: Hiro Asari <asari.ruby@gmail.com>
Date:   Sun May 23 13:40:23 2010 -0500

    Pass all Proc#parameters specs.

commit 1b103f4e10ee13046d485a4e695d3c167e337a87
Author: Hiro Asari <asari.ruby@gmail.com>
Date:   Sun May 23 12:12:19 2010 -0500

    First pass at Proc#parameters implementation

commit c0cd8bd2315abfbb2bdfd26d7c17289ee76bbb74
Author: David Calavera <david.calavera@gmail.com>
Date:   Sun Apr 11 12:07:12 2010 +0200

    JRUBY-4457: adds methods Proc#yield and Proc#source_location
    
    Signed-off-by: Charles Oliver Nutter <headius@headius.com>

commit 3587b5568a35e5b1b2e6fade9365d8b329a0b912
Author: Charles Oliver Nutter <headius@headius.com>
Date:   Sun Jan 10 17:32:24 2010 -0600

    Replace the JumpTarget class with an int wherever it's used, to help ensure it will be unique (within a given thread). Also includes a replacement of catch/throw logic with "one-shot" callcc logic to avoid the need for ThrowJump and JumpTarget in catch logic.

commit cbe7b2b79086f8818bee2e14109207c902fcb3bf
Author: Charles Oliver Nutter <headius@headius.com>
Date:   Sun Jan 10 14:58:12 2010 -0600

    Fix for JRUBY-4262: Weird Proc test makes JRuby to skip the rest of the tests completely

commit 6ba2522adc631a2a6295bba2414aac6309f8841a
Author: Thomas E. Enebo <tom.enebo@gmail.com>
Date:   Thu Dec 31 17:00:47 2009 -0600

    JRUBY-4180: [1.8.7] Blocks should be able to receive block arguments (interpreted-mode only + some internals)

commit 02b8e01b4686b05da6762dd69950835d57dcd653
Author: Charles Oliver Nutter <headius@headius.com>
Date:   Sat Dec 19 14:24:28 2009 -0600

    Remove MiniJava and all the tendrils it extended through JRuby. Useful remainder moved to org.jruby.java.codegen.RealClassGenerator.

commit 13c40aeb515d14e62db6cb469a560d900a27647e
Author: Charles Oliver Nutter <headius@headius.com>
Date:   Wed Dec 16 00:59:55 2009 -0600

    Set reified class for all the primary core classes, so they'll work properly when extended and an interface gets included.

commit d7a8a7925d398ce9230469e728f667f63c23a32d
Author: Ola Bini <ola.bini@gmail.com>
Date:   Tue Aug 4 12:11:35 2009 +0200

    Remove lots of tags, add some new one and make Proc#== work correctly for 1.8.7

commit 1fb1e67941341613dd891109209b45f1ea9d8838
Author: Charles Oliver Nutter <headius@headius.com>
Date:   Sat May 30 12:41:21 2009 -0500

    Fix for JRUBY-3714: ActiveMessaging poller stops silently with JRuby 1.3.0RC1 and RC2.
    
    The problem here was that when we built a brand new static scope to contain a Thread's backref/lastline values, we were not entirely copying the original scope. Specifically, we were not using the original scope's previousCRefScope, instead allowing the scope to re-determine what cref scope to use. It ended up choosing the wrong one the second time through, resulting in cvars being incorrectly looked up. Modifying Thread proc creation to also copy the original cref scope fixed the issue.

commit 59a4474a6105bdf80cea3b1772b2cdf5ed36390d
Author: Thomas E. Enebo <tom.enebo@gmail.com>
Date:   Tue May 19 15:57:18 2009 -0500

    Whoops main part of patch missing from last commit

commit 0a405a33b0704d7dc53b676b34ce7d3e6b735782
Author: Charles Oliver Nutter <headius@headius.com>
Date:   Thu Apr 9 17:02:03 2009 -0500

    Final fixes for migration to DynamicScope as container for backref and lastline. This re-fixes the Thread.new block behavior for backref/lastline.

commit 7fd3e6ac11958be27cd180fa9853e17b6648babd
Author: Charles Oliver Nutter <headius@headius.com>
Date:   Tue Mar 3 00:23:44 2009 +0000

    Re-add cloning of block on proc calls, since it seems to break something in Rails. JRUBY-3451.
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@9340 961051c9-f516-0410-bf72-c9f7e237a7b7

commit d122b96f305a63ca98208dea5653ececbf3000a5
Author: Charles Oliver Nutter <headius@headius.com>
Date:   Tue Jan 13 15:54:25 2009 +0000

    First steps for block/proc optz.
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@8744 961051c9-f516-0410-bf72-c9f7e237a7b7

commit 2413ec2587f6c460b702f4be9afbc562f6127c4f
Author: Charles Oliver Nutter <headius@headius.com>
Date:   Sun Dec 28 20:20:10 2008 +0000

    Reduce default size of various arraylists used for lazy method initialization in JI, and dereference installers after they've done their job.
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@8492 961051c9-f516-0410-bf72-c9f7e237a7b7

commit 1625c391189c533bf126a7af2e89fa90ce008d88
Author: Charles Oliver Nutter <headius@headius.com>
Date:   Sun Dec 28 10:31:16 2008 +0000

    Remove a cloneBlock call that appears to be unnecessary now with our pre-duping Binding. Again, we'll probably need to do a more thorough analysis later, but for now this speed sup proc and define_method invocation by nearly 30%.
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@8491 961051c9-f516-0410-bf72-c9f7e237a7b7

commit bf8db0bc4acaeed7900b867e821e959f254be0be
Author: Thomas Enebo <tom.enebo@gmail.com>
Date:   Sat Nov 22 22:57:11 2008 +0000

    Biggest commit eva (1.9 parser+1.9-runtime-related-changes landing)
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@8099 961051c9-f516-0410-bf72-c9f7e237a7b7

commit 74deae83536b0efcbf299a4e57002769a16c3a61
Author: Charles Oliver Nutter <headius@headius.com>
Date:   Sat Oct 11 22:10:15 2008 +0000

    Fix for JRUBY-3049: EXCEPTION_ACCESS_VIOLATION
    
    This commit has several changes to simplify jump exception handling in while loops:
    * The "reason" for LocalJumpError is now based on an enum, so there's no need to .equals a string
    * Redo handling is now a separate try/catch chunk contained within the loop, rather than part of the larger chunk outside it. This prevents the redo from jumping back into the exception-handling logic, which was the source of the crashing.
    * LocalJumpError handling within a while loop is now implemented as a RuntimeHelpers call that checks for redo|break|next and *rethrows* a normal JumpException subtype. This allows the jump-handling logic to be reused, and moves the LJE-juggling to a separate piece of code.
    Not only does this solve the segfault, it also substantially reduces the amount of code emitted for a jumpexception-aware while loop.
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@7871 961051c9-f516-0410-bf72-c9f7e237a7b7

commit 16c2535acd64558d402fb75f37709dc1644cbcb8
Author: Charles Oliver Nutter <headius@headius.com>
Date:   Sun Aug 10 21:21:51 2008 +0000

    Clean up numerous cases where we box args unnecessarily by calling newer specific-arity "invoke" methods on RuntimeHelpers.
    
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@7429 961051c9-f516-0410-bf72-c9f7e237a7b7

commit aeb0ace7fa2f23649c0edbba98bec6d04d69af21
Author: Charles Oliver Nutter <headius@headius.com>
Date:   Tue Jul 8 00:16:43 2008 +0000

    Add an "escaped" flag to Block to allow properly handling the cases of a break above and below the closure's instantiating frame correctly. Doesn't appear to be the right logic for return, so there's probably more work to be done here. But all break specs pass with this.
    
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@7124 961051c9-f516-0410-bf72-c9f7e237a7b7

commit e72ca1a779973651923c718589f36379ac01280f
Author: Thomas Enebo <tom.enebo@gmail.com>
Date:   Mon Jul 7 23:41:03 2008 +0000

    Miscellaneous crap: rubyobject.getRuntime to TC.getRuntime; @overrides; searchMethod change
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@7122 961051c9-f516-0410-bf72-c9f7e237a7b7

commit dd6961afadc591749d9f79edcb83ba8f788005bd
Author: Charles Oliver Nutter <headius@headius.com>
Date:   Mon Jul 7 03:31:44 2008 +0000

    Rework of how break and return handle jump targeting. Now all frames have a final jumpTarget field used as the target for the non-local jumps, rather than using the block body (which is static and breaks cases where the block is passed through multiple levels) or null (jump target will never be null now). For JRUBY-2756.
    
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@7110 961051c9-f516-0410-bf72-c9f7e237a7b7

commit 7de6594072a7c0ef3377c9520d0a3f65d32173e0
Author: Charles Oliver Nutter <headius@headius.com>
Date:   Fri May 23 13:47:04 2008 +0000

    A bit more cleanup for ProcMethod and define_method-related code like Proc#call. JRUBY-1387
    
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@6771 961051c9-f516-0410-bf72-c9f7e237a7b7

commit ea1d62ff87ad41a4ada3733e39a616d5401075db
Author: Charles Oliver Nutter <headius@headius.com>
Date:   Sat May 17 04:08:16 2008 +0000

    * Make all additional methods bound into core classes by minijava use faster JavaMethod-based methods
    * Eliminate "as" method in favor of a "to_java" variant that takes a Java class arg
    
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@6722 961051c9-f516-0410-bf72-c9f7e237a7b7

commit 424a1cbff5aea37f2f92cc208d29d2544f092828
Author: Ola Bini <ola.bini@gmail.com>
Date:   Wed Mar 19 12:21:15 2008 +0000

    Annotate the rest of the Java classes with names, parents and inclusions. Also add a warning to install_doc.
    
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@6291 961051c9-f516-0410-bf72-c9f7e237a7b7

commit 852d904134ad970a20497fdcc5d752dd4ae49766
Author: Thomas Enebo <tom.enebo@gmail.com>
Date:   Fri Mar 7 22:04:54 2008 +0000

    The RC3 Surprise!
    
    Allow annotation defined ruby methods to optionally specify ThreadContext as first parameter
    Convert easiest and most common methods to accept ThreadContext when method or child method can use context
    
    These changes give about 15% improvement on petstore bench and about 10% in ar-bench.  In ar-bench getCurrentContext calls go from 14 million down to 2 million.  The remaining calls largely can be removed but they were much more invasive.
    
    IRubyObject op_eqq and op_equal both not have ThreadContext consumer, but we could see no use of this in any extensions and figured it worth the trouble of converting.
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@6143 961051c9-f516-0410-bf72-c9f7e237a7b7

commit 4a8d0c002367f44684bcdb677665abbb406a66e1
Author: Thomas Enebo <tom.enebo@gmail.com>
Date:   Wed Feb 20 19:43:48 2008 +0000

    JRUBY-1931: Wrong execption backtraces from unit tests (patch by Vladimir Sizikov and me)
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@5983 961051c9-f516-0410-bf72-c9f7e237a7b7

commit 55b1e747d6fd02d03695b731dbb28af9bef191a1
Author: Thomas Enebo <tom.enebo@gmail.com>
Date:   Fri Jan 25 23:45:51 2008 +0000

    Phase I: Stop using ISourcePosition in runtime
      - Removes need to manage extra fields in compiler reducing memory size of methods
      - Seperates setting of setting line and file (later commit will be doing a lot less setFile's)
    
    - Removed a chunk of dead code from RubyKernel.eval
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@5747 961051c9-f516-0410-bf72-c9f7e237a7b7

commit b3d416662a9b358da11a63a1900dd8a917340322
Author: Charles Oliver Nutter <headius@headius.com>
Date:   Sat Jan 12 23:24:11 2008 +0000

    Multiple cleanups:
    * Remove most Arity.checkArgumentCount calls since they're handled by generated method handles now
    * Add javadoc comments to MethodFactory impls and their public methods.
    
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@5576 961051c9-f516-0410-bf72-c9f7e237a7b7

commit 38b1f0a8f4a827c05a4ce7d19203c2a88382ce56
Author: Charles Oliver Nutter <headius@headius.com>
Date:   Thu Jan 3 09:58:38 2008 +0000

    Fix for JRUBY-1871, Kernel#proc should raise ArgumentError if no block is available.
    Also removed some scary, scary code in RubyThread#adoptThread that appeared to be launching a new thread for each thread adopted, using that thread as a runnable! Good god, who knows what it might have been doing!
    
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@5475 961051c9-f516-0410-bf72-c9f7e237a7b7

commit fe64fc9d6aa7065965c8bbf0f7eaad16dada507e
Author: Charles Oliver Nutter <headius@headius.com>
Date:   Wed Jan 2 18:20:03 2008 +0000

    Split call site into two versions, once for block calls one for non-block calls, to speed up non-block calls and correctly propagate jumps/jumperrors through both types of calls. This resolves some new spec failures, but more remain to be fixed.
    
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@5458 961051c9-f516-0410-bf72-c9f7e237a7b7

commit a694709e87e269be436ed1d176a688712beb9d5d
Author: Thomas Enebo <tom.enebo@gmail.com>
Date:   Tue Jan 1 05:09:53 2008 +0000

    Remove unused callbackfactorys
    Add partial impl of Etc with some cooler pieces of it still commented
    Remove many warnings
    Some generics to lessen warnings
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@5456 961051c9-f516-0410-bf72-c9f7e237a7b7

commit 4e410a9776934743efa9061ac7dcb4f52e5d4aeb
Author: Charles Oliver Nutter <headius@headius.com>
Date:   Sat Dec 29 21:14:40 2007 +0000

    Fix for JRUBY-1835.
    
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@5426 961051c9-f516-0410-bf72-c9f7e237a7b7

commit 0d08d8c94f38d7e1242ce886bef5fca6ee4531a6
Author: Charles Oliver Nutter <headius@headius.com>
Date:   Fri Dec 21 22:09:29 2007 +0000

    Fix for JRUBY-1415 from Takanori Ishikawa and my own fix for incorrect positioning information in compiled blocks. Also a Proc#to_s test.
    
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@5331 961051c9-f516-0410-bf72-c9f7e237a7b7

commit 0e0b2c6b332d370abb9d295fcec1955acff80117
Author: Charles Oliver Nutter <headius@headius.com>
Date:   Sat Nov 10 06:05:16 2007 +0000

    Block refactoring: Detach Binding from Block.
    
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@4900 961051c9-f516-0410-bf72-c9f7e237a7b7

commit 47fc3bf1ebb3d45594f50d9ccc88d56e8aadeba2
Author: Charles Oliver Nutter <headius@headius.com>
Date:   Fri Oct 26 19:26:48 2007 +0000

    Fix for JRUBY-1468, fixes the original issue, adds a whole raft of tests, and fixes a few additional issues discovered.
    
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@4747 961051c9-f516-0410-bf72-c9f7e237a7b7

commit 9bc9825436ea08670905a6e2a06d760a97b71d70
Author: Charles Oliver Nutter <headius@headius.com>
Date:   Fri Oct 19 20:52:01 2007 +0000

    Migrate JRubyMethod annotation to use String[] for names and aliases. Thanks Brad C from my blog.
    
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@4623 961051c9-f516-0410-bf72-c9f7e237a7b7

commit 0b7a2dae2ec0baa531f313568ffc9b7382f89592
Author: Charles Oliver Nutter <headius@headius.com>
Date:   Fri Oct 12 01:50:08 2007 +0000

    Migrate annotation-based method binding to generate DynamicMethod implementations directly, with arity checking built-in
    
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@4575 961051c9-f516-0410-bf72-c9f7e237a7b7

commit 382a4e74803c52a75faf410ef627b6c5220b1cbe
Author: Charles Oliver Nutter <headius@headius.com>
Date:   Thu Oct 11 05:32:40 2007 +0000

    More API fixes, adding a few missing methods and adding others as "not implemented"
    
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@4565 961051c9-f516-0410-bf72-c9f7e237a7b7

commit 4882297248ab9ac980b6669393f78a9f5c7d58c9
Author: Charles Oliver Nutter <headius@headius.com>
Date:   Wed Oct 10 06:11:34 2007 +0000

    Migrate Proc, Process, Precision, Range, and ObjectSpace to annotation binding
    
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@4544 961051c9-f516-0410-bf72-c9f7e237a7b7

commit 3e88cfab0d224fb9efa8d18336993e2c78ce495e
Author: Marcin Mielżyński <lopx@gazeta.pl>
Date:   Thu Sep 27 16:40:57 2007 +0000

    - Identified and extracted construction paths for class/module/singleton/IncludedModuleWrapper, now there's no unnecessary null checks or assignments in their constructors (they take very few arguments so even asserts are not needed).
    Each of those constructors have a comment what is it the responsible for, also, two RubyClass.newClass() and two RubyModule.newModule() methods have been extracted.
    - Fixed logic that sets the parent/constant for Modules, now matches MRI (only setConstant/getConstantAt are used here).
    - RubyClass rewritten, special attention has been put on allocation logic, now Class.new(...) doesn't fire a separate allocator class. (btw, logic of "class B < A;end" and "Class.new(A)" must be split since in second case superclass and allocator are not known until initialize is called). Class/Object allocation implementation mimics MRI's weirdest quirks in behavior, is _much_ simpler that it has been and much faster. This also allowed creation of generalized clone/dup implementations matching MRI. (only our special ivars need a care here).
    - Rewritten bootstrapping of Object/Class/Module.
    - Core classes (except Exception hierarchy, they should also be in future) are now cached in runtime (MRI caches them in static VALUE's like rb_cObject) Ruby.getClass(String), Ruby.getModule(String) and Ruby.getClassFromPath(String) should be used only by either interpreter or compiler and when the class name is not known at compile time.
    - Fixed and simplified nodes: classNode, moduleNode, sclassNode, defsNode. Compiler has been synchronized here as well.
    - No more __attached__ as ivar, it is now MetaClass field (which means lazy ivars for singletons). Compiler also updated.
    - added and dosumented isModule() to IRubyObject (isClass(), isSintleton() documented).
    - Fixed test_autoload test (Object.class_eval do;autoload :SomeClass, 'somefile';class SomeClass; end;end) should raise LoadError, now matches MRI.
    
    - Fixed a number of minor bugs:
       1.instance_eval, was creating a metaclass for Fixnum instances (also affected Symbol/FalseClass/TrueClass/NilClass)
       marshaler objects were kept in singleton classes
       Range.inspect, was modifying the begin field (when it was a String)
       Many bulletproofings in Marshal/Unmarshal (like unmarshaling an instance of nonexistant class), TypeErrors/ArgumentErrors matching MRI.
       Fiber.new in 1.9, doesn't call #initialize method by funcall, fixed
       number of method arity fixes and many methods are made fast now
       fixed initialize/initialize_copy logic, further simplification, no ClassCastExceptions possible now
       Fixed defineClass(under)/defineModule(under) logic
       bulletproofed cases such: class A;end;module A;end
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@4409 961051c9-f516-0410-bf72-c9f7e237a7b7

commit 9b81e344cce9846b7aef38ca3f461f34f46f4d54
Author: Charles Oliver Nutter <headius@headius.com>
Date:   Sat Jul 14 03:54:58 2007 +0000

    Creating the concept of a CallConfiguration, which knows how to frame and scope a call. This will be used to alter the way an existing method frames and scopes in response to static or dynamic code profiling.
    
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@4015 961051c9-f516-0410-bf72-c9f7e237a7b7

commit 3a702509c34d17ebd8e78348652a03a0c3f70d7f
Author: Charles Oliver Nutter <headius@headius.com>
Date:   Fri Jul 6 07:19:35 2007 +0000

    Revert to type-specific JumpException subclasses to allow Java exception-handling to do more flow control work for us. Since most signs point to non-local returns (and other flow-control) in the upcoming Closures spec for Java using exceptions, this is going to safely remain into the future.
    
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@3964 961051c9-f516-0410-bf72-c9f7e237a7b7

commit 91616eb85c5842df301b5632c5d802f5fcd74d25
Author: Charles Oliver Nutter <headius@headius.com>
Date:   Tue May 22 15:24:56 2007 +0000

    Fixes for JRUBY-544, add trace_var functionality. MRI's test_trace passes 100% now.
    
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@3702 961051c9-f516-0410-bf72-c9f7e237a7b7

commit f057b63debf51871b3c4851e51e492661501b6da
Author: Charles Oliver Nutter <headius@headius.com>
Date:   Mon May 21 05:40:56 2007 +0000

    Fix for JRUBY-787, and introduced more correct LocalJumpError class.
    
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@3692 961051c9-f516-0410-bf72-c9f7e237a7b7

commit bac69eda717fe181084e119979408a1e8ad389f8
Author: Thomas Enebo <tom.enebo@gmail.com>
Date:   Mon Apr 16 22:38:58 2007 +0000

    Remove remaining metaclass definitions...
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@3480 961051c9-f516-0410-bf72-c9f7e237a7b7

commit dce410d617322b8a3caf7121c38cd4ec3f4d809b
Author: Thomas Enebo <tom.enebo@gmail.com>
Date:   Thu Apr 12 01:39:53 2007 +0000

    wrapper not used....Remove from context and friends (Merging 'safe' things from my sandbox)
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@3436 961051c9-f516-0410-bf72-c9f7e237a7b7

commit 210bfe06326742b4d486cc3c0daea9c96768f5ab
Author: Charles Oliver Nutter <headius@headius.com>
Date:   Thu Apr 5 05:07:02 2007 +0000

    JRUBY-771 Remove CreateJumpTargetVisitor, in a temporary way until Tom's branch lands
    
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@3390 961051c9-f516-0410-bf72-c9f7e237a7b7

commit 3260440b2c1dc5fecb4af1ea1b570f59e5fd711e
Author: Charles Oliver Nutter <headius@headius.com>
Date:   Wed Apr 4 05:18:16 2007 +0000

    JRUBY-622 fix
    
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@3375 961051c9-f516-0410-bf72-c9f7e237a7b7

commit a2107e60085a5063bca76d897783a512bbd7eddc
Author: Thomas Enebo <tom.enebo@gmail.com>
Date:   Sun Feb 18 15:18:18 2007 +0000

    JRUBY-606: Get rid of un/under-used IRuby interface
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@3022 961051c9-f516-0410-bf72-c9f7e237a7b7

commit 2c87b1ca376c4a7ab16c50d3fe0bd84a66737dc5
Author: Thomas Enebo <tom.enebo@gmail.com>
Date:   Tue Feb 13 21:06:49 2007 +0000

    evalUnder should use previous frames self instead of null
    removed some dead code in jumpexception and its use
    refactored jumpexception to use better names for data
    tweaked miguels patch for JRUBY-530 to work with my refactorings
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@2995 961051c9-f516-0410-bf72-c9f7e237a7b7

commit ef423f1b886650195114fe952a1a6407fbb63f82
Author: Thomas Enebo <tom.enebo@gmail.com>
Date:   Wed Feb 7 22:27:41 2007 +0000

    - Create a NULL_BLOCK to replace null checks against blocks:
      - Now isGiven() on a block tells you whether it is supplied or not
      - yield on the NULL_BLOCK throw the correct exception
        - We were not throwing this correctly by most callers with my landing of
          the block branch
        - We were generating NPE in cases where we called something that requires
          a block and supply none
    - Block.blockObject => Block.proc
     - Rename and type since this is just a convenience reference for association
       from block to what proc it might represent
    - Remove unused blockAtCreation (this may become relevent for Ruby 2 but why do
      it now
    - Remove ThreadContext and IRuby from Frame
    - Remove Scope
    - Put Visibility directly on Frame
    - callingzsuper dead code
    - Now that modules have a proper superclass we can get rid of special code in
      callSuper
    - ArgsPushNode.childNodes should not return null
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@2956 961051c9-f516-0410-bf72-c9f7e237a7b7

commit 5c0789044de8703f41bdf83f29552ba29ad048f6
Author: Thomas Enebo <tom.enebo@gmail.com>
Date:   Sat Jan 27 17:31:22 2007 +0000

    JRUBY-484: Reverse Iter Call relationship in AST and also pass block via Java frame versus maintaining blocks in TC
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@2851 961051c9-f516-0410-bf72-c9f7e237a7b7

commit f00dfc9fcfb4c7a9ffbe605bd4cbf08cd2e9cb60
Author: Charles Oliver Nutter <headius@headius.com>
Date:   Sat Jan 6 01:42:03 2007 +0000

    Committing changes for JRUBY-405. I've accomplished what I set out to do, which was moving all the yield logic into Block and other appropriate classes. Other block refactoring, including adding a block argument to the call pipline, will come in other JIRAs.
    
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@2685 961051c9-f516-0410-bf72-c9f7e237a7b7

commit 048e5b9179a657d1e786630b4cb43ae2bfdfbe4a
Author: Ola Bini <ola.bini@gmail.com>
Date:   Thu Dec 21 14:50:36 2006 +0000

    Fix for JRUBY-346, by Michael Studman
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@2583 961051c9-f516-0410-bf72-c9f7e237a7b7

commit 05e043a3d729e0806e80df15ff4d7ec770c41b45
Author: Charles Oliver Nutter <headius@headius.com>
Date:   Thu Aug 17 17:45:57 2006 +0000

    JRUBY-91: ensure blocks aren't passed through to procs; removed a line in RubyProc that duplicated behavior from block creation and broke block passing
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@2205 961051c9-f516-0410-bf72-c9f7e237a7b7

commit dc9ebc85bd64040a28aeb6d23b3a4c90f21a9b7b
Author: Charles Oliver Nutter <headius@headius.com>
Date:   Sat Aug 5 05:54:15 2006 +0000

    optz: avoid multiple calls to IRuby.getCurrentContext in a single method
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@2165 961051c9-f516-0410-bf72-c9f7e237a7b7

commit 62395b140d1fb0b5b75ba224eb0f4b564f70979b
Author: Thomas Enebo <tom.enebo@gmail.com>
Date:   Sat Apr 22 17:49:30 2006 +0000

    More Railing:
    - Define StringIO.path (nil for IO compat)
    - Make StringIO.print not append $\ if it is nil
    - Add Kernel#warn
    - Allow Object.eval to accept a Proc as scope argument
    - Add Proc.binding
    - Make ||= work with class vars (fixes: @@c ||= 'a')
    
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@2009 961051c9-f516-0410-bf72-c9f7e237a7b7

commit 1d43870a42678f709851fcd9349d32a5f5be0dca
Author: Charles Oliver Nutter <headius@headius.com>
Date:   Thu Feb 2 19:51:50 2006 +0000

    merging cnutter_work1 to HEAD
    
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@1869 961051c9-f516-0410-bf72-c9f7e237a7b7

commit 4ede4bfb0b4fcc29ce09b82da5f1164b5894d258
Author: Charles Oliver Nutter <headius@headius.com>
Date:   Thu Nov 10 15:09:14 2005 +0000

    TC method refactoring, renaming, inlining of TC-related IRuby methods
    
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@1825 961051c9-f516-0410-bf72-c9f7e237a7b7

commit a1a6cebc8670e0beb27e1a9ddc0325c7a3ba97e6
Author: Charles Oliver Nutter <headius@headius.com>
Date:   Fri Nov 4 18:03:34 2005 +0000

    centralizing blockstack accesses
    
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@1824 961051c9-f516-0410-bf72-c9f7e237a7b7

commit 41adc9d73b44b14dd25593e772188d405ec00f2f
Author: Charles Oliver Nutter <headius@headius.com>
Date:   Wed Oct 26 05:34:12 2005 +0000

    removing revision keywords
    
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@1810 961051c9-f516-0410-bf72-c9f7e237a7b7

commit f5643d27aa7a2dd836ef19c758a0a13351434da4
Author: Charles Oliver Nutter <headius@headius.com>
Date:   Fri Oct 21 01:04:27 2005 +0000

    merging cnutter_work2 to HEAD...damn the torpedos! full speed ahead!
    
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@1807 961051c9-f516-0410-bf72-c9f7e237a7b7

commit 4dfdacd80c56018084c618f3bbab7b542653d95e
Author: David Corbin <dcorbin@users.sourceforge.net>
Date:   Sat Oct 8 13:07:06 2005 +0000

    Introduced IRuby interface for Ruby runtime object.
    
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@1798 961051c9-f516-0410-bf72-c9f7e237a7b7

commit 36ec84bb4bc5dbd391c6ddb676b2faeb380f0539
Author: Charles Oliver Nutter <headius@headius.com>
Date:   Tue Sep 6 14:57:59 2005 +0000

    merging exception-removal changes to HEAD; EvaluateVisitor changes left on branch for now
    
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@1757 961051c9-f516-0410-bf72-c9f7e237a7b7

commit ca6b16e996ea9af83ce593594b9c69b9364a9924
Author: Thomas Enebo <tom.enebo@gmail.com>
Date:   Sun Aug 28 13:29:33 2005 +0000

    Kill RubyClasses (core class/modules now initialized in Ruby)
    Store all top-level classes as constants within Object (fixes things like Object.constants) instead of second datastore
    Always load all core classes (remove lazy loading)
    Convenience function RubyModule#getClass added
    Convenience function Ruby#getObject added
    JavaObject and JavaArray are now Java::JavaObject and Java::JavaArray to be consistent
    classes defined under another class/module are now defined in the parents creation routine
    Removed some masking warnings
    
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@1739 961051c9-f516-0410-bf72-c9f7e237a7b7

commit 50d6342dd5da06c42d25bc955addce6aaa0e6b97
Author: Thomas Enebo <tom.enebo@gmail.com>
Date:   Mon Aug 1 17:12:52 2005 +0000

    Creating extra block when we shouldn't (fixes Roberts builder example from mailing list)
    Java List objects can now use collect without throwing exception
    Remove 'construct' from Enumerable
    Smaller block/proc fixes
    
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@1732 961051c9-f516-0410-bf72-c9f7e237a7b7

commit a36ff3729d6a7f2c61eb51273fcee3d3bd371350
Author: Thomas Enebo <tom.enebo@gmail.com>
Date:   Sat Jun 18 14:47:06 2005 +0000

    More moving towards java.util.Stack contract for remaining Abstract Stack users
    args are never null (we no longer null check with a few strategic asserts)
    getPosition() always returns something from Nodes (we no longer null check)
    Remove AttrSetNode (fake parser node) in favor of CallbackMethod
    we were pushing/popping an extra dynamic vars set every yield
    
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@1715 961051c9-f516-0410-bf72-c9f7e237a7b7

commit 0db25dd3ae06c744963d9b04bf3465fa3673f030
Author: Thomas Enebo <tom.enebo@gmail.com>
Date:   Thu Jun 16 14:54:07 2005 +0000

    Move abstract stack users a few steps closer java.util.Stack contract
    
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@1711 961051c9-f516-0410-bf72-c9f7e237a7b7

commit f11a64355c32c907a28e8c0cb8ade2cfee15cb46
Author: Thomas Enebo <tom.enebo@gmail.com>
Date:   Tue Mar 22 04:56:36 2005 +0000

    All Proc.clone to work
    
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@1630 961051c9-f516-0410-bf72-c9f7e237a7b7

commit c967b1fb8129603fc9b02f122d18e41fc79e2bec
Author: Thomas Enebo <tom.enebo@gmail.com>
Date:   Mon Mar 21 21:14:21 2005 +0000

    Add missing Proc#to_proc
    
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@1629 961051c9-f516-0410-bf72-c9f7e237a7b7

commit 49e429d3ef8ba5a87828205e6b17dc0a93f1a53c
Author: Thomas Enebo <tom.enebo@gmail.com>
Date:   Sun Feb 13 20:25:46 2005 +0000

    Return from procs sometimes returned to wrong scope
    
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@1611 961051c9-f516-0410-bf72-c9f7e237a7b7

commit d37b51086924294c591f0b6214fd4a06d472516b
Author: Thomas Enebo <tom.enebo@gmail.com>
Date:   Tue Feb 8 06:02:50 2005 +0000

    Procs should check against arity
    
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@1605 961051c9-f516-0410-bf72-c9f7e237a7b7

commit 7a83c48af56081c1c2132111d535f28d10cf3afb
Author: Thomas Enebo <tom.enebo@gmail.com>
Date:   Fri Dec 31 20:55:52 2004 +0000

    Update license to GPL/LGPL/CPL
    
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@1574 961051c9-f516-0410-bf72-c9f7e237a7b7

commit 8081fdc23459ab3e7b62155a53b7f18b561f93c1
Author: Stefan Matthias Aust <sma@3plus4.de>
Date:   Sun Dec 12 14:55:16 2004 +0000

    removes type parameter from CallbackFactory.getXXXMethod()
    and removes CallType from AbstractCallback and ReflectionCallback
    
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@1476 961051c9-f516-0410-bf72-c9f7e237a7b7

commit 870e1da9b41bfdbae259e1fc5f18fc8b76686998
Author: Stefan Matthias Aust <sma@3plus4.de>
Date:   Sun Dec 12 09:25:42 2004 +0000

    removes the instance variable runtime in RubyObject
    reintroduces the variable in RubyNil, RubyBoolean, and RubyClass
    delegates all calls to Fixnum,Array,Boolean,String,ArgumentError,IndexError and TypeError.newXXX to Ruby
    fixes all imports
    
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@1469 961051c9-f516-0410-bf72-c9f7e237a7b7

commit 6c6d203022d4a6738769b37a6423ca82087317b6
Author: Thomas Enebo <tom.enebo@gmail.com>
Date:   Wed Dec 1 05:51:15 2004 +0000

    Update $VERBOSE to be nil, true, or false instead of boolean
    Make when *array work
    Remove unused import
    
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@1438 961051c9-f516-0410-bf72-c9f7e237a7b7

commit e6b5100a49718fc8d3cf73e804b366eae694748d
Author: Jan Arne Petersen <jpetersen@uni-bonn.de>
Date:   Mon Nov 29 14:12:07 2004 +0000

    Remove (or add a comment) to some empty blocks.
    Remove unused RubyDir#matches method.
    Remove some RegExp Adapter remains.
    Rename RubyObject#argCount to RubyObject#checkArgumentCount
    Fix the stacktrace of Exceptions.
    Fix RubyFile#expand_path method.
    Add LocalJumpError class.
    
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@1434 961051c9-f516-0410-bf72-c9f7e237a7b7

commit b1562832239a5e5d73b1ee98dade51601e343257
Author: Jan Arne Petersen <jpetersen@uni-bonn.de>
Date:   Tue Nov 16 20:30:04 2004 +0000

    Rename references of org.jruby.Ruby from ruby to runtime.
    Remove unused methods from the IRubyErrorHandler interface.
    Add "same" method to RubyObject to fix "equal?"
    Fix JavaObject cache.
    
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@1408 961051c9-f516-0410-bf72-c9f7e237a7b7

commit 2f1bed02528f5156e0639c881e162390c6a51662
Author: Thomas Enebo <tom.enebo@gmail.com>
Date:   Fri Oct 22 02:41:31 2004 +0000

    Make returns in block behave properly?  Including from Kernel#proc and Kernel#lambda
    
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@1354 961051c9-f516-0410-bf72-c9f7e237a7b7

commit a16b4a3596853f2153bfe0df0a8cbe54382d5d58
Author: Anders Bengtsson <ndrsbngtssn@yahoo.se>
Date:   Sat Feb 28 23:00:58 2004 +0000

    Removed a lot of old IndexedCallback stuff.
    
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@1254 961051c9-f516-0410-bf72-c9f7e237a7b7

commit 1c602493a83e2050f401fa6925ec7e9269b45e4e
Author: Thomas Enebo <tom.enebo@gmail.com>
Date:   Sat Feb 14 01:18:46 2004 +0000

    Removed all XML generation from source (getting rid of all indexed callback consumers except Object which uses a CVS committed Definition class). Fixed all numerical derived classes so that: 1. They all use the same equal/eql logic.  2. Removed all compariable methods that are already inherited. 3. Changed method signatures that want RubyNumeric to be RubyNumeric (versus IRubyObject)
    
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@1237 961051c9-f516-0410-bf72-c9f7e237a7b7

commit 9deb1f228825ac2708def7a459f658b2a57ef6db
Author: Thomas Enebo <tom.enebo@gmail.com>
Date:   Fri Dec 13 01:01:13 2002 +0000

    Make RubyProc use new Proc.xml
    
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@1169 961051c9-f516-0410-bf72-c9f7e237a7b7

commit 0a74ed833d5b4089f8adb98c997a1b4a97c44088
Author: Anders Bengtsson <ndrsbngtssn@yahoo.se>
Date:   Thu Nov 14 00:44:33 2002 +0000

    Created a semi-functional Proc#arity implementation.
    
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@1122 961051c9-f516-0410-bf72-c9f7e237a7b7

commit 13e69799e76f1dd3ab5912856ce9b0d9ff6e99af
Author: Anders Bengtsson <ndrsbngtssn@yahoo.se>
Date:   Sat Nov 9 15:12:41 2002 +0000

    Moved classStack and wrapper to ThreadContext; Cleanups.
    
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@1095 961051c9-f516-0410-bf72-c9f7e237a7b7

commit c77b91f42c4f3810140d44cbe603248a1d52b7ee
Author: Jan Arne Petersen <jpetersen@uni-bonn.de>
Date:   Tue Sep 10 15:18:12 2002 +0000

    - restructure of the code tree.
    
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@782 961051c9-f516-0410-bf72-c9f7e237a7b7
