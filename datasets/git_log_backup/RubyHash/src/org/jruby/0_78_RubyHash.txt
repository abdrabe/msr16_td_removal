commit ab541ab7a8e98fbd0c595232b152946c60bb75f3
Author: Alex Tambellini <atambellini@gmail.com>
Date:   Sat Jun 22 17:10:49 2013 -0400

    Fix TestM17N#test_hash_to_s

commit bcc26747f56e05bd1ceda21d97fd4b0bc5255f0c
Author: Ron Dahlgren <ronald.dahlgren@gmail.com>
Date:   Fri May 17 16:15:20 2013 -0700

    Use RubyModule.JavaClassKindOf fixes jruby/jruby#614
    
    I've changed all of the relevant cases of anonymous KindOf classes to
    use the new JavaClassKindOf. This cuts down on some of the noise
    produced by anonymous inner classes, especially given that these
    replacement points all had identical implementations.

commit fadedfec0d774e1f6dc547e48962b945c8d09904
Author: Charles Oliver Nutter <headius@headius.com>
Date:   Sat Jun 8 12:00:24 2013 -0500

    Deprecate and remove most of op_set19 logic that's the same now.

commit d81a3f49fac2c2ff12efa657221c4e990ac921a7
Author: Charles Oliver Nutter <headius@headius.com>
Date:   Sat Jun 8 11:19:41 2013 -0500

    Instanceof check is faster and basically equivalent to old logic.

commit 5a3d1013457f472d5358d19f7c976f18805ff9dd
Author: Charles Oliver Nutter <headius@headius.com>
Date:   Sat Jun 8 09:53:06 2013 -0500

    No reason for a null fillInStackTrace to be synchronized.

commit 8c890fe06f39a81fbfb2c7e8ad2851675e5c2538
Author: Charles Oliver Nutter <headius@headius.com>
Date:   Sat Jun 8 09:53:58 2013 -0500

    Add some whitespace for readability.

commit dbc140fa0329b1ed60a095327b3b414c3976506d
Author: Charles Oliver Nutter <headius@headius.com>
Date:   Sat Jun 8 08:59:25 2013 -0500

    Synchronize hash resizing, to avoid hangs under concurrent load.
    
    This change, suggested by Masayuki Onjo, improves the thread-
    safety of Hash by preventing two resizes from occurring at the
    same time. Such a situation can lead to a bucket's chain of nodes
    looping back on itself in the following way:
    
    * Thread A begins re-inserting elements from the old bucket
      list into the new bucket list. Elements that will go into
      the same bucket in the new list must be chained. As they
      are inserted, they become the new bucket head, pointing at
      whatever was in the bucket already.
    * Nodes X and Y would go into the same bucket in the new hash.
    * Thread A proceeds to puts X into the bucket; X.next = null.
    * Thread A proceeds with Y. Y.next = X.
    * At the same time, thread B begins performing the same resize
      operation against its own new bucket list.
    * Thread B proceeds to insert X. X.next = null.
    * Thread B proceeds with Y, saving its next value X. Y.next = X.
    * Thread B continues to X, because it must handle all chained
      nodes in the bucket where it found Y. It finds Y already in the
      new bucket where it inserts X. X.next = Y.
    * At this point, X.next = Y and Y.next = X, so walking the bucket
      will cause an infinite loop. The Hash is broken.
    
    Making the resize operation synchronized prevents two resizing
    threads from mixing old node chaining with new node chaining,
    reducing the likelihood of a broken hash.
    
    This does not, however, make Hash thread-safe. Inserts can still
    be lost if one thread adds an element during a resize operation,
    or elements can end up in the wrong buckets if updated during
    a resize (because their effective hash will change after the
    resize has already re-inserted the element). We will continue to
    explore ways to improve the thread-safety of Hash.

commit 0e1c37b606d294dd83960be498be48ee8a504edf
Author: Charles Oliver Nutter <headius@headius.com>
Date:   Tue Jun 4 15:28:13 2013 -0500

    Clean up Hash#fetch implementation.

commit bb98e4b8decffc0361b70a6c99c1ade5fed0abcb
Author: Charles Oliver Nutter <headius@headius.com>
Date:   Thu Mar 28 10:02:33 2013 +0000

    Move RuntimeHelpers to org.jruby.runtime.Helpers.

commit e537ec1c14cdc7c7dacad21c9089ae7dd9f1300b
Author: Charles Oliver Nutter <headius@headius.com>
Date:   Thu Mar 21 19:51:54 2013 -0500

    Fix replace/initialize_copy on frozen hash when other == self.

commit 8b22272f039e12cb3ccf13256f7f127380d5f848
Author: Charles Oliver Nutter <headius@headius.com>
Date:   Tue Mar 12 17:18:31 2013 -0500

    Additional fixes to get 'ant test' and 'mri19' suites green.
    
    * Hash head-resetting logic in alloc after construct, fixed.
    * Fixed 2.0-related change to Thread init, confused Thread.list.

commit 322103a11b1c8c162955049d4e31e604954b497d
Author: Charles Oliver Nutter <headius@headius.com>
Date:   Tue Mar 12 08:09:39 2013 -0500

    Minor improvements for Hash.
    
    * Avoid creating AtomicInteger by using updater or sync.
    * Avoid re-initializing "head" node.
    * Avoid updating generation unnecessarily at create time.

commit e4855a0093be422bdaad91195e5a10d1bf22929f
Author: Charles Oliver Nutter <headius@headius.com>
Date:   Mon Mar 11 14:44:07 2013 -0500

    New Hash#default_proc= and #to_h for 2.0 mode.

commit 8514b43643012b385366c0104e1d4f1f7a42df12
Author: Thomas E. Enebo <tom.enebo@gmail.com>
Date:   Wed Feb 27 17:29:21 2013 -0600

    Hash.inspect should be US-ASCII by default (mri test fixed)

commit c17ea46abc52ded080bd40511c155eb4d812601d
Merge: 0001ac3 91edda6
Author: Charles Oliver Nutter <headius@headius.com>
Date:   Tue Feb 26 13:29:54 2013 -0800

    Merge pull request #544 from glucero/master
    
    replacing a hash with itself returns an empty hash in ruby 1.9 compatibility mode

commit 61678ac1a2514a9932276f8d527816a5980a94b3
Author: Charles Oliver Nutter <headius@headius.com>
Date:   Mon Feb 25 20:41:40 2013 +1100

    Fix more references to CPL.
    
    The phrase "Common Public License" was split across two lines in
    our default header, which caused it to be missed during earlier
    search/replace. Also, we did not replace the CPL URL in the
    header with the EPL URL.

commit 91edda6f6910b49e85747eba1c03544563ae44f7
Author: Gino Lucero <glucero@gmail.com>
Date:   Wed Feb 20 17:14:33 2013 -0700

    replacing a hash with itself should not return an empty hash

commit 330fef3b0fc18af477ccea19bd278669667f31bb
Author: Charles Oliver Nutter <headius@headius.com>
Date:   Tue Feb 12 14:49:29 2013 -0600

    Switch JRuby's CPL license to EPL.
    
    Governance of the CPL license was moved to the Eclipse Foundation
    at some point in the past, and Eclipse blessed the EPL (Eclipse
    Public License v1.0) as the successor to CPL. Because the CPL
    contains a clause allowing transparent upgrades to future blessed
    successor licenses, we can make the move to EPL without
    re-contacting past contributors.
    
    The change in going from CPL to EPL largely just removes some
    punitive language that apparently made many companies nervous. All
    other language in the license remains identical.
    
    Several documents about Eclipse's move from CPL to EPL are here:
    
    http://www.eclipse.org/legal/cpl2epl/
    
    Note that Eclipse's move came before the blessing of EPL as the
    upgrade path for CPL, so they had to do a bit more legal juggling.
    With Eclipse now the administrator of CPL and with their blessing
    of EPL as the upgrade path for CPL, all we need to do is make the
    move.

commit f1c74ee21ed5095c9e757c3fced12a7a576c0eb0
Author: Charles Oliver Nutter <headius@headius.com>
Date:   Tue Nov 27 21:47:08 2012 -0600

    Hash equality should use rb_eq[ua]l equivalent to short-circuit.
    
    Fixes seattlerb/minitest#191.

commit aa2e98c27a2a4bfd2ff1a34be6248fc8c9706918
Author: Hiro Asari <asari.ruby@gmail.com>
Date:   Sun Nov 25 21:17:54 2012 -0500

    Fix RuntimeError message to more closely align with MRI's message.

commit cc1286514c7d165cdc4063e4cac1a8427863d9c3
Author: Charles Oliver Nutter <headius@headius.com>
Date:   Fri Nov 2 16:55:01 2012 -0600

    Set up small literal hashes and hash args using a single bucket.
    
    For many small literal hashes, especially those used for calling
    methods with hash args, allocating the default layout for a Ruby
    Hash is terribly wasteful. The default setup uses a bucket count
    of 11, which for a hash smaller than 11 wastes that many entries.
    Since many literal hashes and hash args are as small as one or two
    or three elements, I have modified literal hash creation to force
    a single bucket with no rehashing. This reduces memory allocation
    of a simple single hash-arg call from 6.4MB to 2.4MB and improves
    speed about 10-15%. There are additional improvements possible,
    such as not rechecking the bucket count for hashing the incoming
    keys.

commit d12ce78e160fa33ca40d5002a4da491d220cd532
Author: Charles Oliver Nutter <headius@headius.com>
Date:   Thu Oct 18 14:45:28 2012 -0500

    Revert "Hash#initialize_copy is an alias for #replace in MRI."
    
    This reverts commit 46e65b3b80921f1366ae59c94b66ca29edf2b459.

commit 0da1d51d1c39d086c15cc55c5039eac0f7f5fb9e
Author: Charles Oliver Nutter <headius@headius.com>
Date:   Thu Oct 18 14:45:04 2012 -0500

    Revert "initialize_copy is aliased to replace, but needs to be private."
    
    This reverts commit e214ee27ab90acf3a67861eef6949790f86762b2.

commit 1da5ee3b9b01eab30c8a128a79ac46fe46533925
Author: Charles Oliver Nutter <headius@headius.com>
Date:   Thu Oct 18 14:18:10 2012 -0500

    initialize_copy is aliased to replace, but needs to be private.

commit c6013c59228b377aa9f8fb0626340fa7831af667
Author: Charles Oliver Nutter <headius@headius.com>
Date:   Wed Oct 17 10:59:42 2012 -0500

    Move Java-sourced dynamic call logic to MethodNames enum.

commit 63a941347a28ff6b87d563610d0d4fa887e78587
Author: Charles Oliver Nutter <headius@headius.com>
Date:   Wed Oct 17 10:25:15 2012 -0500

    Hash#initialize_copy is an alias for #replace in MRI.

commit b8181cda909f6e42d7c0b7fffaabbe2a502f273b
Author: Charles Oliver Nutter <headius@headius.com>
Date:   Fri Jul 27 02:19:54 2012 -0500

    Inline all calls to ThreadContext.getRuntime to access the field.

commit 47fd4acb720385b7d7852e1876e28520aa0cf484
Author: Charles Oliver Nutter <headius@headius.com>
Date:   Fri Jul 27 01:55:07 2012 -0500

    Remove all safelevel checks throughout JRuby (plus misc cleanup).

commit 5b3b783e954aec5c223e42edf191149b619a0f48
Author: Charles Oliver Nutter <headius@headius.com>
Date:   Sun Feb 26 17:59:35 2012 -0600

    Update Rubicon tests for 1.9 mode and set up test:rubicon19 target.

commit a1aabe707882e2615d07a95aa9c1ce6a8d3cf344
Author: Charles Oliver Nutter <headius@headius.com>
Date:   Thu Dec 15 17:22:29 2011 -0600

    Fix JRUBY-6272: Encoding exception running JRuby 1.6.5 (1.8 mode)
    
    Don't use cat19 for Hash#inspect in 1.8 mode.

commit 467c518a5cdaa19e0a2282e90598389a31d70ec3
Author: Hiro Asari <asari.ruby@gmail.com>
Date:   Sun Nov 20 12:42:00 2011 -0600

    In 1.9, Hash#merge! checks frozen-ness earlier than checking the argument's emptiness.

commit 719ad8835f69251ba7ee894cfcae929a49c1f0d7
Author: Hiroshi Nakamura <nahi@ruby-lang.org>
Date:   Mon Nov 14 23:19:42 2011 +0900

    JRUBY-6209: Hash#rehash did not work under some condition
    
    It breaks hash because of wrong key hash recalculation.  It should call
    RubyHash#hashValue() because the actual hash could be changed by
    MRIHashValue() called from hashValue().

commit 5512c59a734fe09485ece988f3425450dbaebf92
Author: Charles Oliver Nutter <headius@headius.com>
Date:   Tue Sep 20 01:55:08 2011 -0500

    Encoding fixes for JRUBY-6033:
    
    * String#% was not setting base encoding of new string to same as format string, as in MRI
    * Array#to_s and Array#inspect did not use encoding-aware methods for building the string
    * Hash#inspect ditto

commit fbc85d9466d8b5fc5482cf168828def9a8e0356f
Author: Charles Oliver Nutter <headius@headius.com>
Date:   Mon Jun 27 15:27:15 2011 -0500

    Fix JRUBY-5883: Hash Subclass#== not respected when checking equality of collections.
    
    * Make the Set used for recursion detection into a thread-local
    * Use actual dyncall for elements rather than short-circuited Hash/Array logic

commit dd0ede8696d8b684baacb15f5904279aff6debec
Author: Charles Oliver Nutter <headius@headius.com>
Date:   Sat Apr 2 12:20:27 2011 -0500

    Replace most slow core-to-core calls to ==, hash, and <=> with lighter-weight global cache hits.

commit b7b14406e2e40707326cf06d48e23fcbf6a90b8c
Author: David Calavera <david.calavera@gmail.com>
Date:   Mon Jan 31 20:16:24 2011 +0100

    fix JRUBY-5430: RubyHash view objects should be static. Thanks to Chris K. Jester-Young

commit a1910bef31cb94368d0cf427444f331bb331eaba
Author: David Calavera <david.calavera@gmail.com>
Date:   Thu Jan 20 19:04:05 2011 +0100

    fix Hash::[] odd arguments error message

commit 61aca7697ce544ef03577bac7084feca359a5aa7
Author: Yoko Harada <yokolet@gmail.com>
Date:   Wed Jan 5 14:24:01 2011 -0500

    starting attempt to add all Ruby Hash methods to java.util.Map type object.

commit 3d95a53902e7600ef1ff474ee535034c6b4a9b1d
Author: Charles Oliver Nutter <headius@headius.com>
Date:   Tue Jan 4 05:10:37 2011 -0600

    Fix for JRUBY-5302: [1.9] Rails Object#to_param appears to lose values for a Hash
    
    * Ruby 1.9 defines Hash#each to basically do each_pair logic.

commit fd0fa789b21b30f294e8286b72b75fe3b688c27a
Author: Charles Oliver Nutter <headius@headius.com>
Date:   Wed Dec 1 12:07:42 2010 -0600

    Merge "backtrace" branch to master, now that it runs clean on all our various test cases.
    
    This is a squashed merge encompassing the following commits from "backtrace":
    
    commit eb0e24242050199ac1cc4cf6e48d93025f0186f4
    Merge: 32137de ea48d8d
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Wed Dec 1 12:03:28 2010 -0600
    
        Merge remote branch 'origin/master' into backtrace
    
    commit 32137decc9351dd7b6a19c49c7955808f535bb9c
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Wed Dec 1 09:41:29 2010 -0600
    
        Fix remaining failures for test-all.
    
        * Disable CheckClassAdapter temporarily, since it disallows what should be valid JVM identifiers.
        * Use the presence of $RUBY$ in method name as an additional indicator that we're processing a compiled Ruby body during backtrace gathering.
        * Move some largely-static properties out of "init" target in build.xml, so they're available whether init is triggered or not (e.g. run.jvm.model).
    
    commit ee2a624201d5e9cd408d6ae793160aeb99b50b3d
    Merge: cd50ae5 88ad204
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Wed Dec 1 08:01:22 2010 -0600
    
        Merge branch 'master' into backtrace
    
    commit cd50ae5f06b95a2fffab6bc1f3a7419f478d0a52
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Tue Nov 30 19:15:07 2010 -0600
    
        Get remaining spec failure with -X+C passing.
    
        * Embed the actual Ruby method name into the Java method for block bodies, rather than __block__.
    
    commit 52bbfffcae1aed62bf4afcb692bed9725e4e1564
    Merge: 4ed7235 1aace5e
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Tue Nov 30 01:37:15 2010 -0600
    
        Merge branch 'master' into backtrace
    
    commit 4ed723579101fffd8bfa73b30dc6e4e8991866f2
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Tue Nov 30 01:31:44 2010 -0600
    
        Precompiled (AOT) specs *nearly* green.
    
        * Mark __method__ as reading frame "name"
        * Fix AOT-based stack trace mining logic
    
    commit 64e20aa939b5b9c6e41e0e9fe09039a0bb92794a
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Mon Nov 29 16:50:55 2010 -0600
    
        Jitted specs running green.
    
        * eval needs to set method name into the binding, so it's there for "__method__" in the eval'ed code.
    
    commit fd442c0a815bcab9eb6c9aa1b71e1f8a260ee03b
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Mon Nov 29 16:06:53 2010 -0600
    
        Interpreted specs green on backtrace.
    
        * Tagged some __method__ specs for which backtrace behaves like 1.9, which Matz apparently likes but was afraid to backport. Odd cases anyway.
        * Fixed method name for the block used to define_method.
    
    commit cedb27e430b422c1158f66b4dcc7769922433506
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Wed Nov 24 18:35:22 2010 -0600
    
        Reinstate deprecated java_to_ruby and ruby_to_java I removed, since it's still needed by some external libs.
    
    commit b48b17910de662b4e2d20ee8f4b5cc734eefc1ed
    Merge: f39007e 2ae4995
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Wed Nov 24 13:40:58 2010 -0600
    
        Merge remote branch 'origin/master' into backtrace
    
        Conflicts:
        	src/org/jruby/Ruby.java
        	src/org/jruby/RubySymbol.java
        	src/org/jruby/runtime/CompiledBlock19.java
        	src/org/jruby/runtime/Interpreted19Block.java
        	src/org/jruby/runtime/InterpretedBlock.java
        	src/org/jruby/runtime/MethodBlock.java
    
    commit f39007eca676c1e6ec9f891ac63b7c5d907b0d1b
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Thu Nov 18 14:01:29 2010 -0600
    
        Start normalizing the method/class names generated into Java by JIT and AOT compiler, to wrap up the remaining spec failures.
    
    commit 76e42c4b4522dc87c066d20051d02d1e4005b860
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Wed Nov 17 20:40:33 2010 -0600
    
        Disable dynopt for now, to allow better stabilization on the main feature of this branch: frame elimination.
    
    commit d03099690df2e16d423e8b6a8969e0264983237f
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Wed Nov 17 15:00:14 2010 -0600
    
        Encapsulate "coreMethods" hash in Ruby and add "bound method" logic to default (non-generated) class populator. `ant test-all` runs green now.
    
    commit ed7458f72bce55b11e5231f8e7b9d590c09ca53d
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Wed Nov 17 10:46:43 2010 -0600
    
        Fix incorrect use of fastSetInstanceVariable instead of fastSetInternalVariable in FFI.
    
    commit f09626121b6a8bea6ab39a3c8ed3ccd69f56b505
    Merge: f780b97 e8ca689
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Wed Nov 17 10:15:16 2010 -0600
    
        Merge branch 'master' into backtrace
    
    commit f780b972b1f3e18f4c2608d9536e797a0845cd1a
    Merge: 25ab5d3 6967ea7
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Wed Nov 17 09:04:42 2010 -0600
    
        Merge branch 'master' into backtrace
    
        Conflicts:
        	src/org/jruby/runtime/ThreadContext.java
    
    commit 25ab5d3d3f8c1fbf0fa334427b1485d322e83f86
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Sun Nov 7 00:42:54 2010 -0500
    
        Don't do dynopt against calls that receive blocks; non-local flow is not properly handled yet.
    
    commit a4ad27056dcc3acf6bae0b0af7e618966d08a6dd
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Sat Nov 6 15:22:40 2010 -0500
    
        Tag caller specs that do not pass with new backtrace logic (peculiar eval caller behaviors).
    
    commit eed8902084cfa06d4648935c1f70da57bf0c7a9c
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Sat Nov 6 00:32:59 2010 -0500
    
        More fixes to get specs and tests green on backtrace branch:
    
        * Hash#index was not being bound properly from RubyHash#index19
        * Range#min and Range#max need super, and therefore need frame = true
        * tc_owned is a bad test and fails on system like OS X where (for some reason) / may be owned by user
        * test_trace_func had been hacked for a bad class result (Integer, instead of Fixnum)...fixed that
    
    commit 9d9f94c30de76fa25e738e70e84ea09163eca5cb
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Fri Nov 5 20:03:22 2010 -0500
    
        Fix Kernel#caller to replace .java lines with Ruby lines. Brings specs mostly to passing.
    
    commit de433c771830e95c54f8196453208f2b312191aa
    Merge: 3ffe1cf e25c58f
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Fri Nov 5 17:40:02 2010 -0500
    
        Merge branch 'master' into backtrace
    
        Conflicts:
        	src/org/jruby/RubyIO.java
        	src/org/jruby/compiler/impl/StackBasedVariableCompiler.java
        	src/org/jruby/evaluator/ASTInterpreter.java
        	src/org/jruby/java/proxies/JavaProxy.java
    
    commit 3ffe1cfba86f52ee96d89f3a1c352597f22f76b7
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Wed Oct 27 01:42:06 2010 -0200
    
        Fix compile error I accidentally merged.
    
    commit b081253fb3cdf5141f7f0cf76d3f8546837d9f42
    Merge: fc3028d ad68e22
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Tue Oct 26 16:30:25 2010 -0200
    
        Merge branch 'master' into backtrace
    
        Conflicts:
        	src/org/jruby/Ruby.java
        	src/org/jruby/internal/runtime/methods/DefaultMethod.java
        	src/org/jruby/runtime/ThreadContext.java
    
    commit fc3028d9da2750c9d1c394600ab8ee712388724d
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Tue Oct 26 14:39:29 2010 -0200
    
        Add better description for class bodies in backtrace
    
    commit d796555494c2237116c7477c932fd96cd30d2e20
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Tue Oct 26 11:36:29 2010 -0200
    
        Clean up and add color to Rubinius backtraces.
    
    commit 012f5357ce649bd5a996211fe231f26097bf4f5b
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Sun Oct 24 16:23:04 2010 -0500
    
        Fix classloader check to allow for compiled method handles, which use a no-arg constructor.
    
    commit 473d48aac6a5523304188d1d433e4c12df989b89
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Sun Oct 24 16:10:32 2010 -0500
    
        Improve Proc-binding-based eval position info by propagating block's position into the binding and through to the backtrace frame.
    
    commit bcfd16b519b145c9ee055db1592dfaced05b71a0
    Merge: 4902faa 5b49583
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Sun Oct 24 11:07:15 2010 -0500
    
        Merge branch 'master' into backtrace
    
        Conflicts:
        	src/org/jruby/RubyTime.java
        	src/org/jruby/runtime/ThreadContext.java
        	test/org/jruby/test/TestRubyException.java
    
    commit 4902faaf1678d5aecdef8b0b66f8ec78062aeec5
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Thu Oct 21 09:28:45 2010 -0500
    
        Fix badly-merged RubyProc.to_s19, missing opening brace.
    
    commit 69177d7098f9dc4ff9096d08eee25c0d8bb4f971
    Merge: 801e764 f895837
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Wed Oct 20 21:50:53 2010 -0500
    
        Merge branch 'master' into backtrace
    
    commit 801e7641b8838a8ae8931a9c6dcc5cf050096c4a
    Merge: 0c60a89 dda4644
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Tue Oct 19 23:16:41 2010 -0500
    
        Merge branch 'master' into backtrace
    
        Conflicts:
        	src/org/jruby/RubyDigest.java
        	src/org/jruby/RubyProc.java
    
    commit 0c60a89aa746f286588b218681e9ad25b11318c4
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Tue Oct 19 23:06:15 2010 -0500
    
        Only compile direct recursive calls when we haven't branched to another method body (e.g. for rescues) and we're not compiling a closure or class body.
    
    commit 18333fe82c808e8ed49eef898f19c86fa2d764b2
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Tue Oct 12 17:04:13 2010 -0500
    
        Get 1.8 specs running green except for a handful of Kernel#caller specs (which don't expect to see .java files in the trace...not sure how to deal with that).
    
        * Fix another literal-block-calling path that wasn't using callIter
    
    commit 366740120ee76d8df3f977edc1727b60b2d4ad63
    Merge: b64390b 6b243a3
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Tue Oct 12 10:35:14 2010 -0500
    
        Merge remote branch 'origin/master' into backtrace
    
    commit b64390b8cf0d2cb13e06d352969a093b5e86818d
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Tue Oct 12 10:33:39 2010 -0500
    
        Remaining fixes to get precompiled mode passing all our tests. Still some spec failures.
    
        * Bump up permgen max for test runs
        * Fix stack-based scope initialization to not leave an unused nil on stack
        * Ensure compiled method handles properly wrap pre/post logic for dummy and backtrace frames.
    
    commit 96bd3cbde91fc505b37ee13cbea6ffa3e8690c58
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Mon Oct 11 18:36:34 2010 -0500
    
        First fixes for backtrace branch in precompiled mode:
    
        * Add test-precompiled build target for running just precompiled
        * Eliminate extraneous toplevel scope being pushed for precompiled loads (because that logic is all in the generated "load" method now.
        * Add a new scope descriptor decoding path that properly sets up a toplevel scope
    
    commit 0ebbd6ac46c9ac04558f5200f980f26f798b9413
    Merge: fc387be ac455fc
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Wed Oct 6 21:53:18 2010 -0500
    
        Merge branch 'master' into backtrace
    
        Conflicts:
        	src/org/jruby/RubyIO.java
    
    commit fc387befff57ada6c116b646a3dfb767cc926ee5
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Tue Sep 28 15:57:58 2010 -0500
    
        Renumber arguments for consistency.
    
    commit bbc91d3c4039bf6c26ceffd4899dcaaeaa3d46d0
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Tue Sep 28 15:40:38 2010 -0500
    
        Fixes to get specs a bit closer to running green.
    
        * Move pre/post logic for Script.load into generated code, so it's the same everywhere.
        * Make pre/post-load push a frame, so top-level of a script is always framed
        * Remove break handling from non-literal block call paths in CachingCallSite
        * Make sure all literal block calls are using CallSite.callIter, which handles break
        * Fix a bad test in testCompiler that needed visibility tweaks and framing
        * Add complete doco for CallSite
        * Fix Kernel#caller to trim from top of stack instead of bottom
    
    commit 4e814a24d5b2ef1b6567a3076a463ff9d08e2a0d
    Merge: 91dc13a 3dbcef3
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Mon Sep 27 17:43:30 2010 -0500
    
        Merge branch 'master' into backtrace
    
    commit 91dc13a2f0b74bc1054d83378782416465ecc1b8
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Mon Sep 27 01:02:48 2010 -0500
    
        Fixes to get test-compiled (but not precompiled) passing 100%.
    
        * Fix eqlInternal's RubyNumeric branch check if classes are equal
        * Provide file and line from all BlockBodies, so Proc#to_s can always use it
        * Fix rejiggered Struct#each and Struct#each_pair to call the appropriate internal version
        * Fix ruby_test's IO.new suite to not use STDOUT directly, risking that it get closed
    
    commit dc4af45352607ebb8a95d70befdcdb15c1111c58
    Merge: ec8bb7f 90275be
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Tue Sep 21 09:52:10 2010 -0700
    
        Merge branch 'master' into backtrace
    
        Conflicts:
        	src/org/jruby/Ruby.java
        	src/org/jruby/RubyDir.java
        	src/org/jruby/RubyKernel.java
        	src/org/jruby/compiler/ASTInspector.java
        	src/org/jruby/javasupport/util/RuntimeHelpers.java
    
    commit ec8bb7fc31d4acd4ebcb040f088e19fb427448e8
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Sun Sep 19 16:21:38 2010 -0700
    
        Remove frame = true from all core class methods, to reduce their call costs. A few remain for invokeSuper and methods that may still need frames.
    
    commit ec276b6ca0c6009702839b12d97664b9e52b1023
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Thu Sep 16 14:10:43 2010 -0500
    
        Eliminate RubyTuple use that snuck in.
    
    commit f80254100cfc17ac6eb558e465fc1fb9122c3ee4
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Tue Sep 14 10:07:53 2010 -0500
    
        Special case a few immutable core types in equalInternal/eqlInternal.
    
    commit eb66c45145e4fd1f8c28e9a8c544114f034116e8
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Sun Sep 12 18:26:13 2010 -0300
    
        Performance changes for backtrace logic:
    
        * Back off using Java stack trace for Proc's to_s file+line, since it's prohibitively expensive
        * Move the Backtrace stack to being a fixed-size array of objects updated, rather than created, when a push happens
    
    commit 6f0ade5ab28946b8800431d3454d2e57fc0dbe19
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Sun Sep 12 11:36:07 2010 -0300
    
        Add generation guard around trivially-inlined logic.
    
    commit c4d8705217174580d35757dc85c5c646e980b57f
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Sun Sep 12 06:18:38 2010 -0300
    
        Full speed ahead with a caching mechanism for calls from core classes. Only works for core class methods right now, but opens the door to expanding that.
    
    commit 5874abc01104f6c0f435f8ac4643ed0f77cf7cff
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Sun Sep 12 03:43:37 2010 -0300
    
        Localize some fields used in Array#include? to speed up the loop.
    
    commit 346245cd5e154574d14736cf4b9e0b4b98260d14
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Sat Sep 11 15:02:41 2010 -0300
    
        Allow passing a number of iterations to bench_quicksort.rb.
    
    commit b4687022a1f00d0b63838b1c9daf00753fcfa93e
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Sat Sep 11 11:55:15 2010 -0300
    
        Fixes to get run-junit-compiled 100% passing on backtrace branch.
    
        * Fixed a couple tests that are too sensitive to core method line numbers or expected only .rb elements in the trace
        * Added a mechanism for procs to retrieve the most recent Ruby frame, for to_s purposes
        * Added comments for hybrid backtrace logic
    
    commit 15cd9b16cb2750d0e40ba478d07fe5bf265dc620
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Sat Sep 11 08:07:57 2010 -0300
    
        Add better logging to AnnotationBinder (for showing framed/scoped core methods), ASTInspector (for showing methods detected as framed/scoped and for reporting deopt flags as they are set), and JITCompiler (for dumping jitted methods' full classes and inspector results). New property jruby.jit.dumping=(true|FALSE).
    
    commit c4e6176498590d791868055025c2e72ded1ccf13
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Fri Sep 10 02:10:20 2010 -0400
    
        Improve dumping of generated bytecode by including class and method name when possible.
    
    commit 07fc4215f6873f449f89d4f5da7a7e2e8963bc70
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Thu Sep 9 23:39:20 2010 -0400
    
        Make attr accessor's var accessor field volatile, to guarantee visibility across threads.
    
    commit e3a7cf5cd4d8ccd08407955779bdd94feb5e4ac8
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Wed Sep 8 13:26:48 2010 -0500
    
        Add missing "in" to caller backtrace lines.
    
    commit 7140c339f386959853f747d86cb2ea9a8afa6f2a
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Wed Sep 8 12:10:50 2010 -0500
    
        Fixes to get tracing tests running in interpreted mode:
    
        * Off-by-one line numbers were off for MRI too. Fixed to correct line numbers
        * call and return for Ruby methods need to use impl class, not self class
    
    commit cbc9c4edab56807a023817d06db9c22441fa4b53
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Wed Sep 8 10:31:57 2010 -0500
    
        Fix runInterpreterBody to properly unwrap RootNode for "gets loop" execution.
    
    commit 3a09773058d8d58d5bf8f1b6fbebc494fc18f7c6
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Wed Sep 8 10:01:43 2010 -0500
    
        Make --bytecode attempt a recompile, so that dynopt and no-compile modes can still print bytecode.
    
    commit 4e48e722ba5ded10975af348738237fcb7fe9b2a
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Wed Sep 8 09:23:38 2010 -0500
    
        Add a "full" backtrace style which does not omit any Java frames and interlaces the Ruby frames.
    
    commit 6f5057e3ae1e372bd66602dcc26864adc3270128
    Merge: 7006d31 811fd8d
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Wed Sep 8 07:48:47 2010 -0500
    
        Merge branch 'master' into backtrace
    
        Conflicts:
        	src/org/jruby/Ruby.java
    
    commit 7006d3175bbf4630921dfecaa4faef2a39a77205
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Sat Sep 4 16:04:28 2010 -0500
    
        Bytecode size reductions for stack-based nil-initialization of locals and for x, *y and x, * forms of masgn.
    
    commit 3a8fb16f020c2b9aaa6228605bdb3d8fd1b78ccf
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Sat Sep 4 14:52:04 2010 -0500
    
        Do not do direct recursive invocations for heap-based scopes, since the scope is not currently being reset.
    
    commit ec00e99636667eff97a891917ae9ef37f94a6eb7
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Fri Sep 3 19:55:24 2010 -0500
    
        Turn on dynopt by default, to aid testing of new logic.
    
    commit 9508e8a6925fce4f57a386ede867b3f8f9b67d38
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Thu Sep 2 12:40:38 2010 -0500
    
        Fix Time test that expected two separate Time.now objects to to_s the same.
    
    commit 65ba8b37a8a232495453e71b2a560c761b40893f
    Author: Nick Sieger <nick@nicksieger.com>
    Date:   Mon Aug 30 14:50:03 2010 -0500
    
        Use new backtrace info to set a more useful Java thread name
    
    commit 75b100604af39de52b26bdb21669136234424a0b
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Mon Aug 30 11:37:49 2010 +0900
    
        Fix ifne/ifeq bug in dynopt guard and switch DefaultMethod to not flip generations on JIT in dynopt mode.
    
    commit fe3b408629e94b7db0436152968bd6d2232f6c7c
    Merge: eea60da 85c64c6
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Sun Aug 29 20:33:06 2010 +0900
    
        Merge branch 'master' into backtrace
    
    commit eea60da3905c87c16fbb4e6c78fd7a07f842e4bd
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Fri Aug 27 14:09:44 2010 +0900
    
        Modify Java Fixnum fib bench to use the long call paths where possible, to be more like what compiled Ruby does not.
    
    commit a189563d9073208292e91aff3eb1c88489bd113d
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Wed Aug 25 15:07:21 2010 +0900
    
        Fixes for jitted/compiled backtrace generation
    
        * SClass in a method body needs to frame, so it has a jump target for non-local return
        * Compiled methods need to always have their ruby name in the method name, so it can be mined out appropriately
        * Synthetic calls, like to rescue bodies, need to gobble caller frames to avoid multiple entries
    
    commit 276226de611cb8d5af942148109c2a51982e7640
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Wed Aug 25 14:03:44 2010 +0900
    
        Add callNumber tracking to method handles, to properly handle return jumps.
    
    commit b94bcf119a54f52ab9be3c86bc5cc85078f20eee
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Wed Aug 25 13:16:25 2010 +0900
    
        More fixes for hybrid backtrace:
    
        * Get generated trace to be RaiseException's Java trace
        * Add Ruby exception name to the RaiseException message
        * Rewire and repair trace calls
    
        All main suite tests now pass in interpreted mode.
    
    commit dc9fcd3de0f3070507ac0a0647973d1e9f16ae4f
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Mon Aug 23 14:38:47 2010 -0500
    
        Fix debug logging of exceptions being raised and patch a couple tests for new backtrace structure.
    
    commit 3acd3201d85e4da9186fa17d3a04bdc9db742e29
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Mon Aug 23 13:23:04 2010 -0500
    
        Include original source file in compiled Ruby, add missing "in" line for MRI rendering, and soften requirements in test_backtraces to allow for native elements in the backtrace.
    
    commit 728cf3983fbeffba944fe34a8b0e410cc1de041c
    Merge: 88a64de 0e9c956
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Mon Aug 23 00:18:07 2010 -0500
    
        Merge branch 'master' into backtrace
    
    commit 88a64de879446be3398ba7671b5fa1f3e46ce02f
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Sun Aug 22 17:29:21 2010 -0500
    
        Turn on "positionless" compilation, since compiled code no longer needs to update interpreter backtrace frames. Also fix nil/null backtrace rendering.
    
    commit 5712a4ce285a5b3662c8ef8def2599223a232626
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Sun Aug 22 17:18:17 2010 -0500
    
        Fix off-by-one line numbers from interpreter frames.
    
    commit 519f4625b9d9658f50b986b1add560903ee453de
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Sun Aug 22 17:10:47 2010 -0500
    
        Remove some old backtrace code no longer in use and get all "backtrace" method handles to generate with no frame at all (since Java stack is used now).
    
    commit 424d967df8a3b6ba277bdb1b530d4f7f62ecbc4a
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Sun Aug 22 16:52:29 2010 -0500
    
        Get Kernel#caller working with hybrid traces, get Rubinius rendering working again (partially), separate gathering and rendering of backtraces.
    
    commit a00822740712ddd924896feccc10f015fd20d4be
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Sun Aug 22 15:32:08 2010 -0500
    
        Mine method names out of AOT and JIT compiled stacktrace elements and get JIT using the original name of the method.
    
    commit 039d184ac5f798aed21870a7552b66c5973ca0eb
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Sat Aug 14 22:16:48 2010 -0500
    
        Simplify in-class encoding of StaticScope data.
    
    commit 876a762b8af88955bee598dfd0421805d9b47c40
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Sun Aug 22 01:41:44 2010 -0500
    
        Fixes to hybrid traces to get tests working better:
    
        * Omit Kernel#raise and the KernelJavaAddons rbRaise from traces
        * Handle getBacktrace when there's been no preparation
    
        Also modified test/testException.rb to allow internal line numbers for the "load" call, rather than MRI standard "whatever line it was called from".
    
    commit 06f1bd171d6897f651b3cebfd76551080acbfe40
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Sun Aug 22 00:39:59 2010 -0500
    
        Move backtrace management to a separate stack and implement mixed-mode backtrace generation.
    
    commit ca40e73a7c136dfdd3853f0cd62a73bf70a3a08f
    Author: Charles Oliver Nutter <headius@headius.com>
    Date:   Sat Aug 21 20:56:50 2010 -0500
    
        Get all major interpreter entry-points passing through simple, known method bodies. First step toward mixed-mode backtraces.

commit a26fe86b3b826e581cf81cabc1016f6e8189548a
Author: Charles Oliver Nutter <headius@headius.com>
Date:   Fri Oct 22 16:41:53 2010 -0500

    Fix for JRUBY-5063: Comparison of objects of a class using DelegateClass do not compare as expected
    
    We weren't doing the respond_to?("to_hash") equality check flip.

commit e055dbe2e6a793916c7a8383d5a6f6aa0d1e6e7f
Author: Hiro Asari <asari.ruby@gmail.com>
Date:   Thu Oct 14 15:51:53 2010 -0400

    Formatting change. Avoid dangling 'if' clause on a line by itself. Also, reformat multi-line boolean conditions so that it is clearer that they indeed span multiple lines.

commit d3855728c4f015bf0b97d4d1e73c94cbac7ad09e
Author: Charles Oliver Nutter <headius@headius.com>
Date:   Sun May 23 14:04:17 2010 -0500

    Fix remaining 1.9 Hash specs.

commit 9b1f32c2ad5ef8aa7c81d470dd855b49d601d4bc
Author: Charles Oliver Nutter <headius@headius.com>
Date:   Thu Mar 25 20:05:47 2010 -0500

    Minor perf improvements to marshalling and simplification of lazily-initialized collections in RubyModule.

commit 83b1502eed5f738ef5838db9c3201c3ea114aaf9
Author: Ola Bini <ola.bini@gmail.com>
Date:   Tue Jan 12 14:53:46 2010 +0100

    [1.9] Make Hash#hash and Array#hash fully recursive safe

commit 59be74561ff86eea5fc98ddfefefe9c38b7a3a5c
Author: Ola Bini <ola.bini@gmail.com>
Date:   Mon Jan 11 14:29:53 2010 +0100

    [1.9] Fix several Hash failures

commit a930f3f6f4f37f773affd68608bd6fd7f90e2428
Author: Ola Bini <ola.bini@gmail.com>
Date:   Mon Jan 11 14:15:20 2010 +0100

    [1.9] Add Hash#default_proc=

commit 13c40aeb515d14e62db6cb469a560d900a27647e
Author: Charles Oliver Nutter <headius@headius.com>
Date:   Wed Dec 16 00:59:55 2009 -0600

    Set reified class for all the primary core classes, so they'll work properly when extended and an interface gets included.

commit 7497017d0098fb909c9d6459ea8bff180ed502f8
Author: Charles Oliver Nutter <headius@headius.com>
Date:   Thu Nov 5 18:50:45 2009 -0800

    * Update some templates where the .java version got edits instead
    * Fix some newArray with NULL_ARRAY to call newEmptyArray
    * Add separate paths for "array" and "nonarray" in block dispatch, to eliminate the avalue bool

commit 3cd2e9d3d714cceab46460b33c12c41a512644fe
Author: Thomas E. Enebo <tom.enebo@gmail.com>
Date:   Tue Oct 13 15:37:44 2009 -0500

    JRUBY-4029: String hash keys should be copied

commit fac5cf0f6f2aa5fcf9bf89d6a281fd940721ed7b
Author: Charles Oliver Nutter <headius@headius.com>
Date:   Sat Oct 10 16:55:24 2009 -0500

    Fix for JRUBY-4079: rcov fails with NullPointerException with JRuby 1.4.0RC1. Has worked with all JRuby versions since 2008.

commit bf2a7cb59a18bab9d41c1a0f1ee74c9162822178
Author: David Calavera <david.calavera@gmail.com>
Date:   Wed Sep 30 13:55:27 2009 +0200

    JRUBY-4021: fixes Hash.compare_by_identity NoMethodError
    
    Signed-off-by: Vladimir Sizikov <vsizikov@gmail.com>

commit 9e8ccd5bba34a225258a97172fa3be987c8e1ca8
Author: Vladimir Sizikov <vsizikov@gmail.com>
Date:   Sat Sep 26 22:17:51 2009 +0200

    JRUBY-4003: NegativeArraySizeException in RubyHash.keys

commit be1ce02e443cb0fcca88079595ea08c5ca6bb515
Author: Charles Oliver Nutter <headius@headius.com>
Date:   Tue Sep 22 12:27:32 2009 -0500

    More consistency fixes for JI coercion:
    * Move more places to calling toJava
    * Move code away from calling convertRubyToJava, the old clunky coercion path
    
    Two behavior changes are introduced by this commit:
    * When coming out of a collection (RubyArray, RubyHash) Fixnum will now coerce to the smallest java.lang.Number subtype its value can fit into. We already did this for calling methods that receive Object, but now also do it for many other cases of conversion to Object.
    * nil values can now be assigned to or passed for primitive fields or arguments; nil will coerce as "0" in the smallest Number type possible.

commit 7b201461f1b2ac65b78e9376dea1cfdd679de9f9
Author: Charles Oliver Nutter <headius@headius.com>
Date:   Sun Sep 6 15:24:00 2009 +0900

    Fixes for JRUBY-3816: Objects returned from Java library call not fully unwrapped
    
    Needs specs to be considered resolved.

commit 0146f95d1ebcb50c39e493dd7ca088efd4be4201
Author: Martin Traverso <mtraverso@acm.org>
Date:   Wed Aug 5 09:53:51 2009 -0700

    Fixed eql? & == checks on mutually recursive hashes & arrays
    
    Signed-off-by: Charles Oliver Nutter <headius@headius.com>

commit 168b32d200ad916aae0f894c4c0565ef12954da9
Author: Ola Bini <ola.bini@gmail.com>
Date:   Tue Aug 4 18:05:59 2009 +0200

    Fix JRUBY-3682 and fix some more tags

commit 32a33ac9565b77bf3fb076b378e70c31b52f28cb
Author: Ola Bini <ola.bini@gmail.com>
Date:   Tue Aug 4 17:57:14 2009 +0200

    [1.8.7] Fix JRUBY-2587

commit 2e539f16ca9ae1ae5762d727eda820246602332d
Merge: ae08daf a9c202c
Author: Ola Bini <ola.bini@gmail.com>
Date:   Tue Aug 4 17:35:54 2009 +0200

    Merge pieces for 1.8.7

commit a9c202cdb4d5d525a7f9960a7dbd02ae4c6828c8
Author: Charles Oliver Nutter <headius@headius.com>
Date:   Tue Aug 4 02:45:57 2009 -0500

    Make the new iterator state methods private.

commit 50192a0f5cd14675705af200e9abd99681254915
Author: Martin Traverso <mtraverso@acm.org>
Date:   Mon Aug 3 23:41:37 2009 -0700

    Fixed Hash#eql? spec failures
    
    Signed-off-by: Charles Oliver Nutter <headius@headius.com>

commit 919fce229fa21cc9abbdf488db294b88f1aff8e3
Author: Martin Traverso <mtraverso@acm.org>
Date:   Mon Aug 3 22:53:43 2009 -0700

    Fixed "Hash#update raises a TypeError if called on a non-empty, frozen instance"
    
    Signed-off-by: Charles Oliver Nutter <headius@headius.com>

commit 5c68a2d59a48418609ab0516bffa18907d06cb4b
Author: Martin Traverso <mtraverso@acm.org>
Date:   Mon Aug 3 18:40:44 2009 -0700

    Fixed "Hash#select returns an Array of entries for which block is true"
    
    Signed-off-by: Charles Oliver Nutter <headius@headius.com>

commit ca574e30361b2d1b2b883680a7def6aa627c9778
Author: Ola Bini <ola.bini@gmail.com>
Date:   Mon Aug 3 12:45:29 2009 +0200

    Hash#each, Hash#each_pair, Hash#each_value, Hash#each_key, Hash#select, Hash#delete_if, Hash#reject, Hash#reject!

commit cc9623c2a95333fa3dd19ae4b344e7db2594ead8
Author: Charles Oliver Nutter <headius@headius.com>
Date:   Sun Aug 2 21:25:10 2009 -0500

    Fix for JRUBY-3745: RubySpec: Hash#rehash causes a RuntimeError to be raised if called inside an iterator block
    
    This is a modified version of a patch from Gerald Boersma. Thanks!

commit 8e92cdc0bd95d0a4d7d868064df7fd8e2fd4f9a8
Author: Thomas E. Enebo <tom.enebo@gmail.com>
Date:   Thu Jun 25 16:29:34 2009 -0500

    40%+ speedup of Hash.each in interpreter because we are totally unboxed all the way through...compiler not quite yet

commit faac8736299818046e42ef20318cf57c6c464ddc
Author: Charles Oliver Nutter <headius@headius.com>
Date:   Tue May 19 14:20:19 2009 -0500

    Fix for JRUBY-3496: MRI tests: test_hash shows bug in delete_if block argument

commit a502d52b93154635101d52ce2109a91fe5815d38
Author: Charles Oliver Nutter <headius@headius.com>
Date:   Tue May 12 09:25:58 2009 -0500

    Fixes for JRUBY-3640: Minor optimizations with Map.entrySet

commit 4e2e1cecb0227ea123ffd8f53355936f85f8eeb9
Author: Wayne Meissner <wmeissner@gmail.com>
Date:   Thu Apr 2 08:09:03 2009 +0000

    Fix JRUBY-3545 by masking the hash code before using as the basis of the
    bucket index.
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@9512 961051c9-f516-0410-bf72-c9f7e237a7b7

commit ecb697c2c50beb5cb8ab6850354c35fcad3340ec
Author: Marcin Mielżyński <lopx@gazeta.pl>
Date:   Sun Feb 22 23:15:09 2009 +0000

    1.9 Hash#[]=
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@9267 961051c9-f516-0410-bf72-c9f7e237a7b7

commit eba2c9089dbfe259a869b484705a48626418a868
Author: Marcin Mielżyński <lopx@gazeta.pl>
Date:   Thu Feb 19 02:03:56 2009 +0000

    Array#sort should never do ThreadContext lookup.
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@9240 961051c9-f516-0410-bf72-c9f7e237a7b7

commit 1110d09a08814fdae116b829e999bdf90621640a
Author: Charles Oliver Nutter <headius@headius.com>
Date:   Thu Jan 29 21:42:29 2009 +0000

    A bit of cleanup refactoring for block yield paths, in preparation for arity splitting.
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@8940 961051c9-f516-0410-bf72-c9f7e237a7b7

commit 79b617effab802595db9c6f790bd369380748fda
Author: Charles Oliver Nutter <headius@headius.com>
Date:   Fri Jan 9 17:56:16 2009 +0000

    Minor optz for literal hash, to use specific-arity construction always and eliminate duping.
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@8664 961051c9-f516-0410-bf72-c9f7e237a7b7

commit 413e174024c7b030ee8a5c8202554b5d2cc2576d
Author: Thomas Enebo <tom.enebo@gmail.com>
Date:   Fri Dec 19 18:26:16 2008 +0000

    Make nb happier (warning removal)
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@8407 961051c9-f516-0410-bf72-c9f7e237a7b7

commit 10a458405cf9dbc9dbab31feaaf34743037f7cb7
Author: Marcin Mielżyński <lopx@gazeta.pl>
Date:   Sun Nov 23 19:40:30 2008 +0000

    1.9 Hash.try_convert.
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@8110 961051c9-f516-0410-bf72-c9f7e237a7b7

commit 3842de6fdbf1260d14657cd288872e60f3f08c44
Author: Marcin Mielżyński <lopx@gazeta.pl>
Date:   Sun Nov 23 15:32:31 2008 +0000

    1.9 Hash#flatten.
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@8107 961051c9-f516-0410-bf72-c9f7e237a7b7

commit b5e3841125baa5a715062e2173ea16f2947e9611
Author: Marcin Mielżyński <lopx@gazeta.pl>
Date:   Sun Nov 23 15:17:27 2008 +0000

    1.9 Hash#assoc, Hash#rassoc.
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@8106 961051c9-f516-0410-bf72-c9f7e237a7b7

commit 0d7df2119912797848b64151d2e3880644b1cb7d
Author: Marcin Mielżyński <lopx@gazeta.pl>
Date:   Sun Nov 23 14:27:30 2008 +0000

    1.9 Hash#key, Hash#index.
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@8105 961051c9-f516-0410-bf72-c9f7e237a7b7

commit 7bbedee05b951db8dfcad7c92470b4fc10c2b36e
Author: Charles Oliver Nutter <headius@headius.com>
Date:   Sun Nov 16 23:57:16 2008 +0000

    Remove all remaining references/dependencies on MethodIndex's int indicies and related fields.
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@8081 961051c9-f516-0410-bf72-c9f7e237a7b7

commit 4c874298c18e50ce464543f327fa2c4006c400c7
Author: Marcin Mielżyński <lopx@gazeta.pl>
Date:   Sat Oct 4 16:35:38 2008 +0000

    Finalize MRI hashing logic switches.
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@7828 961051c9-f516-0410-bf72-c9f7e237a7b7

commit 1ac01ebed16575d2b25dd535f364342e1fd3f927
Author: Marcin Mielżyński <lopx@gazeta.pl>
Date:   Sat Oct 4 14:23:19 2008 +0000

    1.9 Hash#hash, Hash#eql?, Hash#==.
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@7827 961051c9-f516-0410-bf72-c9f7e237a7b7

commit 737af9eb5a03d92c9e3f09267c488bad07613f77
Author: Marcin Mielżyński <lopx@gazeta.pl>
Date:   Sat Sep 20 22:53:39 2008 +0000

    1.9 Hash#to_s
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@7747 961051c9-f516-0410-bf72-c9f7e237a7b7

commit 11bbaa053b56535006c60a861911d2239d8c36d2
Author: Marcin Mielżyński <lopx@gazeta.pl>
Date:   Sat Sep 20 22:44:15 2008 +0000

    1.9 Hash#select.
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@7745 961051c9-f516-0410-bf72-c9f7e237a7b7

commit 91656dfd63e68b3ce98ddc1ec8ef463e7df6a58d
Author: Marcin Mielżyński <lopx@gazeta.pl>
Date:   Sat Sep 20 20:34:46 2008 +0000

    Enumeratorize 1.9 Hash methods.
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@7732 961051c9-f516-0410-bf72-c9f7e237a7b7

commit e275166475540e7663a5c6830e9a7bea5e564961
Author: Charles Oliver Nutter <headius@headius.com>
Date:   Sun Sep 7 22:44:43 2008 +0000

    Outlining logic showing up as "too big" to inline during logged bench_string_ops run.
    
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@7650 961051c9-f516-0410-bf72-c9f7e237a7b7

commit 16c2535acd64558d402fb75f37709dc1644cbcb8
Author: Charles Oliver Nutter <headius@headius.com>
Date:   Sun Aug 10 21:21:51 2008 +0000

    Clean up numerous cases where we box args unnecessarily by calling newer specific-arity "invoke" methods on RuntimeHelpers.
    
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@7429 961051c9-f516-0410-bf72-c9f7e237a7b7

commit 72975c6c9467ac11677b86f3886e555911e50299
Author: Thomas Enebo <tom.enebo@gmail.com>
Date:   Wed Jul 9 00:34:32 2008 +0000

    lots of RO.getRuntime removal
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@7131 961051c9-f516-0410-bf72-c9f7e237a7b7

commit 4ec23223ca174395185f60573bc3d3959a178443
Author: Vladimir Sizikov <vsizikov@gmail.com>
Date:   Wed May 28 21:54:23 2008 +0000

    1. JRUBY-2585: Hash.[] should call to_hash if only one argument is provided.
       This fixes one rubyspec failure.
    
    2. Updated to the latest rubyspecs:
     102 files changed, 961 insertions(+), 94 deletions(-)
       2.6% 1.8/core/file/constants/
       1.5% 1.8/core/
       5.6% 1.8/library/net/ftp/conditionvariable/
      65.1% 1.8/library/net/ftp/
       3.0% 1.8/library/net/
      11.3% 1.8/library/rexml/element/
      10.1% 1.8/library/rexml/text/
    
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@6854 961051c9-f516-0410-bf72-c9f7e237a7b7

commit 63c6c28452c6ff6cb1516c2a3763f989e813ee67
Author: Marcin Mielżyński <lopx@gazeta.pl>
Date:   Fri May 9 23:20:09 2008 +0000

    Proper and safe inspect semantics in most places
    Dont use StringBuffers in Array#inspect Hash#inspect and Struct#inspect
    Make Struct#inspect handle recursive references
    
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@6664 961051c9-f516-0410-bf72-c9f7e237a7b7

commit 34f07e351d2b03d52c8a148bbea9d1f542ea3cea
Author: Marcin Mielżyński <lopx@gazeta.pl>
Date:   Wed Mar 26 23:30:38 2008 +0000

    Fix class A;def to_ary;self;end;def == other;:foo;end;end assert_equal([] == A.new, true) case and change equalInternal signature so it matches eqlInternal and is easier to use.
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@6348 961051c9-f516-0410-bf72-c9f7e237a7b7

commit f8a029af815ecf044f5268707b5855b85c738db0
Author: Charles Oliver Nutter <headius@headius.com>
Date:   Thu Mar 20 22:14:18 2008 +0000

    First round of logic to pregenerate method binding code, to avoid walking methods and annotations at startup.
    
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@6298 961051c9-f516-0410-bf72-c9f7e237a7b7

commit 36f396b25b0168095d2fd514e0c515764a87c9ad
Author: Ola Bini <ola.bini@gmail.com>
Date:   Wed Mar 19 12:20:17 2008 +0000

    Remove the RDoc annotation and that format. Eventually this will be back in the form of a doclet, probably.
    
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@6290 961051c9-f516-0410-bf72-c9f7e237a7b7

commit bd5e40215bc3ab94db92836d7fd54d96aea408c2
Author: Ola Bini <ola.bini@gmail.com>
Date:   Wed Mar 19 12:19:08 2008 +0000

    More work on Annotation processing - add separate annotations for classes and modules
    
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@6286 961051c9-f516-0410-bf72-c9f7e237a7b7

commit 852d904134ad970a20497fdcc5d752dd4ae49766
Author: Thomas Enebo <tom.enebo@gmail.com>
Date:   Fri Mar 7 22:04:54 2008 +0000

    The RC3 Surprise!
    
    Allow annotation defined ruby methods to optionally specify ThreadContext as first parameter
    Convert easiest and most common methods to accept ThreadContext when method or child method can use context
    
    These changes give about 15% improvement on petstore bench and about 10% in ar-bench.  In ar-bench getCurrentContext calls go from 14 million down to 2 million.  The remaining calls largely can be removed but they were much more invasive.
    
    IRubyObject op_eqq and op_equal both not have ThreadContext consumer, but we could see no use of this in any extensions and figured it worth the trouble of converting.
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@6143 961051c9-f516-0410-bf72-c9f7e237a7b7

commit 49abad906fc1ba2132beaee60d2fbb2f3ef47b83
Author: Ola Bini <ola.bini@gmail.com>
Date:   Fri Feb 22 10:47:52 2008 +0000

    Added RDoc annotation and a sample annotation in RubyHash
    
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@6002 961051c9-f516-0410-bf72-c9f7e237a7b7

commit 2b1a005a405839ca4eb268288816294e88f20a2b
Author: Thomas Enebo <tom.enebo@gmail.com>
Date:   Sun Feb 3 18:37:14 2008 +0000

    JRUBY-2062: Add ids and convenient data to SyntaxException and IRubyWarning interface to make their life easier
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@5806 961051c9-f516-0410-bf72-c9f7e237a7b7

commit b3d416662a9b358da11a63a1900dd8a917340322
Author: Charles Oliver Nutter <headius@headius.com>
Date:   Sat Jan 12 23:24:11 2008 +0000

    Multiple cleanups:
    * Remove most Arity.checkArgumentCount calls since they're handled by generated method handles now
    * Add javadoc comments to MethodFactory impls and their public methods.
    
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@5576 961051c9-f516-0410-bf72-c9f7e237a7b7

commit 3b6e2f26bf9377754f0a4218e2ed05e84b6be729
Author: Marcin Mielżyński <lopx@gazeta.pl>
Date:   Thu Jan 10 00:20:34 2008 +0000

    Reintroduce op_eqq and eql into IRubyObject and enable shortcircuit versions of eql? method for Symbol, Fixnum and String.
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@5544 961051c9-f516-0410-bf72-c9f7e237a7b7

commit 73557bfaf6bdfb2d56aa807d136327bb20032c6a
Author: Nick Sieger <nick@nicksieger.com>
Date:   Fri Jan 4 01:20:30 2008 +0000

    JRUBY-1877: Fix unmarshalling when an object uses a custom marshal_load/dump. The object
    needs to be registered in the cache before unmarshalling its children.
    Also moved around the register methods on the marshal side (possibly unnecessary), but makes
    the code a little more symmetric and hopefully easier to match up.
    
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@5484 961051c9-f516-0410-bf72-c9f7e237a7b7

commit 576356b2e6748b87c056da336de4543fb4a19978
Author: MenTaLguY <mental@rydia.net>
Date:   Sat Dec 22 03:59:53 2007 +0000

    concurrency comments and fix RubyString field comments
    
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@5335 961051c9-f516-0410-bf72-c9f7e237a7b7

commit 144765632d2cc03a40e2f3ed8f4572eb94436596
Author: Charles Oliver Nutter <headius@headius.com>
Date:   Fri Dec 21 16:01:52 2007 +0000

    A couple minor visibility fixes for Hash specs
    
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@5326 961051c9-f516-0410-bf72-c9f7e237a7b7

commit 3eeb7820d46d2d1c9f0ebb76abe88c28d98d0c35
Author: Nick Sieger <nick@nicksieger.com>
Date:   Thu Dec 6 18:34:59 2007 +0000

    - Add require test that ensures one can load ruby scripts from a require'd jar file
    - Fix default hash arg not used in RubyHash constructor
    
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@5175 961051c9-f516-0410-bf72-c9f7e237a7b7

commit 8d25ec3e0fdd08c83e23465ff1a8a467ff35e994
Author: Marcin Mielżyński <lopx@gazeta.pl>
Date:   Sat Dec 1 23:04:29 2007 +0000

    Hash#[]= should not copy the key's ByteList.
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@5137 961051c9-f516-0410-bf72-c9f7e237a7b7

commit 60a6b38ff46ade11d11031109f9468f0f90fc4be
Author: Ola Bini <ola.bini@gmail.com>
Date:   Thu Nov 29 13:30:58 2007 +0000

    Fix for JRUBY-1605, by Vladimir Sizikov.
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@5106 961051c9-f516-0410-bf72-c9f7e237a7b7

commit 3edbffadb88141301996b2fa167febee22708fe8
Author: MenTaLguY <mental@rydia.net>
Date:   Thu Nov 22 20:51:02 2007 +0000

    comment describing design of rubyhash iteration
    
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@4990 961051c9-f516-0410-bf72-c9f7e237a7b7

commit a0e8700f9bf20f6725309b865566734990e6b7f1
Author: MenTaLguY <mental@rydia.net>
Date:   Thu Nov 22 06:30:35 2007 +0000

    RubyHash iteration rewrite, implementing Ruby 1.9 ordering
    
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@4987 961051c9-f516-0410-bf72-c9f7e237a7b7

commit 0097f930d29e59cc34d915e274ad711838a41329
Author: Charles Oliver Nutter <headius@headius.com>
Date:   Wed Nov 21 06:52:58 2007 +0000

    Removing some limited-use, unnecessary, or badly located methods from IRubyObject
    
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@4981 961051c9-f516-0410-bf72-c9f7e237a7b7

commit 39f7b507b3d3c7cf1ca98e5e11a7a0aa0732a9aa
Author: MenTaLguY <mental@rydia.net>
Date:   Tue Nov 20 02:45:54 2007 +0000

    fix indention
    
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@4970 961051c9-f516-0410-bf72-c9f7e237a7b7

commit 0fac194cc255be563f824658f9a00d4da79c7a21
Author: MenTaLguY <mental@rydia.net>
Date:   Sun Nov 11 22:06:06 2007 +0000

    constrain visibilty of RubyHash.RubyHashIterator.nextEntry
    
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@4920 961051c9-f516-0410-bf72-c9f7e237a7b7

commit ee5c7ee94193800d4e36d9c06f19f2bb32d62852
Author: MenTaLguY <mental@rydia.net>
Date:   Sun Nov 11 21:03:15 2007 +0000

    YAGNI RubyHash.forEach
    
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@4916 961051c9-f516-0410-bf72-c9f7e237a7b7

commit b2461cdd7ee30f6fc8d633921cf5394937fd90fb
Author: MenTaLguY <mental@rydia.net>
Date:   Sat Nov 10 20:29:53 2007 +0000

    make RubyHash.Callback private
    
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@4905 961051c9-f516-0410-bf72-c9f7e237a7b7

commit 28bac89643e0fcdcf5dd2ac91a3a3fdfadd3bd48
Author: MenTaLguY <mental@rydia.net>
Date:   Wed Nov 7 22:25:09 2007 +0000

    add copyright header
    
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@4889 961051c9-f516-0410-bf72-c9f7e237a7b7

commit 6f202efc48da4133c076c7db4c10f12a71250b58
Author: MenTaLguY <mental@rydia.net>
Date:   Wed Nov 7 22:19:28 2007 +0000

    small refactoring of RubyHash.op_aset
    
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@4888 961051c9-f516-0410-bf72-c9f7e237a7b7

commit d90d96713b61b44f9a715d2fb31e154a93eb4988
Author: MenTaLguY <mental@rydia.net>
Date:   Wed Nov 7 22:08:51 2007 +0000

    Refactor hash deletion
    
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@4887 961051c9-f516-0410-bf72-c9f7e237a7b7

commit 11b49326d43105575e4614a8afc2112b07c01a9a
Author: MenTaLguY <mental@rydia.net>
Date:   Wed Nov 7 04:18:14 2007 +0000

    reduce duplication for internalPut
    
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@4878 961051c9-f516-0410-bf72-c9f7e237a7b7

commit 5060840af9b13cf81c5fb34e429b40e94402ce4f
Author: MenTaLguY <mental@rydia.net>
Date:   Wed Nov 7 04:02:26 2007 +0000

    more whitespace fixing
    
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@4877 961051c9-f516-0410-bf72-c9f7e237a7b7

commit a17dae2a1e2aceff3b9ac334cac063ab03a8ed0a
Author: MenTaLguY <mental@rydia.net>
Date:   Wed Nov 7 03:51:04 2007 +0000

    eliminate code duplication using a null object for lookups
    
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@4876 961051c9-f516-0410-bf72-c9f7e237a7b7

commit 282dcd7dd82cc522526ef4e4d4dd8e1142cdfa79
Author: MenTaLguY <mental@rydia.net>
Date:   Wed Nov 7 03:14:07 2007 +0000

    whitespace cleanups
    
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@4872 961051c9-f516-0410-bf72-c9f7e237a7b7

commit 7d415a0584afbfe58195d65f7e4eebdec12ac8d8
Author: Marcin Mielżyński <lopx@gazeta.pl>
Date:   Sat Nov 3 23:12:47 2007 +0000

    One more reuse.
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@4851 961051c9-f516-0410-bf72-c9f7e237a7b7

commit d4237928ed2485b52c3e28083bc4573b21940119
Author: Marcin Mielżyński <lopx@gazeta.pl>
Date:   Sat Nov 3 23:11:18 2007 +0000

    Actually, reuse the key in local variable in some Hash methods.
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@4850 961051c9-f516-0410-bf72-c9f7e237a7b7

commit d0417a4cb39b84c121cf92fe7348f7dad79a0672
Author: Marcin Mielżyński <lopx@gazeta.pl>
Date:   Sat Nov 3 21:18:02 2007 +0000

    Fix for NPE during hash iteration by saving the key from entry before yielding the block (before, the original was used, it might be deleted/marked as NEVER and thus might leak into Ruby).
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@4849 961051c9-f516-0410-bf72-c9f7e237a7b7

commit 47fc3bf1ebb3d45594f50d9ccc88d56e8aadeba2
Author: Charles Oliver Nutter <headius@headius.com>
Date:   Fri Oct 26 19:26:48 2007 +0000

    Fix for JRUBY-1468, fixes the original issue, adds a whole raft of tests, and fixes a few additional issues discovered.
    
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@4747 961051c9-f516-0410-bf72-c9f7e237a7b7

commit 9bc9825436ea08670905a6e2a06d760a97b71d70
Author: Charles Oliver Nutter <headius@headius.com>
Date:   Fri Oct 19 20:52:01 2007 +0000

    Migrate JRubyMethod annotation to use String[] for names and aliases. Thanks Brad C from my blog.
    
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@4623 961051c9-f516-0410-bf72-c9f7e237a7b7

commit 0b7a2dae2ec0baa531f313568ffc9b7382f89592
Author: Charles Oliver Nutter <headius@headius.com>
Date:   Fri Oct 12 01:50:08 2007 +0000

    Migrate annotation-based method binding to generate DynamicMethod implementations directly, with arity checking built-in
    
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@4575 961051c9-f516-0410-bf72-c9f7e237a7b7

commit 87af426cef01bed33b6343a991dbc7c6bbf8c07f
Author: Ola Bini <ola.bini@gmail.com>
Date:   Wed Oct 10 16:17:03 2007 +0000

    Add compatibility aref for Mongrel
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@4554 961051c9-f516-0410-bf72-c9f7e237a7b7

commit 8557c622ca2f2cb7e0625bd6137241df0daed496
Author: Charles Oliver Nutter <headius@headius.com>
Date:   Tue Oct 9 22:08:32 2007 +0000

    Migrate RubyJRuby to annotation bindings, and fix an issue with module functions being defined on Object
    
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@4539 961051c9-f516-0410-bf72-c9f7e237a7b7

commit c3bbd8b79ba69dd6ae3980b559142d7950c3b695
Author: Nick Sieger <nick@nicksieger.com>
Date:   Tue Oct 9 16:02:31 2007 +0000

    Add RubyHash.aset method back for compatibility with AR-JDBC
    
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@4536 961051c9-f516-0410-bf72-c9f7e237a7b7

commit d2b68b348a66f5daf579466c7200126b7ce8ce3f
Author: Charles Oliver Nutter <headius@headius.com>
Date:   Mon Oct 8 20:33:53 2007 +0000

    Fix arity to calculate right and correct a few bugs that resulted from it being wrong.
    
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@4517 961051c9-f516-0410-bf72-c9f7e237a7b7

commit a10e46cec019a3964c75ebb6b2ec648c3b449ed3
Author: Charles Oliver Nutter <headius@headius.com>
Date:   Mon Oct 8 18:23:45 2007 +0000

    Migrate Hash to annotating bindings, rename and remap all equality methods to new conventions
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@4514 961051c9-f516-0410-bf72-c9f7e237a7b7

commit cef7acc6902e10559c06d98fa0ace3b8d9d4385e
Author: Marcin Mielżyński <lopx@gazeta.pl>
Date:   Sun Sep 30 12:22:28 2007 +0000

    Move equalInternal and eqlInternal into RubyObject static methods so they don't pollute IRubyObject interface
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@4428 961051c9-f516-0410-bf72-c9f7e237a7b7

commit 3e88cfab0d224fb9efa8d18336993e2c78ce495e
Author: Marcin Mielżyński <lopx@gazeta.pl>
Date:   Thu Sep 27 16:40:57 2007 +0000

    - Identified and extracted construction paths for class/module/singleton/IncludedModuleWrapper, now there's no unnecessary null checks or assignments in their constructors (they take very few arguments so even asserts are not needed).
    Each of those constructors have a comment what is it the responsible for, also, two RubyClass.newClass() and two RubyModule.newModule() methods have been extracted.
    - Fixed logic that sets the parent/constant for Modules, now matches MRI (only setConstant/getConstantAt are used here).
    - RubyClass rewritten, special attention has been put on allocation logic, now Class.new(...) doesn't fire a separate allocator class. (btw, logic of "class B < A;end" and "Class.new(A)" must be split since in second case superclass and allocator are not known until initialize is called). Class/Object allocation implementation mimics MRI's weirdest quirks in behavior, is _much_ simpler that it has been and much faster. This also allowed creation of generalized clone/dup implementations matching MRI. (only our special ivars need a care here).
    - Rewritten bootstrapping of Object/Class/Module.
    - Core classes (except Exception hierarchy, they should also be in future) are now cached in runtime (MRI caches them in static VALUE's like rb_cObject) Ruby.getClass(String), Ruby.getModule(String) and Ruby.getClassFromPath(String) should be used only by either interpreter or compiler and when the class name is not known at compile time.
    - Fixed and simplified nodes: classNode, moduleNode, sclassNode, defsNode. Compiler has been synchronized here as well.
    - No more __attached__ as ivar, it is now MetaClass field (which means lazy ivars for singletons). Compiler also updated.
    - added and dosumented isModule() to IRubyObject (isClass(), isSintleton() documented).
    - Fixed test_autoload test (Object.class_eval do;autoload :SomeClass, 'somefile';class SomeClass; end;end) should raise LoadError, now matches MRI.
    
    - Fixed a number of minor bugs:
       1.instance_eval, was creating a metaclass for Fixnum instances (also affected Symbol/FalseClass/TrueClass/NilClass)
       marshaler objects were kept in singleton classes
       Range.inspect, was modifying the begin field (when it was a String)
       Many bulletproofings in Marshal/Unmarshal (like unmarshaling an instance of nonexistant class), TypeErrors/ArgumentErrors matching MRI.
       Fiber.new in 1.9, doesn't call #initialize method by funcall, fixed
       number of method arity fixes and many methods are made fast now
       fixed initialize/initialize_copy logic, further simplification, no ClassCastExceptions possible now
       Fixed defineClass(under)/defineModule(under) logic
       bulletproofed cases such: class A;end;module A;end
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@4409 961051c9-f516-0410-bf72-c9f7e237a7b7

commit 329a7f7d51a8d87021bab56061abe95d43169a9b
Author: Marcin Mielżyński <lopx@gazeta.pl>
Date:   Thu Aug 30 22:54:43 2007 +0000

    Fix for JRUBY-1211: Hash should raise a RuntimeError when rehashed during iteration.
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@4246 961051c9-f516-0410-bf72-c9f7e237a7b7

commit 238d169535c75bd5b5a9e49f1e49d8ff2fff16ff
Author: Marcin Mielżyński <lopx@gazeta.pl>
Date:   Thu Aug 30 21:24:34 2007 +0000

    Fix for JRUBY-1209: Array#uniq, Array#|, Array#&, Array#- should be implemented in terms of RubyHash to actually use #eql? method on objects an array contains
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@4242 961051c9-f516-0410-bf72-c9f7e237a7b7

commit 875bdbab098dd2a9469cb97ce2dcda9bfa223217
Author: Marcin Mielżyński <lopx@gazeta.pl>
Date:   Thu Aug 30 20:20:56 2007 +0000

    Fix for JRUBY-1210: Array#join behaves inconsistently on recursive arrays.
    This required some fixes to the inspection mechanism allowing the join to be efficient (e.g: not looking up a ThreadLoacal on ["foo","bar"].join)
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@4238 961051c9-f516-0410-bf72-c9f7e237a7b7

commit 51a79fe02a53e22b45bfc360438c2092eb9577e7
Author: Thomas Enebo <tom.enebo@gmail.com>
Date:   Sat Aug 18 20:56:19 2007 +0000

    JRUBY-1280: Hash#select block parameter semantics are not cRuby compatible
    More unit test conversion by the mysterious Tom Brice
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@4184 961051c9-f516-0410-bf72-c9f7e237a7b7

commit 3eee7681b5e2ca9e18ca65304791eef82bde9d12
Author: Ola Bini <ola.bini@gmail.com>
Date:   Tue Aug 7 19:02:21 2007 +0000

    Add Java based kind_of? for some of our Java based implementations
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@4120 961051c9-f516-0410-bf72-c9f7e237a7b7

commit 5d981d73e8acacbf1782dccef26015674f638d9a
Author: Charles Oliver Nutter <headius@headius.com>
Date:   Sat Jul 28 00:57:41 2007 +0000

    Reversing modifications to Block#yield making it accept IRubyObject[] instead of IRubyObject (usually an array) because they actually made it *more* complicated to process masgn block arguments.
    
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@4069 961051c9-f516-0410-bf72-c9f7e237a7b7

commit 5747fd3ec8312c6a621ef48b17b2f3dd034de75b
Author: Thomas Enebo <tom.enebo@gmail.com>
Date:   Mon Jul 9 20:03:49 2007 +0000

    Remove various unused imports and code (e.g. make my cref patch more concise)
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@3978 961051c9-f516-0410-bf72-c9f7e237a7b7

commit 78cbe773471d332a3c21735e15928769efb108f0
Author: Charles Oliver Nutter <headius@headius.com>
Date:   Mon Jul 2 15:36:43 2007 +0000

    Landing Marcin's flags/OS changes; the memory savings alone will make us rich beyond our wildest dreams.
    
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@3952 961051c9-f516-0410-bf72-c9f7e237a7b7

commit 3855b2a7b32d013fbc4dbc8cdc3b4c6e9a9c8f0d
Author: Charles Oliver Nutter <headius@headius.com>
Date:   Sun Jul 1 18:59:57 2007 +0000

    Committing brand new dynamic STI generator; it's passing all tests, installs rake, runs rails. Any bugs, we'll find them in place.
    
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@3935 961051c9-f516-0410-bf72-c9f7e237a7b7

commit 74e99411e873e71a14c701e8fd200edf9f397ec4
Author: Charles Oliver Nutter <headius@headius.com>
Date:   Fri Jun 29 19:44:15 2007 +0000

    Modify the yield path to use IRubyObject[] instead of IRubyObject/RubyArray for passing values; part of simplifying argument processing and moving toward full block compilation support.
    
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@3922 961051c9-f516-0410-bf72-c9f7e237a7b7

commit 2f636186d2cf9587275b0ebbe3dec417122b3dd5
Author: Marcin Mielżyński <lopx@gazeta.pl>
Date:   Sun Jun 17 18:58:44 2007 +0000

    make Hash#default_proc and Hash#default fast methods. Hash#default should be STI method (called by Hash#[] when value not found)
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@3883 961051c9-f516-0410-bf72-c9f7e237a7b7

commit d490af4a9d510b46750d3a638162282991658f1c
Author: Charles Oliver Nutter <headius@headius.com>
Date:   Thu Jun 7 06:11:00 2007 +0000

    Added STI for inspect.
    
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@3847 961051c9-f516-0410-bf72-c9f7e237a7b7

commit 6ab8977aa4861824d215eda0c00d6f4cb1cfa607
Author: Charles Oliver Nutter <headius@headius.com>
Date:   Sun May 27 05:58:09 2007 +0000

    Zero-sum (hopefully) refactoring of trace functions to have an "event hook" model more like MRI. ruby-debug (and likely jruby-debug in the future) makes use of this event hook mechanism, so we'll need to have it in place to make the port easy. Also in this commit, fixed JIT to actually be running (it got turned off accidentally sometime in the past week) and make sure it's using the same "safe" logic for def arguments.
    
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@3746 961051c9-f516-0410-bf72-c9f7e237a7b7

commit d13e3fb516b6da2568844a95d6b8c8f26f48ffc9
Author: Charles Oliver Nutter <headius@headius.com>
Date:   Sun Apr 22 19:36:54 2007 +0000

    Wire up STI for to_hash and eql? in RubyHash; straggling part of JRUBY-807.
    
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@3528 961051c9-f516-0410-bf72-c9f7e237a7b7

commit e421186fd854c658a7cac4868e944d102c30a257
Author: Charles Oliver Nutter <headius@headius.com>
Date:   Sun Apr 22 19:18:54 2007 +0000

    Fixes and tests for JRUBY-807, correct eql?/== behavior for hashes.
    
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@3527 961051c9-f516-0410-bf72-c9f7e237a7b7

commit d77f8c9202ed39af9f9aae4987650e3a6fe62508
Author: Charles Oliver Nutter <headius@headius.com>
Date:   Thu Apr 19 08:35:13 2007 +0000

    Fixes for JRUBY-361: supply a real binding to trace functions. Also fixes JRUBY-842 by short-circuiting STI methods so they trace instead of doing fast STI dispatch.
    
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@3505 961051c9-f516-0410-bf72-c9f7e237a7b7

commit bac69eda717fe181084e119979408a1e8ad389f8
Author: Thomas Enebo <tom.enebo@gmail.com>
Date:   Mon Apr 16 22:38:58 2007 +0000

    Remove remaining metaclass definitions...
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@3480 961051c9-f516-0410-bf72-c9f7e237a7b7

commit d465fd9bc7ee6ae38475299bd82e65ac9d1311b4
Author: Ola Bini <ola.bini@gmail.com>
Date:   Mon Apr 16 10:41:12 2007 +0000

    Add several new STI's
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@3470 961051c9-f516-0410-bf72-c9f7e237a7b7

commit 7a77daca5662ec40025900d080e4e71c7271a278
Author: Charles Oliver Nutter <headius@headius.com>
Date:   Sun Apr 15 01:44:36 2007 +0000

    Committing Marcin's excellent Hash and String copy-on-write work for JRUBY-818. ant test is solid, mephisto appears to work well, and with one small bug fix, activesupport, actionpack, and actionmailer appear to run the same as on trunk (maybe a little better?). Also, I found and fixed a small bottleneck that now shows patched JRuby rdoc'ing faster than trunk. So we're gonna go for it.
    
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@3462 961051c9-f516-0410-bf72-c9f7e237a7b7

commit f4c15912b1d4edc84b06c882195d27df371d1023
Author: Charles Oliver Nutter <headius@headius.com>
Date:   Fri Apr 6 23:13:04 2007 +0000

    More cleanup of STI and expanding it to conversion methods and hash.
    
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@3404 961051c9-f516-0410-bf72-c9f7e237a7b7

commit 0abef1e2f88e7dbbb2b35980e00b05c3680f9425
Author: Charles Oliver Nutter <headius@headius.com>
Date:   Thu Mar 29 19:14:00 2007 +0000

    More coercion fixes, these solve JRUBY-740 and a few other issues I found. convertType* methods still need some cleanup though.
    
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@3333 961051c9-f516-0410-bf72-c9f7e237a7b7

commit bd27077e4907348961aa7ad3f300fdd43f82fcac
Author: Ola Bini <ola.bini@gmail.com>
Date:   Thu Mar 29 11:34:58 2007 +0000

    Fix the to_hash problem. This fix should probably be applied at other places too, since the original use (and conversion from C) of convertToTypeWithCheck was quite faulty
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@3326 961051c9-f516-0410-bf72-c9f7e237a7b7

commit 1c02ca0e641c238d2fc8985fe7f939b8b3df6f95
Author: Charles Oliver Nutter <headius@headius.com>
Date:   Thu Mar 29 05:54:41 2007 +0000

    Fixes for JRUBY-734, along with a first run at cleaning up IRubyObject.
    
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@3319 961051c9-f516-0410-bf72-c9f7e237a7b7

commit f5d499b05fc77e37e38fcfab0a3d55159dbcf1e8
Author: Charles Oliver Nutter <headius@headius.com>
Date:   Mon Mar 12 20:17:45 2007 +0000

    Eliminate ThreadContext.yield and add an overloaded version in Block instead. One less "utility" method on TC.
    
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@3181 961051c9-f516-0410-bf72-c9f7e237a7b7

commit 0a675c42ab9fff4e7aad77932642952c4eae67aa
Author: Ola Bini <ola.bini@gmail.com>
Date:   Wed Feb 21 19:25:16 2007 +0000

    Some updates from Marcin. Improves performance.
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@3049 961051c9-f516-0410-bf72-c9f7e237a7b7

commit a2107e60085a5063bca76d897783a512bbd7eddc
Author: Thomas Enebo <tom.enebo@gmail.com>
Date:   Sun Feb 18 15:18:18 2007 +0000

    JRUBY-606: Get rid of un/under-used IRuby interface
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@3022 961051c9-f516-0410-bf72-c9f7e237a7b7

commit bb20e69fca02df78c52e9c534db24e9f4dda0509
Author: Thomas Enebo <tom.enebo@gmail.com>
Date:   Sat Feb 17 22:29:59 2007 +0000

    JRUBY-599: JRuby needs a COW, primitive array backed builtin Array
    JRUBY-604: Hash#sort raises exception
    
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@3014 961051c9-f516-0410-bf72-c9f7e237a7b7

commit ef423f1b886650195114fe952a1a6407fbb63f82
Author: Thomas Enebo <tom.enebo@gmail.com>
Date:   Wed Feb 7 22:27:41 2007 +0000

    - Create a NULL_BLOCK to replace null checks against blocks:
      - Now isGiven() on a block tells you whether it is supplied or not
      - yield on the NULL_BLOCK throw the correct exception
        - We were not throwing this correctly by most callers with my landing of
          the block branch
        - We were generating NPE in cases where we called something that requires
          a block and supply none
    - Block.blockObject => Block.proc
     - Rename and type since this is just a convenience reference for association
       from block to what proc it might represent
    - Remove unused blockAtCreation (this may become relevent for Ruby 2 but why do
      it now
    - Remove ThreadContext and IRuby from Frame
    - Remove Scope
    - Put Visibility directly on Frame
    - callingzsuper dead code
    - Now that modules have a proper superclass we can get rid of special code in
      callSuper
    - ArgsPushNode.childNodes should not return null
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@2956 961051c9-f516-0410-bf72-c9f7e237a7b7

commit 26a487e99979ad5a509698929907eb42f3c4f4e6
Author: Nick Sieger <nick@nicksieger.com>
Date:   Sat Feb 3 20:55:55 2007 +0000

    Fix for JRUBY-517 (Marcin, Martin Traverso)
    
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@2934 961051c9-f516-0410-bf72-c9f7e237a7b7

commit fa021e6350a9913aec4080deb761bacd7e9414e2
Author: Thomas Enebo <tom.enebo@gmail.com>
Date:   Sun Jan 28 17:44:32 2007 +0000

    JRUBY-488: Kernel#dup, Kernel#clone and initialize_copy should obey MRI protocol
    
    Patch by Marcin
    
    Nice...
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@2864 961051c9-f516-0410-bf72-c9f7e237a7b7

commit 1c9db4cbbcca01aa65287532b82330e37ff81173
Author: Charles Oliver Nutter <headius@headius.com>
Date:   Sun Jan 28 03:44:22 2007 +0000

    Big set of changes for marshalling bug JRUBY-472; getting closer to having things sorted out. One known failure in "ant
    test" is due to our modules defining methods on a singleton class, which appears to be incorrect and harder to fix. I'm
    on it though.
    
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@2857 961051c9-f516-0410-bf72-c9f7e237a7b7

commit 5c0789044de8703f41bdf83f29552ba29ad048f6
Author: Thomas Enebo <tom.enebo@gmail.com>
Date:   Sat Jan 27 17:31:22 2007 +0000

    JRUBY-484: Reverse Iter Call relationship in AST and also pass block via Java frame versus maintaining blocks in TC
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@2851 961051c9-f516-0410-bf72-c9f7e237a7b7

commit a11f06d4024f5203ad06570202301aee4404c3ad
Author: Charles Oliver Nutter <headius@headius.com>
Date:   Sun Jan 21 00:42:58 2007 +0000

    Fix for JRUBY-467, fix marshaling/unmarshaling of hashes with defaults.
    
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@2802 961051c9-f516-0410-bf72-c9f7e237a7b7

commit 3d86ce7d3a49804b47f3137f0e5257e2cb1563ae
Author: Ola Bini <ola.bini@gmail.com>
Date:   Sun Jan 14 14:19:49 2007 +0000

    Fix for JRUBY-430, adds the block behavior to Hash#update/merge!. Needed for Rails parts.
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@2734 961051c9-f516-0410-bf72-c9f7e237a7b7

commit f00dfc9fcfb4c7a9ffbe605bd4cbf08cd2e9cb60
Author: Charles Oliver Nutter <headius@headius.com>
Date:   Sat Jan 6 01:42:03 2007 +0000

    Committing changes for JRUBY-405. I've accomplished what I set out to do, which was moving all the yield logic into Block and other appropriate classes. Other block refactoring, including adding a block argument to the call pipline, will come in other JIRAs.
    
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@2685 961051c9-f516-0410-bf72-c9f7e237a7b7

commit c41f74da90a0fae6fd661222d04c6b602b3bc6ec
Author: Ola Bini <ola.bini@gmail.com>
Date:   Sun Dec 31 12:23:39 2006 +0000

    Fix for JRUBY-385, recursive arrays and hashes
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@2627 961051c9-f516-0410-bf72-c9f7e237a7b7

commit a156e647330f19640b43fcb7db007b07c3dfd38e
Author: Charles Oliver Nutter <headius@headius.com>
Date:   Wed Nov 22 00:43:41 2006 +0000

    JRUBY-272 fixing each_pair to splat correctly (Damian Steer)
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@2451 961051c9-f516-0410-bf72-c9f7e237a7b7

commit 174e3d01468001668ab299227d4af11aea65341c
Author: Charles Oliver Nutter <headius@headius.com>
Date:   Tue Nov 14 03:09:59 2006 +0000

    damn the torpedos! full speed ahead! landing enebo_lexical branch changes plus TC-passing optimizations and a few small compiler updates
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@2423 961051c9-f516-0410-bf72-c9f7e237a7b7

commit 3f04b7ea16a8eaf59cf5de721f876360711e6521
Author: Charles Oliver Nutter <headius@headius.com>
Date:   Tue Oct 10 05:18:55 2006 +0000

    cleaning up a large number of looped calls to IRuby.getCurrentContext
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@2320 961051c9-f516-0410-bf72-c9f7e237a7b7

commit 0c435571475b27b4811d4e88e7747a0cf721a685
Author: Ola Bini <ola.bini@gmail.com>
Date:   Sun Oct 8 09:44:40 2006 +0000

    Fix regression for Hash#default. Bug JRUBY-186.
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@2313 961051c9-f516-0410-bf72-c9f7e237a7b7

commit 9b4d9369af3fd5dd922a6daed33b73996cc7984d
Author: Ola Bini <ola.bini@gmail.com>
Date:   Thu Oct 5 15:01:44 2006 +0000

    Fix for JRUBY-173 (Hash#default behavior for 1.8.5) and removed commented-out code
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@2289 961051c9-f516-0410-bf72-c9f7e237a7b7

commit 78ba72f060af5c147a90a18a449af7024a751765
Author: Ola Bini <ola.bini@gmail.com>
Date:   Thu Oct 5 14:51:18 2006 +0000

    Fix for JRUBY-125, fixed by Miguel Covarrubias.
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@2287 961051c9-f516-0410-bf72-c9f7e237a7b7

commit 4eb85a4aa5b1c369fedbce19adcc69a844fc7c69
Author: Thomas Enebo <tom.enebo@gmail.com>
Date:   Wed Oct 4 16:42:09 2006 +0000

    Landing charlies latest perf changes from his branch to trunk
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@2280 961051c9-f516-0410-bf72-c9f7e237a7b7

commit db94fb803a9355dfcba9a3cadee5a6e0f1e33033
Author: Charles Oliver Nutter <headius@headius.com>
Date:   Sun Sep 24 07:59:24 2006 +0000

    eliminated wasteful creation of extra hashMap
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@2233 961051c9-f516-0410-bf72-c9f7e237a7b7

commit a629a570985930f1dc88f37bf2c585dfe4ff6fb2
Author: Charles Oliver Nutter <headius@headius.com>
Date:   Thu Aug 17 01:38:04 2006 +0000

    merging headius branch to trunk
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@2204 961051c9-f516-0410-bf72-c9f7e237a7b7

commit dc9ebc85bd64040a28aeb6d23b3a4c90f21a9b7b
Author: Charles Oliver Nutter <headius@headius.com>
Date:   Sat Aug 5 05:54:15 2006 +0000

    optz: avoid multiple calls to IRuby.getCurrentContext in a single method
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@2165 961051c9-f516-0410-bf72-c9f7e237a7b7

commit b46a9962586a768eaf50113d17bdb4aef7e22000
Author: Thomas Enebo <tom.enebo@gmail.com>
Date:   Fri Jul 14 03:09:56 2006 +0000

    From patch notes:
    
    The attached patch (via subversive) fixes the problem described and also implements RubyHash#values
    
    class RubyHash
    ==============
    
        * entrySet() implemented as per the original TODO
        * values() implemented
        * keySet() reimplemented in same style as values() without dependency on inner
          class ConversionSet()
    
    Fixes [JRuby-4] (patch by Tim Azzopardi)
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@2125 961051c9-f516-0410-bf72-c9f7e237a7b7

commit d70012034b8795a6917f9e3b903281a59f12d372
Author: Thomas Enebo <tom.enebo@gmail.com>
Date:   Tue Jun 20 03:05:48 2006 +0000

    Make Hash marshal and unmarshal derived types well-enough for ROR flash to work... [melange of Tom and Charlie hacks -- Marshalling will get fixed for 0.9.1]
    
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@2079 961051c9-f516-0410-bf72-c9f7e237a7b7

commit dbc75f5775b42f401554a0465098c530e42532d6
Author: Thomas Enebo <tom.enebo@gmail.com>
Date:   Sat Apr 22 22:54:21 2006 +0000

    - to_s/inspect should return IRubyObject (inspect in object by default calls
      a method which may not actually return a string -- kaboom)
    - MatchData.inspect should return #<MatchData:0x14ae2c1> not to_s
    - Remove unused import
    
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@2010 961051c9-f516-0410-bf72-c9f7e237a7b7

commit ebc655285fa55c939b42b33be335d9f4b2040047
Author: Charles Oliver Nutter <headius@headius.com>
Date:   Sat Mar 25 06:25:36 2006 +0000

    fixing null default value for ENV hash creation
    
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@1940 961051c9-f516-0410-bf72-c9f7e237a7b7

commit efec6e6bf068c7c785c97856a2fb8e0b77ec1c53
Author: Thomas Enebo <tom.enebo@gmail.com>
Date:   Fri Mar 24 15:03:22 2006 +0000

    Make Hash with block or default value work better.
    
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@1939 961051c9-f516-0410-bf72-c9f7e237a7b7

commit dc8610ee83891b4297cc010122636fc1cd4d1e22
Author: Thomas Enebo <tom.enebo@gmail.com>
Date:   Thu Mar 23 13:55:00 2006 +0000

    Java methods for Array and Hash toArray(Object[]) implemented.  Patch by Oli Bina
    
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@1937 961051c9-f516-0410-bf72-c9f7e237a7b7

commit 1d43870a42678f709851fcd9349d32a5f5be0dca
Author: Charles Oliver Nutter <headius@headius.com>
Date:   Thu Feb 2 19:51:50 2006 +0000

    merging cnutter_work1 to HEAD
    
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@1869 961051c9-f516-0410-bf72-c9f7e237a7b7

commit 41adc9d73b44b14dd25593e772188d405ec00f2f
Author: Charles Oliver Nutter <headius@headius.com>
Date:   Wed Oct 26 05:34:12 2005 +0000

    removing revision keywords
    
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@1810 961051c9-f516-0410-bf72-c9f7e237a7b7

commit 4dfdacd80c56018084c618f3bbab7b542653d95e
Author: David Corbin <dcorbin@users.sourceforge.net>
Date:   Sat Oct 8 13:07:06 2005 +0000

    Introduced IRuby interface for Ruby runtime object.
    
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@1798 961051c9-f516-0410-bf72-c9f7e237a7b7

commit 36ec84bb4bc5dbd391c6ddb676b2faeb380f0539
Author: Charles Oliver Nutter <headius@headius.com>
Date:   Tue Sep 6 14:57:59 2005 +0000

    merging exception-removal changes to HEAD; EvaluateVisitor changes left on branch for now
    
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@1757 961051c9-f516-0410-bf72-c9f7e237a7b7

commit 9471600b61418fef8cd449559a934a4344c9b14b
Author: Thomas Enebo <tom.enebo@gmail.com>
Date:   Tue Jun 21 18:20:11 2005 +0000

    Convert Array and Hash to use newer MetaClass mechanism
    
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@1719 961051c9-f516-0410-bf72-c9f7e237a7b7

commit 730374d0e2c927d9aa63a3bb1e48f2c559a19957
Author: Thomas Enebo <tom.enebo@gmail.com>
Date:   Wed May 11 14:46:10 2005 +0000

    Hash is a Map not a Set
    
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@1691 961051c9-f516-0410-bf72-c9f7e237a7b7

commit 06fd3a0cc83f264aae38f64564fa24de5d5fe4ac
Author: Thomas Enebo <tom.enebo@gmail.com>
Date:   Wed Apr 27 01:32:26 2005 +0000

    Make RubyHash implement java.util.Map
    
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@1681 961051c9-f516-0410-bf72-c9f7e237a7b7

commit f11a64355c32c907a28e8c0cb8ade2cfee15cb46
Author: Thomas Enebo <tom.enebo@gmail.com>
Date:   Tue Mar 22 04:56:36 2005 +0000

    All Proc.clone to work
    
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@1630 961051c9-f516-0410-bf72-c9f7e237a7b7

commit 2faf2cadec13549ae263ef23ccebe4fe0a83ec94
Author: Thomas Enebo <tom.enebo@gmail.com>
Date:   Sun Feb 13 19:19:11 2005 +0000

    Hash#default should override constructor supplied block
    
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@1610 961051c9-f516-0410-bf72-c9f7e237a7b7

commit 7a83c48af56081c1c2132111d535f28d10cf3afb
Author: Thomas Enebo <tom.enebo@gmail.com>
Date:   Fri Dec 31 20:55:52 2004 +0000

    Update license to GPL/LGPL/CPL
    
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@1574 961051c9-f516-0410-bf72-c9f7e237a7b7

commit 49aa6e52e2393f8c17a3c126aed59b8fd08b68aa
Author: Stefan Matthias Aust <sma@3plus4.de>
Date:   Wed Dec 22 13:13:24 2004 +0000

    fix class clone bug
    fix freeze/taint bug for cloned/dup'd objects
    add test cases
    
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@1526 961051c9-f516-0410-bf72-c9f7e237a7b7

commit 40383241ec93bfe226df70f8338e54bf9255140f
Author: Jan Arne Petersen <jpetersen@uni-bonn.de>
Date:   Wed Dec 15 23:45:14 2004 +0000

    - Simplified method definition for builtin classes.
    - Added metaclass support for builtin classes.
    - Added ruby 1.8 allocate support.
    
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@1489 961051c9-f516-0410-bf72-c9f7e237a7b7

commit 8081fdc23459ab3e7b62155a53b7f18b561f93c1
Author: Stefan Matthias Aust <sma@3plus4.de>
Date:   Sun Dec 12 14:55:16 2004 +0000

    removes type parameter from CallbackFactory.getXXXMethod()
    and removes CallType from AbstractCallback and ReflectionCallback
    
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@1476 961051c9-f516-0410-bf72-c9f7e237a7b7

commit 870e1da9b41bfdbae259e1fc5f18fc8b76686998
Author: Stefan Matthias Aust <sma@3plus4.de>
Date:   Sun Dec 12 09:25:42 2004 +0000

    removes the instance variable runtime in RubyObject
    reintroduces the variable in RubyNil, RubyBoolean, and RubyClass
    delegates all calls to Fixnum,Array,Boolean,String,ArgumentError,IndexError and TypeError.newXXX to Ruby
    fixes all imports
    
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@1469 961051c9-f516-0410-bf72-c9f7e237a7b7

commit c15ab526440e25745b45a2ab3aaab1b5a7334d1f
Author: Stefan Matthias Aust <sma@3plus4.de>
Date:   Sun Nov 28 14:54:57 2004 +0000

    code cleanup
    
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@1428 961051c9-f516-0410-bf72-c9f7e237a7b7

commit b1562832239a5e5d73b1ee98dade51601e343257
Author: Jan Arne Petersen <jpetersen@uni-bonn.de>
Date:   Tue Nov 16 20:30:04 2004 +0000

    Rename references of org.jruby.Ruby from ruby to runtime.
    Remove unused methods from the IRubyErrorHandler interface.
    Add "same" method to RubyObject to fix "equal?"
    Fix JavaObject cache.
    
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@1408 961051c9-f516-0410-bf72-c9f7e237a7b7

commit 83ca1988efc1e67d360010f573b77a83d9d9bf03
Author: Thomas Enebo <tom.enebo@gmail.com>
Date:   Sat May 29 23:26:55 2004 +0000

    Messy Commit: 1. Module refactoring (fix bad unit tests) 2. String additions (casecmp, lstring{,!}, rstring{,!}) 3. Allow equal to return nil when needed. 4. testFrozen consolidation
    
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@1309 961051c9-f516-0410-bf72-c9f7e237a7b7

commit 85191d4818fb4a423b4777dd823f7008372ac670
Author: Thomas Enebo <tom.enebo@gmail.com>
Date:   Fri May 28 15:36:09 2004 +0000

    Whoops..println that should be there
    
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@1307 961051c9-f516-0410-bf72-c9f7e237a7b7

commit 545f3ea58b3d11634b9440df8e977b8d88f62bb4
Author: Thomas Enebo <tom.enebo@gmail.com>
Date:   Thu May 27 16:42:44 2004 +0000

    Hash update. add default_proc. add merge{,!}
    
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@1304 961051c9-f516-0410-bf72-c9f7e237a7b7

commit f5c9a1ebd775712f2dc086acfce1a14a123ec632
Author: Thomas Enebo <tom.enebo@gmail.com>
Date:   Tue May 25 15:54:04 2004 +0000

    Another round of star arg grammar fixes
    
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@1302 961051c9-f516-0410-bf72-c9f7e237a7b7

commit 177e803022ebff178750c6d8b9be9eac3ea33575
Author: Anders Bengtsson <ndrsbngtssn@yahoo.se>
Date:   Sun Jan 11 17:31:45 2004 +0000

    Added support for CGLIB, optional at both compile-time and run-time; Converted RubyHash back to using Reflection/CGLIB.
    
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@1212 961051c9-f516-0410-bf72-c9f7e237a7b7

commit 1cb8b0614e36c1ad8e36b82e88e3ea2342833795
Author: Anders Bengtsson <ndrsbngtssn@yahoo.se>
Date:   Thu Jan 8 18:15:34 2004 +0000

    Fixed Hash#index to return nil instead of the 'default value' when nothing is found.
    
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@1208 961051c9-f516-0410-bf72-c9f7e237a7b7

commit 89f158f5087026cd7ecc6bda6bf3fc75889b0517
Author: Anders Bengtsson <ndrsbngtssn@yahoo.se>
Date:   Fri Dec 5 21:27:14 2003 +0000

    Implemented Hash#values_at + few small cleanups.
    
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@1206 961051c9-f516-0410-bf72-c9f7e237a7b7

commit 2cec0fbb6e94cb21e737b2f94460d7f785cd423c
Author: Anders Bengtsson <ndrsbngtssn@yahoo.se>
Date:   Mon Oct 21 12:54:00 2002 +0000

    Definition-ified Hash
    
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@1005 961051c9-f516-0410-bf72-c9f7e237a7b7

commit 00655e69e6dbb4a30b5adf59cf1c0a3b78f46b02
Author: Anders Bengtsson <ndrsbngtssn@yahoo.se>
Date:   Mon Oct 21 10:52:23 2002 +0000

    Small refactoring in Parser; Implemented Hash#index.
    
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@1004 961051c9-f516-0410-bf72-c9f7e237a7b7

commit 06f34f3a6e4941994e00090d1365045e229680be
Author: Jan Arne Petersen <jpetersen@uni-bonn.de>
Date:   Sat Sep 21 23:05:19 2002 +0000

    - Some MetaClass refactorizations,
    
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@881 961051c9-f516-0410-bf72-c9f7e237a7b7

commit d667713f53902eb2be9e22076d1ecb9c190388a9
Author: Jan Arne Petersen <jpetersen@uni-bonn.de>
Date:   Tue Sep 17 13:07:22 2002 +0000

    - performance boost by removing "new IRubyObject[0]"
    
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@839 961051c9-f516-0410-bf72-c9f7e237a7b7

commit 0f597585eeb60edaa2dc6a7ce72cc9c02fcd2e57
Author: Anders Bengtsson <ndrsbngtssn@yahoo.se>
Date:   Thu Sep 12 11:55:39 2002 +0000

    Removed our special RubyMap and RubyHashMap, we now only use standard Map and HashMap.
    
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@804 961051c9-f516-0410-bf72-c9f7e237a7b7

commit c77b91f42c4f3810140d44cbe603248a1d52b7ee
Author: Jan Arne Petersen <jpetersen@uni-bonn.de>
Date:   Tue Sep 10 15:18:12 2002 +0000

    - restructure of the code tree.
    
    
    git-svn-id: http://svn.codehaus.org/jruby/trunk/jruby@782 961051c9-f516-0410-bf72-c9f7e237a7b7
