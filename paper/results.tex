% -*- root: main.tex -*-
% !TEX root = main.tex
The main goal of our study is to better understand what happens to \SATD once it is introduced into software projects. To do so, our first step is to quantify how much of \SATD comments gets removed (RQ1). Then, we analyze if the developers have sense of ownership on \SATD comments by analyzing who are the authors of the changes that introduced and then removed these \SATD comments (RQ2). 
\alexander{An option here would also be to confirm the findings by interviewing/surveying the developers.}

\alexander{shouldn't the following discussion of the RQs be in the introduction?}
\vspace{3mm}
\noindent\rqi
\vspace{3mm}

\noindent \textbf{Motivation:} Previous work showed that technical debt is widespread, unavoidable and has a negative impact ion the quality of software projects~\cite{Lim2012Software}. Therefore, intuitively we expect that removing technical debt from the source code is a concern to developers. To better understand how developers deal with technical debt we must first identify and quantify how much debt is introduced and removed. Also, answering this question will provide us insight if source code comments indeed helps developers to manage technical debt. 

\vspace{1mm}
\noindent \textbf{Approach:} To answer this question we automatically identify design self-admitted technical debt from the seven analyzed projects. As described in Section~\ref{sub:checkout_all_versions_of_files} we have stored all different versions of all source code files. For each analyzed \SATD comment we take the oldest file version available on which the debt was found and incrementally search for matches in all latter versions of this file. The first time that the analyzed \SATD comments appears in a file points out to the exact file version that the \SATD comment was introduced in the system.

To analyze if the introduced \SATD comment was removed we keep searching for matches of the comment in the remaining file versions available. Therefore, the first file version that we are not able to find a match for the analyzed comment is also the version that the \SATD comment was removed. Another possible way to remove a \SATD comment is by deleting the file that contains it. 

\vspace{1mm}
\noindent \textbf{Results:} Table \ref{tbl:removed_self_admitted_technical_debt_per_project} presents the quantity of identified and removed \SATD comments. We find that the majority (\textit{i.e.,} on average 74.9\%, \alexander{how has this average been computed?}) of the identified \SATD comments were removed. For example, we were able to find 854 unique instances of design \SATD comments when analyzing Ant project. 85.2\% (\textit{i.e.,} 738) of these \SATD comments were removed during the evolution of the project. Camel has the highest \SATD comments removal percentage (\textit{i.e.,} 90.6), whereas Hadoop has the lowest removal percentage achieving 40.5\%.

\begin{table}[!thb]
    \begin{center}
        \caption{Removed Self-Admitted Technical Debt per Project}
        \label{tbl:removed_self_admitted_technical_debt_per_project}
        \begin{tabular}{l| r r r}
        \toprule
        \textbf{\thead{Project}} & \textbf{\thead{\# of identified\\technical debt}} & \textbf{\thead{\# of removed\\technical debt}} & \textbf{\thead{\% of removed\\technical debt}} \\ 
        \midrule
         \textbf{Camel }  &  4,331  & 3,926  & 90.6 \\
         \textbf{Log4j }  &  135    & 118    & 87.4 \\ 
         \textbf{Ant   }  &  854    & 728    & 85.2 \\  
         \textbf{Jmeter}  &  1,260  & 981    & 77.8 \\ 
         \textbf{Gerrit}  &  271    & 208    & 76.7 \\
         \textbf{Tomcat}  &  1,317  & 1,009  & 76.6 \\   
         \textbf{Hadoop}  &  1,164  & 472    & 40.5 \\  
        
         \midrule
         \textbf{Average} & -       & -      & 74.9 \\
        \bottomrule
        \end{tabular}
    \end{center}    
\end{table}

\conclusionbox{We find that the majority of \SATD comments gets removed over the evolution of the project. Considering all projects the percentage of \SATD comments removal ranged from 40.5 to 90.6, and on average 74.9\% of the identified \SATD is removed.}
 
\alexander{Here we need a baseline comparison: are \SATD comments being removed more or less often than regular comments.}

\vspace{3mm}
\noindent\rqii
\vspace{3mm}

\noindent \textbf{Motivation:} \SATD stands for technical debt ``confessed'' by the developers themselves. This intuition leads us to believe that it would be natural that the developer who expressed concern about the code would be also the one who fixes it in the future. For example, it would be more difficult to have other developers to address \SATD since 1) they need to know how to address the issue and 2) they may not know where the \SATD is. 

\vspace{1mm}
\noindent \textbf{Approach:} To answer this question we analyzed the authors of the changes (\textit{i.e.,} commits from the source code repository) that introduced or removed \SATD comments. In order to do that, we first determine the change that the \SATD comment was added to a file, then we check the remaining file versions to determine if there is any change that removed the \SATD. Once that the changes are identified we compare the authors of the changes to see if they are the same or not. 

We take into consideration two attributes of the change when comparing authors, author name and email address. This is a necessary heuristic to mitigate the risk of misclassifying authors that changed their names in the source code repository during the evolution of the project.  

\vspace{1mm}
\noindent \textbf{Results:} We find that the majority of \SATD are removed by the same author who introduced it. For the sake of clarity, we address \SATD removed by the same author who introduced it as ``self-removed technical debt''. In average\alexander{as above, how has it been computed?}, 57.24\% of all removals are self-removed technical debt. The project with highest percentage of self-removed technical debt was Gerrit with 71.63\%. On the other hand, the project with the lowest percentage of self-removed technical debt was Hadoop with 24.57\%. \alexander{Can we include this information in the previous table?} Non self-removed technical debt, \SATD that was introduced by one author and then removed by a different author in the future, represented in average 42.75\% of the removals ranging from 28.36\% to 75.42\% in Hadoop and Gerrit, respectively. Table \ref{tbl:self_removed_technical_debt_vs_non_self_removed_technical_debt_per_project} presents detailed information per project.

\alexander{The risk here is that the self-removal is not a consequence of the ``guilt confession'' but a side effect of one developer/small group of developers doing all the work in the project or in its part. Can we somehow check this?} 
\begin{table*}[!thb]
    \begin{center}
        \caption{Self-Removed Technical Debt vs Non Self-Removed Technical Debt per Project}
        \label{tbl:self_removed_technical_debt_vs_non_self_removed_technical_debt_per_project}
        \begin{tabular}{l| c c c c c}
        \toprule
        \textbf{\thead{Project}} & \textbf{\thead{\# of removed\\technical debt}} & \textbf{\thead{\# of self-removed\\technical debt}} & \textbf{\thead{\% of self-removed\\technical debt}} & \textbf{\thead{\# of non self-removed\\technical debt}} & \textbf{\thead{\% of non self-removed\\technical debt}} \\ 
        \midrule
         \textbf{Ant   }   & 728   &  372  & 51.09 &   356  & 48.90 \\  
         \textbf{Camel }   & 3,926 & 2,652 & 67.54 &  1,274 & 32.45 \\  
         \textbf{Gerrit}   & 208   &  149  & 71.63 &    59  & 28.36 \\  
         \textbf{Hadoop}   & 472   &  116  & 24.57 &   356  & 75.42 \\  
         \textbf{Jmeter}   & 981   &  663  & 67.58 &   318  & 32.41 \\  
         \textbf{Log4j }   & 118   &   72  & 61.01 &    46  & 38.98 \\  
         \textbf{Tomcat}   & 1,009 &  578  & 57.28 &   431  & 42.71 \\  
         \midrule
         \textbf{Average} & -      & -     & 57.24 &    -   & 42.75 \\
        \bottomrule
        \end{tabular}
    \end{center}    
\end{table*}

\conclusionbox{We find that in average self-removed technical debt represents 54.24\% of all removals. The percentage of removal ranges from 24.57 to 71.63\% across the analyzed projects, whereas non self-removed technical debt removal represents in average 42.75\% of the technical debt removals}
\alexander{I'm not a big fan of averages...}

\vspace{3mm}
\noindent\rqiii
\vspace{3mm}

\noindent \textbf{Motivation:} Although the previous research questions helps understanding how \SATD comments are removed they do not provide much insight about how long \SATD comments survives in the project. Answering this question will allow us to analyze if it is typical to have \SATD comments in the projects and for how long.  

In addition, once we quantified the number of self-removed technical debt and the number of non self-removed technical debt we would like to understand if these two categories of removal have differences between them. For example, which one gets removed faster or which one is more likely to survive in the project once added. 

\vspace{1mm}
\noindent \textbf{Approach:} For each project analyzed we find all changes that introduced a \SATD comment, and similarly, whenever possible, the change that removed the \SATD comment. Each change committed to the source code repository possesses a collection of useful information \alexander{please rephrase} that allows us to run a number of different analyses. 

To answer this question we examine the time between introduction and removal of each change related related to the \SATD comments that we previously were able to identify. In addition, we leverage the knowledge gathered so far to determine the authors of the change. 
\alexander{We should perform a statistical analysis...}

\vspace{1mm}
\noindent \textbf{Results:} We find that self-removed technical debt gets removed faster than non self-removed technical debt. Figures \ref{fig:removal_comparison_gerrit}, \ref{fig:removal_comparison_hadoop} and \ref{fig:removal_comparison_tomcat} presents the comparison between self-removal and non self-removal of three projects, namely, Gerrit, Hadoop and Tomcat. We selected these projects as they represent the general behavior of the analyzed dataset. As we can observe in Figures \ref{fig:removal_comparison_gerrit}, \ref{fig:removal_comparison_hadoop} and \ref{fig:removal_comparison_tomcat} self-removal technical debt is removed faster then non self-removal technical debt when considering the amount of days that each technical debt was part of the analyzed system. The horizontal black line on each figure mark the median of the dataset, that also happens earlier for self-removed technical debt. In addition for each figure we plotted the number of occurrences measured on each dataset on the legend indicated by the letter `N'' followed by the precise median in days.

\begin{figure*}[t]
	\centering
	\begin{subfigure}[b]{0.33\textwidth}
		\includegraphics[width=\textwidth]{figures/gerrit_beanplot.pdf}
		\caption{Self-Removal vs \\ Non Self-Removal for Gerrit}
		\label{fig:removal_comparison_gerrit}
	\end{subfigure}
  ~
  ~
  ~
	\begin{subfigure}[b]{0.33\textwidth}
		\includegraphics[width=\textwidth]{figures/hadoop_beanplot.pdf}
		\caption{Self-Removal vs \\ Non Self-Removal for Hadoop}
		\label{fig:removal_comparison_hadoop}
	\end{subfigure}
  ~ 
  ~
  ~ 
	\begin{subfigure}[b]{0.33\textwidth}
		\includegraphics[width=\textwidth]{figures/tomcat_beanplot.pdf}
		\caption{Self-Removal vs \\ Non Self-Removal for Tomcat}
		\label{fig:removal_comparison_tomcat} 
	\end{subfigure}
\end{figure*}




\begin{table}[!thb]
	\begin{center}
		\caption{Mann-Whitney Test ($p$-value) and Cliff's Delta ($d$)}
		\label{tbl:statistic}
		\begin{tabular}{l| rrr}
			\toprule
			\textbf{\thead{Project}} & \textbf{\thead{$p$-value}} & \textbf{\thead{$d$}}\\ 
			\midrule
			\textbf{Ant   }   &    &    \\  
			\textbf{Camel }   &    &    \\  
			\textbf{Gerrit}   &    &    \\  
			\textbf{Hadoop}   &    &    \\  
			\textbf{Jmeter}   &    &    \\  
			\textbf{Log4j }   &    &    \\  
			\textbf{Tomcat}   &    &    \\  
			\bottomrule
		\end{tabular}
	\end{center}    
\end{table}






One other thing that we evaluate to answer this question is the general nature of the removals. We divided all the removals into two categories. The first we call file edition and the second file removal. In other words, we want to better understand if the removals of technical debt are happening as the project evolves and resembles a ``floss refactoring'' type of maintenance or if the files just gets deleted after a time due to its entropy. 

We find that the majority of the removals happens during the edition of files and not when the files get deleted. On average 74.8\% of all removals are done by inclemently editing the files that contains technical debt.



% \begin{itemize}
% \item Add figures of distribution of removal time.
% \item Add survival plots
% \item file addition vs. removal
% \item Difference between self vs. non-self removal.
% \end{itemize}

\conclusionbox{We find that the median amount of time that self-removed technical debt stays in the project is 18 days whereas non self removal technical debt is 127 days. In addition we find that technical debt removals happens more when the files containing debt are edited than when they are removed.}

 \vspace{3mm}
 \noindent\rqiv
 \vspace{3mm}

 \noindent \textbf{Motivation:} 
We want to know what activities tend to lead to the removal of TD.
 \vspace{1mm}
 \noindent \textbf{Approach:} 
Examine the commits messages of the removal commits and run topic models.
 \vspace{1mm}
 
 \noindent \textbf{Results:} 
\begin{itemize}
\item Add topics/activities that lead to the removal.
\end{itemize}
 \conclusionbox{}