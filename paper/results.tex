
% -*- root: main.tex -*-
% !TEX root = main.tex
The main goal of our study is to better understand what happens to \SATD once it is introduced into software projects. To do so, our first step is to quantify how much of \SATD comments gets removed (RQ1). Then, we analyze if the developers have sense of ownership on \SATD comments by analyzing who are the authors of the changes that introduced and then removed these \SATD comments (RQ2). 

%\alexander{An option here would also be to confirm the findings by interviewing/surveying the developers.}

%\alexander{shouldn't the following discussion of the RQs be in the introduction?}
%\emad{we incorporate a part of that in the intro.}
\noindent\rqi
\noindent \textbf{Motivation:} Previous work showed that technical debt is widespread, unavoidable, and has a negative impact on the quality of software projects~\cite{Lim2012Software}. Therefore, intuitively we expect that removing technical debt from the source code is a concern to developers. To better understand how developers deal with technical debt we must first identify and quantify how much debt is introduced and removed. Also, answering this question will provide us insight if source code comments indeed helps developers to manage technical debt. 


\noindent \textbf{Approach:} To answer this question we automatically identify \SATD from the seven analyzed projects. As described in Section~\ref{sub:checkout_all_versions_of_files}, we stored all versions of all source code files. Then, for each analyzed \SATD comment we take the oldest file version available in which the debt was found and incrementally search for matches in future versions of the file. The first time that the analyzed \SATD comment(s) appears in a file, indicates the exact file version that the \SATD comment was introduced. To analyze if the introduced \SATD comment was later removed, we search for comment in the remaining file versions. When the comment is no longer found, we mark that version of the file as the removal version. In certain cases, a \SATD comment is found in one version only (i.e., the version that it is introduced in). Such cases indicate a scenario where the \SATD was introduced and removed in the immediate next version. 

%Therefore, the first file version that we are not able to find a match for the analyzed comment is also the version that the \SATD comment was removed. Another possible way to remove a \SATD comment is by deleting the file that contains it. 


\noindent \textbf{Results:} Table \ref{tbl:removed_self_admitted_technical_debt_per_project} presents the quantity of identified and removed \SATD comments. We find that the majority (\textit{i.e.,} on average 74.4\%, median 76.7\%) of the identified \SATD comments were removed. We measure the average on a per project basis, i.e., the total from each project is taken and the average over the five projects in provided. For example, we were able to find 854 unique instances of \SATD comments when analyzing Ant project. 85.2\% (\textit{i.e.,} 738) of these \SATD comments were removed during the evolution of the project. Camel had the highest \SATD comments removal percentage (\textit{i.e.,} 90.6), whereas Hadoop had the lowest removal percentage achieving 40.5\%.

\begin{table}[!t]
	\begin{center}
		\caption{Removed Self-Admitted Technical Debt per Project}
		\label{tbl:removed_self_admitted_technical_debt_per_project}
		\begin{tabular}{l|rrr}
			\toprule
			\textbf{\thead{Project}} & \textbf{\thead{\# of\\ identified\\technical \\debt}} & \textbf{\thead{\# of \\removed\\technical \\debt}} & \textbf{\thead{\% of \\removed\\technical \\debt}} \\ 
			\midrule
			%\textbf{Ant   }  &  854    & 728    & 85.2 \\  
			\textbf{Camel }  &  4,331  & 3,926  & 90.6 \\
			\textbf{Gerrit}  &  271    & 208    & 76.7 \\
			\textbf{Hadoop}  &  1,164  & 472    & 40.5 \\  
			%\textbf{Jmeter}  &  1,260  & 981    & 77.8 \\ 
			\textbf{Log4j }  &  135    & 118    & 87.4 \\ 
			\textbf{Tomcat}  &  1,317  & 1,009  & 76.6 \\   
			\midrule
			\textbf{Average} & -       & -      & 74.4 \\
			\textbf{Median} & -       & -      & 76.7 \\
			\bottomrule
		\end{tabular}
	\end{center}    
\end{table}

\begin{table*}[t]
	\begin{center}
		\caption{Self-Removed Technical Debt vs Non Self-Removed Technical Debt per Project}
		\label{tbl:self_removed_technical_debt_vs_non_self_removed_technical_debt_per_project}
		\begin{tabular}{l| c | c c | c c}
			\toprule
			\textbf{\thead{Project}} & \textbf{\thead{\# of \\removed\\technical debt}} & \textbf{\thead{\# of \\self-removed\\technical debt}} & \textbf{\thead{\% of self-removed\\technical debt}} & \textbf{\thead{\# of \\non self-removed\\technical debt}} & \textbf{\thead{\% of \\non self-removed\\technical debt}} \\ 
			\midrule
			%\textbf{Ant   }   & 728   &  372  & 51.09 &   356  & 48.90 \\  
			\textbf{Camel }   & 3,926 & 2,652 & 67.5 &  1,274 & 32.5 \\  
			\textbf{Gerrit}   & 208   &  149  & 71.6 &    59  & 28.4 \\  
			\textbf{Hadoop}   & 472   &  116  & 24.6 &   356  & 75.4 \\  
			%\textbf{Jmeter}   & 981   &  663  & 67.58 &   318  & 32.41 \\  
			\textbf{Log4j }   & 118   &   72  & 61.0 &    46  & 39.0 \\  
			\textbf{Tomcat}   & 1,009 &  578  & 57.3 &   431  & 42.7 \\  
			\midrule
			\textbf{Average} & -      & -     & 54.4 &    -   & 43.6 \\
			\textbf{Median}  & -      & -     & 61.0 &    -   & 39.0 \\
			\bottomrule
		\end{tabular}
	\end{center}    
\end{table*}
\conclusion{We find that the majority of \SATD comments gets removed over the evolution of the project. Considering all projects the percentage of \SATD comments removal ranges between 40.5 - 90.6\%, and on average 74.9\% of the identified \SATD is removed.}
 
%\alexander{Here we need a baseline comparison: are \SATD comments being removed more or less often than regular comments.}
%\emad{I don't think we need a baseline since we are not necessarly comparing to anything, we are just studying how much gets removed.}

\noindent\rqii
%\vspace{3mm}

\noindent \textbf{Motivation:} \SATD stands for technical debt ``confessed'' by the developers themselves. This intuition leads us to believe that it would be natural that the developers who expressed concern about the code would be also the ones who fix it in the future. However, it is unknown whether this is the case. Intuitively, it makes sense that self-removal of \SATD is easier, since the developers know about the reason for the \SATD introduction and possibly how to address it. The findings of this question will highlight whether our intuition is true, and if it is not true, then our finding serves as an indication for developers that introduce \SATD to document it well since most of the time it maybe someone else who needs to address the \SATD.

%For example, it would be more difficult to have other developers to address \SATD since 1) they need to know how to address the issue and 2) they may not know where the \SATD is. 


\noindent \textbf{Approach:} To answer this question we analyzed the authors of the changes (\textit{i.e.,} commits from the source code repository) that introduced or removed \SATD comments. In order to do that, we first determine the commit in which the \SATD comment was added to a file, then we check the remaining file versions to determine if there is any commit that removed the \SATD. Once that the changes are identified we compare the authors of the changes to see if they are the same or not. 

We take into consideration two attributes of the change when comparing authors, author name and email address. This is a necessary heuristic to mitigate the risk of misclassifying authors that change their names in the source code repository during the evolution of the project.  


\noindent \textbf{Results:} Table~\ref{tbl:self_removed_technical_debt_vs_non_self_removed_technical_debt_per_project} shows that most \SATD is removed by the same author who introduced it, referred to as ``self-removed technical debt''. On average, 54.4\% of all removals are self-removed technical debt. Once again, we measure the average on a per project basis, i.e., the total from each project is taken and the average over the five projects in provided. The project with highest percentage of self-removed technical debt was Gerrit with 71.6\%. On the other hand, the project with the lowest percentage of self-removed technical debt was Hadoop with 24.6\%. Non self-removed technical debt, i.e., debt that was introduced by one author and removed by a different author in the future, represents on average 43.6\% of the removals.

% \alexander{Can we include this information in the previous table?}

%\alexander{The risk here is that the self-removal is not a consequence of the ``guilt confession'' but a side effect of one developer/small group of developers doing all the work in the project or in its part. Can we somehow check this?} 
%\emad{interesting. we should add this to the threats.}

\conclusion{We find that most \SATD (on average 54.4\% and median 61.0\%) is self-removed.}
%\alexander{I'm not a big fan of averages...}



\begin{figure*}[t]
	\centering
	
	
	\begin{subfigure}[b]{0.24\textwidth}
		\includegraphics[width=\textwidth]{figures/test/Ant.pdf}
		%\caption{Self-Removal vs \\ Non Self-Removal for Gerrit}
		\label{fig:removal_comparison_gerrit}
	\end{subfigure}
	\begin{subfigure}[b]{0.24\textwidth}
		\includegraphics[width=\textwidth]{figures/test/Camel.pdf}
		%\caption{Self-Removal vs \\ Non Self-Removal for Hadoop}
		\label{fig:removal_comparison_hadoop}
	\end{subfigure}
	\begin{subfigure}[b]{0.24\textwidth}
		\includegraphics[width=\textwidth]{figures/test/Guerrit.pdf}
		%\caption{Self-Removal vs \\ Non Self-Removal for Tomcat}
		\label{fig:removal_comparison_tomcat} 
	\end{subfigure}
	\begin{subfigure}[b]{0.24\textwidth}
		\includegraphics[width=\textwidth]{figures/test/Hadoop.pdf}
		%\caption{Self-Removal vs Non Self-Removal for Tomcat}
		\label{fig:removal_comparison_tomcat} 
	\end{subfigure}
	
	
	
	\begin{subfigure}[b]{0.24\textwidth}
		\includegraphics[width=\textwidth]{figures/test/Jmeter.pdf}
		%\caption{Self-Removal vs \\ Non Self-Removal for Gerrit}
		\label{fig:removal_comparison_gerrit}
	\end{subfigure}
	\begin{subfigure}[b]{0.24\textwidth}
		\includegraphics[width=\textwidth]{figures/test/Log4j.pdf}
		%\caption{Self-Removal vs \\ Non Self-Removal for Hadoop}
		\label{fig:removal_comparison_hadoop}
	\end{subfigure}
	\begin{subfigure}[b]{0.24\textwidth}
		\includegraphics[width=\textwidth]{figures/test/Tomcat.pdf}
		%\caption{Self-Removal vs \\ Non Self-Removal for Tomcat}
		\label{fig:removal_comparison_tomcat} 
	\end{subfigure}
	
	%	 	~
	%	 	~
	%	 	~
	\begin{subfigure}[b]{0.30\textwidth}
		\includegraphics[width=\textwidth]{figures/test/legend.pdf}
		%\caption{Self-Removal vs \\ Non Self-Removal for Tomcat}
		%\label{fig:removal_comparison_tomcat} 
	\end{subfigure}
	\caption{Self-Removal vs Non Self-Removal for all studied projects}
	
\end{figure*}



\noindent\rqiii
%\vspace{3mm}

\noindent \textbf{Motivation:} Although the earlier research questions help understanding how \SATD comments are removed they do not provide much insight about how long \SATD comments actually exist in project. Answering this question will allow us to better understand whether it is normal to have \SATD comments in the projects and for how long. In addition, once we quantify the number of self-removed technical debt and the number of non self-removed technical debt comments, we would like to understand if these two categories of removal have differences between them. For example, which one gets removed faster or which one is more likely to survive in the project once added \emad{doesn't make sense to me - how can we have non satd}. 

\noindent \textbf{Approach:} To determine the amount of time that \SATD lives in a project, we use the time difference between the commit that introduces and removes the \SATD comment. The steps to identify the \SATD introducing and removing commits are the same as we outlined in RQs 1 and 2.

%find all changes that introduced a \SATD comment, and similarly, whenever possible, the change that removed the \SATD comment. Each change committed to the source code repository possesses a collection of useful information \alexander{please rephrase} that allows us to run a number of different analyses. To answer this question we examine the time between introduction and removal of each change related related to the \SATD comments that we previously were able to identify. In addition, we leverage the knowledge gathered so far to determine the authors of the change. 
%\alexander{We should perform a statistical analysis...}


In addition we compare the two distributions using a Mann-Whitney test~\cite{mann1947test} to determine if the difference is statistically significant at $p$ $<$$=$ 0.05. We also estimated the magnitude of the difference between self-removed technical debt and non self-removed technical debt using the Cliff's Delta (or $d$)~\cite{grissom2005effect}, a
non-parametric effect size measure for ordinal data. We consider the effect size values: small for $d$ $<$ 0.33 (positive as well as negative values), medium for 0.33  $\leq d<$ 0.474 and large for $d \geq$ 0.474.



\noindent \textbf{Results:} \emad{we need to add the general result of how long SATD lives in a project period.}

In addition, we also compare the time that self-removed and non self-removed \SATD lives in the system. We find that self-removed technical debt gets removed faster than non self-removed technical debt. Figures \ref{fig:removal_comparison_gerrit}, \ref{fig:removal_comparison_hadoop} and \ref{fig:removal_comparison_tomcat} presents the comparison between self-removal and non self-removal of three projects, namely, Gerrit, Hadoop and Tomcat. We selected these projects since they represent the general behaviour of the analyzed dataset. As we can observe in Figures \ref{fig:removal_comparison_gerrit}, \ref{fig:removal_comparison_hadoop} and \ref{fig:removal_comparison_tomcat} self-removal technical debt is removed faster than non self-removal technical debt when considering the amount of days that each technical debt was part of the analyzed system. The horizontal black line on each figure mark the median value of removal time. In addition for each figure we plotted the number of occurrences measured on each dataset, as shown in the legend indicated by the letter `N' followed by the precise median in days.


%-------------------------------------------------------------------------------
\begin{table*}[h!]
	\centering
	\caption{Distribution of the removed STD Comments}
	\label{my-label}
	\begin{tabular}{@{}lrrrrrr@{}}
		\toprule
		\textbf{Project} & \textbf{Min.} & \textbf{1st Qu.} & \textbf{Median} & \textbf{Mean} & \textbf{3rd Qu.} & \textbf{Max.} \\ \midrule
		ANT & 0.003 & 21.570 & 91.910 & 427.100 & 282.900 & 4933 \\
		Jmeter & 0.001 & 40.210 & 228.000 & 498.100 & 787.900 & 4866 \\
		Camel & 0.0004 & 1.0910 & 18.1600 & 82.0300 & 47.8600 & 2930 \\
		Hadoop & 0.0143 & 45.1700 & 159.0000 & 326.8000 & 512.1000 & 1608 \\
		Tomcat & 0.000 & 5.752 & 164.900 & 613.200 & 1122.000 & 3610 \\
		Log4j & 0.063 & 21.580 & 172.800 & 516.000 & 605.200 & 3686 \\
		Guerrit & 0.002 & 8.111 & 10.840 & 177.000 & 113.800 & 2574 \\ \bottomrule
	\end{tabular}
\end{table*}




\begin{figure}[thb!]
	\centering
	\includegraphics[width=\columnwidth]{figures/test/removed_all_STD_comments.pdf}
	\caption{The distribution of all the removed STD comments}
	\label{fig:removed_all_std_comments}
\end{figure}



%--------------------------------------------------------------------------------




% Please add the following required packages to your document preamble:
% \usepackage{booktabs}
\begin{table*}[]
	\centering
	\caption{My caption}
	\label{my-label}
	\begin{tabular}{@{}lrrrrr@{}}
		\toprule
		\textbf{} & \textbf{Never} & \textbf{Rarely} & \textbf{Sometimes} & \textbf{Often} & \textbf{Very Often} \\ \midrule
		How often do developers encounter technical debt comments? & 0.0 & 0.0 & 50.0 & 21.4 & 28.6 \\
		How often do developers add technical debt comments? & 7.1 & 28.6 & 42.9 & 7.1 & 14.3 \\
		How often do developers address technical debt comments? & 0.0 & 50.0 & 28.6 & 21.4 & 0.0 \\ \bottomrule
	\end{tabular}
\end{table*}




\begin{table}[t]
	\begin{center}
		\caption{Self-Removal vs Non Self-Removal: Mann-Whitney Test ($p$-value) and Cliff's Delta ($d$) \emad{is this actually discussed?}}
		\label{tbl:statistic}
		\begin{tabular}{l| rrr}
			\toprule
			\textbf{\thead{Project}} & \textbf{\thead{$p$-value}}&~~~ & \textbf{\thead{$d$}}\\ 
			\midrule
			\textbf{Ant   }   &  < 2.2e-16& ~~~  &  -0.427(medium)  \\  
			\textbf{Camel }   &  0.0001253& ~~~ &  -0.075(negligible)  \\  
			\textbf{Gerrit}   &  3.581e-14& ~~~ &  -0.671(large)  \\  
			\textbf{Hadoop}   &  < 2.2e-16& ~~~ &  -0.531(large)  \\  
			\textbf{Jmeter}   &  < 2.2e-16& ~~~ &  -0.325(small)  \\  
			\textbf{Log4j}   &  2.345e-06 & ~~~ &  -0.517(large)  \\  
			\textbf{Tomcat}   &  2.2e-16  & ~~~ &  -0.820(large) \\  
			\bottomrule
		\end{tabular}
	\end{center}    
\end{table}





One other thing that we evaluate to answer this question is the general nature of the removals. We divided all the removals into two categories. The first we call file edition and the second file removal. In other words, we want to better understand if the removals of technical debt are happening as the project evolves and resembles a ''floss refactoring'' type of maintenance or if the files just gets deleted after a time due to its entropy. We find that the majority of the removals happens during the edition of files and not when the files get deleted. On average 74.8\% of all removals are done by inclemently editing the files that contains technical debt. \emad{Why do we do this analysis?}



% \begin{itemize}
% \item Add figures of distribution of removal time.
% \item Add survival plots
% \item file addition vs. removal
% \item Difference between self vs. non-self removal.
% \end{itemize}

\conclusion{We find that the median amount of time that self-removed technical debt stays in the project is 18 days whereas non self removal technical debt is 127 days. In addition we find that technical debt removals happens more when the files containing debt are edited than when they are removed.}

\begin{figure}[!tb]
	\centering
	\includegraphics[width=\columnwidth]{figures/test/responses_question.pdf}
	\caption{Survey responses on how often do developers encounter, add and address self-admitted technical debt.}
	\label{fig:encouner_add_address}
\end{figure}


 \noindent\rqiv
 %\vspace{3mm}

\noindent \textbf{Motivation:} 
Thus far, our analysis has been quantitative in nature. To triangulate our findings and better understand our findings, we would like to perform complementary qualitative analysis to understand the experiences and motives of developers who introduce and remove \SATD. In particular, we \todo{complete...}
%So far, we found that the majority of TD comments gets removed over the evolution of the projects, and that they could be removed by the same developers who wrote them or other developers. These fining raises two main questions what type of development activities lead to the introduce and remove of self-admitted technical debt comments. Answering these questions, we could understand why developers add such technical debt comment into the source code, and if there are special development activities that developers performer to address these comments. 


 
\noindent \textbf{Approach:} 
To address this research question, we analyze the developer responses to the online survey described in section~\ref{Survey_Design}. The survey has two main sections: the first part asks questions related to likert-scale type questions about how often developers encounter, add and address technical debt comments; the second part contains two open-ended questions about the activities that developers perform to add and address self-admitted technical debt. For, the open-ended questions, we manually analyzed the free-text answers and identified 6 main reasons why developers add self-admitted technical debt and 5 main reasons for removing self-admitted technical debt.

\noindent \textbf{Results:} 
Figure~\ref{fig:encouner_add_address} shows the results of the likert scale questions about how often developers encounter, add, address self-admitted technical debt. Developers mostly agreed that they encounter source code comments indicting self-admitted technical debt. In 50\% of the responses, developers stated that they sometimes see such comments, and the other 50\% of them said they encounter such comments often or very often. When adding self-admitted technical debt, developer's responses vary from often adding self-admitted technical debt (approx. 21\%) to rarely (approx. 36\%). Another 43\% said that they sometimes added such comments. We also asked developers how often they address self-admitted technical debt. 50\% of the developers mentioned that they rarely address self-admitted technical debt, 29\% of respondents mentioned that they sometimes address self-admitted technical debt, and 21\% of the respondents mentioned that they often address self-admitted technical debt.

As for why developers tend to add \SATD, approximately 64\% of developers (P1, P4, P5, P8, P9, P11, P12, P13, and P14) indicted that they add self-admitted technical debt as a tracker in the source code for potential bugs or source code that needs to be improved or document a need for a new feature. For example, P12 states that \textit{"It is usually a marker in the source of a missing feature or known bug."}. We also found that developers add self-admitted technical debt because of time pressure (approx. 36\% - P1, P2, P7, P13, and P14) to deliver tasks. For example, P1 \textit{"Because they want to deliver, and when balancing an early delivery against technical debt."} Some other reasons for adding self-admitted technical debt are very small and are only mentioned once or twice (e.g,. a remainder or looking for feedback). For example, P5 said that \textit{"They are not sure about the effects of their code and want feedback..."}.

In response to the question on why developers address self-admitted technical debt, we identified five reasons. The most cited reason for addressing self-admitted technical debt is to fix bugs (around 64\% - P1, P4, P5, P7, P8, P9, P10, P12 and P13). For example, P12 states \textit{", usually as part of fixing a user-reported issue..."} The second most frequent reasons is to add a new feature (36\% - P1, P4, P6, P12, and P14) and improve the code overall (36\% - P7, P8, P9, P10, and P11). The other two, less frequent, reasons are addressing \SATD when refactoring code (14\% - P7 and P9) and to provide a generally better solution (14\% - P2 and P7). 



 \conclusion{Developer mostly add self-admitted technical debt \todo{complete...}}